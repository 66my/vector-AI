import{W as ee,l as h,a8 as ae,q as te,s as K,m as oe,N as n,an as se,b as p,f as x,c as e,g as a,Z as N,y as t,T as i,A as d,F as P,G as g,B as y,X as ne,ao as le}from"./index-BK2R8M7z.js";import{d as re,a as ce}from"./database-KrXFxb6r.js";import{_ as ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{F as de,D as ue}from"./FileCabinet-4WE2zvG3.js";import{D as _e,C as pe,a as me}from"./DocDetail-DlAwmOak.js";const be={key:0,class:"loading-container"},fe={key:1,class:"dataspace-container"},ge={__name:"DatabaseObjectDetail",setup(ke){const{t:l}=ee(),w=h(!0),C=ae(),V=C.params.databaseId,z=C.params.objectId,D=h({}),o=h({}),A=async()=>{const r=await re("get",{vid:V});r.status==200?D.value=r.data:N.error(r.msg)},T=async()=>{const r=await ce("get",{oid:z});r.status==200?o.value=r.data:N.error(r.msg)};te(async()=>{w.value=!0,await Promise.all([A(),T()]),m.data=o.value.raw_data.segments,w.value=!1});const I=h("segments"),m=K({columns:[{title:"#",key:"index",dataIndex:"index",width:"50px"},{title:l("workspace.databaseObjectDetail.segment_text"),key:"text",dataIndex:"text",ellipsis:!0},{title:l("workspace.databaseObjectDetail.segment_word_counts"),key:"word_counts",dataIndex:"word_counts",width:"50px"}],data:[],loading:!1,current:1,pageSize:10,total:0,pagination:oe(()=>({total:m.total,current:m.current,pageSize:m.pageSize})),hoverRowOid:null,customRow:r=>({style:{cursor:"pointer"},onClick:async u=>{(u.target.classList.contains("ant-table-cell")||u.target.classList.contains("object-title"))&&(b.segmentIndex=r.index,b.text=r.text,b.keywords=r.keywords,b.open=!0)},onMouseenter:u=>{m.hoverRowOid=r.vid},onMouseleave:u=>{m.hoverRowOid=null}})}),b=K({open:!1,segmentIndex:0,text:"",keywords:[]});return(r,u)=>{const L=n("a-spin"),R=n("router-link"),j=n("a-breadcrumb-item"),U=n("a-breadcrumb"),S=n("a-col"),B=n("a-typography-link"),q=n("a-popconfirm"),E=n("a-table"),O=n("a-tab-pane"),G=n("a-divider"),k=n("a-descriptions-item"),H=n("a-descriptions"),W=n("a-tabs"),X=n("a-typography-paragraph"),Z=n("a-modal"),J=n("a-card"),Q=n("a-row"),Y=se("highlight");return w.value?(p(),x("div",be,[e(L)])):(p(),x("div",fe,[e(Q,{align:"center",gutter:[16,16]},{default:a(()=>[e(S,{xl:16,lg:18,md:20,sm:22,xs:24},{default:a(()=>[e(U,null,{default:a(()=>[e(j,null,{default:a(()=>[e(R,{to:"/data"},{default:a(()=>[e(t(de)),i(" "+d(t(l)("components.layout.basicHeader.data_space")),1)]),_:1})]),_:1}),e(j,null,{default:a(()=>[e(R,{to:`/data/${D.value.vid}`},{default:a(()=>[e(t(ue)),i(" "+d(D.value.name),1)]),_:1},8,["to"])]),_:1}),e(j,null,{default:a(()=>[i(d(o.value.title),1)]),_:1})]),_:1})]),_:1}),e(S,{xl:16,lg:18,md:20,sm:22,xs:24},{default:a(()=>[e(J,{loading:w.value},{title:a(()=>[e(t(_e)),i(" "+d(o.value.title),1)]),default:a(()=>[e(W,{activeKey:I.value,"onUpdate:activeKey":u[0]||(u[0]=c=>I.value=c),"tab-position":"left"},{default:a(()=>[e(O,{key:"segments",tab:t(l)("workspace.databaseObjectDetail.segments")},{default:a(()=>[e(E,{customRow:m.customRow,columns:m.columns,"data-source":m.data,pagination:m.pagination},{bodyCell:a(({column:c,record:f})=>[c.key==="keywords"?(p(),x(P,{key:0},[i(d(f.keywords.join(", ")),1)],64)):c.key==="action"?(p(),x(P,{key:1},[f.status!="PR"?(p(),g(q,{key:0,placement:"leftTop",title:t(l)("workspace.databaseDetail.delete_confirm"),onConfirm:v=>r.deleteObject(f.oid)},{default:a(()=>[e(B,{type:"danger"},{default:a(()=>[i(d(t(l)("workspace.databaseDetail.delete")),1)]),_:1})]),_:2},1032,["title","onConfirm"])):y("",!0)],64)):y("",!0)]),_:1},8,["customRow","columns","data-source","pagination"])]),_:1},8,["tab"]),e(O,{key:"full-document",tab:t(l)("workspace.databaseObjectDetail.full_document")},{default:a(()=>{var c,f,v;return[((c=o.value.source_url)==null?void 0:c.length)>0?(p(),g(B,{key:0,href:o.value.source_url,target:"_blank"},{default:a(()=>[i(d(t(l)("workspace.databaseObjectDetail.source_url")),1)]),_:1},8,["href"])):y("",!0),((f=o.value.source_url)==null?void 0:f.length)>0?(p(),g(G,{key:1})):y("",!0),ne(e(t(le),{source:((v=o.value.raw_data)==null?void 0:v.text)||"",class:"custom-scrollbar markdown-body custom-hljs"},null,8,["source"]),[[Y]])]}),_:1},8,["tab"]),e(O,{key:"params_info",tab:t(l)("workspace.databaseObjectDetail.params_info")},{default:a(()=>[e(H,{bordered:""},{default:a(()=>{var c,f,v,M;return[e(k,{label:t(l)("workspace.databaseObjectCreate.split_method")},{default:a(()=>{var s,_,$,F;return[i(d((_=(s=o.value.info)==null?void 0:s.process_rules)!=null&&_.split_method?t(l)(`workspace.databaseObjectCreate.split_method_${(F=($=o.value.info)==null?void 0:$.process_rules)==null?void 0:F.split_method}`):""),1)]}),_:1},8,["label"]),((f=(c=o.value.info)==null?void 0:c.process_rules)==null?void 0:f.split_method)!="delimeter"?(p(),g(k,{key:0,label:t(l)("workspace.databaseObjectCreate.chunk_length")},{default:a(()=>{var s,_;return[i(d((_=(s=o.value.info)==null?void 0:s.process_rules)==null?void 0:_.chunk_length),1)]}),_:1},8,["label"])):y("",!0),((M=(v=o.value.info)==null?void 0:v.process_rules)==null?void 0:M.split_method)=="delimeter"?(p(),g(k,{key:1,label:t(l)("workspace.databaseObjectCreate.delimiter")},{default:a(()=>{var s,_;return[i(d((_=(s=o.value.info)==null?void 0:s.process_rules)==null?void 0:_.delimiter),1)]}),_:1},8,["label"])):y("",!0),e(k,{label:t(l)("workspace.databaseObjectCreate.remove_url_and_email")},{default:a(()=>{var s,_;return[(_=(s=o.value.info)==null?void 0:s.process_rules)!=null&&_.remove_url_and_email?(p(),g(t(pe),{key:0})):(p(),g(t(me),{key:1}))]}),_:1},8,["label"]),e(k,{label:t(l)("workspace.databaseObjectDetail.paragraph_counts")},{default:a(()=>{var s;return[i(d((s=o.value.info)==null?void 0:s.paragraph_counts),1)]}),_:1},8,["label"]),e(k,{label:t(l)("workspace.databaseObjectDetail.word_counts")},{default:a(()=>{var s;return[i(d((s=o.value.info)==null?void 0:s.word_counts),1)]}),_:1},8,["label"])]}),_:1})]),_:1},8,["tab"])]),_:1},8,["activeKey"]),e(Z,{open:b.open,"onUpdate:open":u[1]||(u[1]=c=>b.open=c),title:`# ${b.segmentIndex}`,onCancel:u[2]||(u[2]=c=>b.open=!1),footer:null},{default:a(()=>[e(X,{content:b.text},null,8,["content"])]),_:1},8,["open","title"])]),_:1},8,["loading"])]),_:1})]),_:1})]))}}},De=ie(ge,[["__scopeId","data-v-69c09e60"]]);export{De as default};
