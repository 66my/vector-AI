import{c as n,A as T,V as Y,l as $,a6 as J,a7 as Q,s as W,m as Z,Y as w,q as K,P as f,f as i,h,j as a,x as s,T as p,B as _,F as O,C as v,L as g}from"./index-dXo_TUZF.js";import{a as R,d as ee}from"./database-75i2CyCt.js";import{_ as te}from"./_plugin-vue_export-helper-x3n3nnut.js";import{C as ae,D as V}from"./DatabaseOutlined-AIwdvU6u.js";import{L as oe}from"./LoadingOutlined-NJIahopc.js";import{E as ne}from"./EditOutlined-zbhlBw2R.js";var re={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M842 454c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 140.3-113.7 254-254 254S258 594.3 258 454c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 168.7 126.6 307.9 290 327.6V884H326.7c-13.7 0-24.7 14.3-24.7 32v36c0 4.4 2.8 8 6.2 8h407.6c3.4 0 6.2-3.6 6.2-8v-36c0-17.7-11-32-24.7-32H548V782.1c165.3-18 294-158 294-328.1zM512 624c93.9 0 170-75.2 170-168V232c0-92.8-76.1-168-170-168s-170 75.2-170 168v224c0 92.8 76.1 168 170 168zm-94-392c0-50.6 41.9-92 94-92s94 41.4 94 92v224c0 50.6-41.9 92-94 92s-94-41.4-94-92V232z"}}]},name:"audio",theme:"outlined"};const se=re;var le={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 632H136v-39.9l138.5-164.3 150.1 178L658.1 489 888 761.6V792zm0-129.8L664.2 396.8c-3.2-3.8-9-3.8-12.2 0L424.6 666.4l-144-170.7c-3.2-3.8-9-3.8-12.2 0L136 652.7V232h752v430.2zM304 456a88 88 0 100-176 88 88 0 000 176zm0-116c15.5 0 28 12.5 28 28s-12.5 28-28 28-28-12.5-28-28 12.5-28 28-28z"}}]},name:"picture",theme:"outlined"};const ce=le;function L(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},u=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(u=u.concat(Object.getOwnPropertySymbols(t).filter(function(m){return Object.getOwnPropertyDescriptor(t,m).enumerable}))),u.forEach(function(m){ie(r,m,t[m])})}return r}function ie(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}var P=function(e,t){var u=L({},e,t.attrs);return n(T,L({},u,{icon:se}),null)};P.displayName="AudioOutlined";P.inheritAttrs=!1;const ue=P;function M(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},u=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(u=u.concat(Object.getOwnPropertySymbols(t).filter(function(m){return Object.getOwnPropertyDescriptor(t,m).enumerable}))),u.forEach(function(m){de(r,m,t[m])})}return r}function de(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}var j=function(e,t){var u=M({},e,t.attrs);return n(T,M({},u,{icon:ce}),null)};j.displayName="PictureOutlined";j.inheritAttrs=!1;const pe=j,_e={class:"dataspace-container"},me={key:1},fe={__name:"DatabaseDetail",setup(r){const{t:e}=Y(),t=$(!0),u=J(),m=Q(),k=u.params.databaseId,D=$({}),o=W({columns:[{name:e("workspace.databaseDetail.object_title"),dataIndex:"title",key:"title"},{title:e("workspace.databaseDetail.data_type"),key:"data_type",dataIndex:"data_type",width:"200px"},{title:e("workspace.databaseDetail.source_url"),key:"source_url",dataIndex:"source_url",width:"200px"},{title:e("common.create_time"),key:"create_time",dataIndex:"create_time",sorter:!0,sortDirections:["descend","ascend"],width:"200px"},{title:e("common.action"),key:"action",width:"200px"}],data:[],loading:!1,current:1,pageSize:10,total:0,pagination:Z(()=>({total:o.total,current:o.current,pageSize:o.pageSize})),handleTableChange:(c,l,b)=>{o.load({page_size:c.pageSize,page:c.current,sort_field:b.field,sort_order:b.order})},hoverRowOid:null,customRow:c=>({style:{cursor:"pointer"},onClick:async l=>{(l.target.classList.contains("ant-table-cell")||l.target.classList.contains("object-title"))&&await m.push(`/data/${k}/object/${c.oid}`)},onMouseenter:l=>{o.hoverRowOid=c.vid},onMouseleave:l=>{o.hoverRowOid=null}}),load:async c=>{o.loading=!0;const l=await R("list",{vid:k,...c});l.status==200?o.data=l.data.objects.map(b=>(b.create_time=new Date(b.create_time).toLocaleString(),b)):w.error(l.msg),o.total=l.data.total,o.pageSize=l.data.page_size,o.current=l.data.page,o.loading=!1}}),B=async()=>{await o.load({});const c=await ee("get",{vid:k});c.status==200?(D.value=c.data,t.value=!1):w.error(c.msg)};K(async()=>{await B()});const E=async()=>{await m.push(`/data/${k}/create`)},U=c=>{R("delete",{oid:c}).then(l=>{l.status===200?w.success(e("workspace.databaseDetail.delete_success")):w.error(e("workspace.databaseDetail.delete_failed")),o.load({})})};return(c,l)=>{const b=f("router-link"),S=f("a-breadcrumb-item"),H=f("a-breadcrumb"),z=f("a-col"),N=f("a-button"),x=f("a-typography-text"),C=f("a-tag"),A=f("a-typography-link"),F=f("a-popconfirm"),q=f("a-table"),G=f("a-card"),X=f("a-row");return i(),h("div",_e,[n(X,{align:"center",gutter:[16,16]},{default:a(()=>[n(z,{xl:16,lg:18,md:20,sm:22,xs:24},{default:a(()=>[n(H,null,{default:a(()=>[n(S,null,{default:a(()=>[n(b,{to:"/data"},{default:a(()=>[n(s(ae)),p(" "+_(s(e)("components.layout.basicHeader.data_space")),1)]),_:1})]),_:1}),n(S,null,{default:a(()=>[n(s(V)),p(" "+_(D.value.name),1)]),_:1})]),_:1})]),_:1}),n(z,{xl:16,lg:18,md:20,sm:22,xs:24},{default:a(()=>[n(G,{loading:t.value},{title:a(()=>[n(s(V)),p(" "+_(D.value.name),1)]),extra:a(()=>[n(N,{type:"primary",onClick:E},{default:a(()=>[p(_(s(e)("workspace.databaseDetail.add_object")),1)]),_:1})]),default:a(()=>[n(q,{loading:o.loading,customRow:o.customRow,columns:o.columns,"data-source":o.data,pagination:o.pagination,onChange:o.handleTableChange},{headerCell:a(({column:y})=>[y.key==="title"?(i(),h(O,{key:0},[p(_(s(e)("workspace.databaseDetail.object_title")),1)],64)):v("",!0)]),bodyCell:a(({column:y,record:d})=>{var I;return[y.key==="title"?(i(),h(O,{key:0},[d.status=="PR"?(i(),g(x,{key:0,disabled:""},{default:a(()=>[p(_(d.title)+" ",1),n(s(oe))]),_:2},1024)):(i(),g(x,{key:1,class:"object-title"},{default:a(()=>[p(_(d.title),1)]),_:2},1024))],64)):y.key==="data_type"?(i(),h("span",me,[d.data_type.toUpperCase()=="TEXT"?(i(),g(C,{key:0,color:"blue"},{default:a(()=>[n(s(ne)),p(" "+_(s(e)(`workspace.databaseDetail.data_type_${d.data_type.toUpperCase()}`)),1)]),_:2},1024)):v("",!0),d.data_type.toUpperCase()=="IMAGE"?(i(),g(C,{key:1,color:"green"},{default:a(()=>[n(s(pe)),p(" "+_(s(e)(`workspace.databaseDetail.data_type_${d.data_type.toUpperCase()}`)),1)]),_:2},1024)):v("",!0),d.data_type.toUpperCase()=="AUDIO"?(i(),g(C,{key:2,color:"purple"},{default:a(()=>[n(s(ue)),p(" "+_(s(e)(`workspace.databaseDetail.data_type_${d.data_type.toUpperCase()}`)),1)]),_:2},1024)):v("",!0)])):y.key==="source_url"?(i(),h(O,{key:2},[((I=d.source_url)==null?void 0:I.length)>0?(i(),g(A,{key:0,href:d.source_url,target:"_blank"},{default:a(()=>[p(_(s(e)("workspace.databaseDetail.source_url")),1)]),_:2},1032,["href"])):(i(),g(x,{key:1,disabled:""},{default:a(()=>[p(_(s(e)("workspace.databaseDetail.source_url")),1)]),_:1}))],64)):y.key==="action"?(i(),h(O,{key:3},[d.status!="PR"?(i(),g(F,{key:0,placement:"leftTop",title:s(e)("workspace.databaseDetail.delete_confirm"),onConfirm:be=>U(d.oid)},{default:a(()=>[n(A,{type:"danger"},{default:a(()=>[p(_(s(e)("workspace.databaseDetail.delete")),1)]),_:1})]),_:2},1032,["title","onConfirm"])):v("",!0)],64)):v("",!0)]}),_:1},8,["loading","customRow","columns","data-source","pagination","onChange"])]),_:1},8,["loading"])]),_:1})]),_:1})])}}},Oe=te(fe,[["__scopeId","data-v-956bc8c6"]]);export{Oe as default};
