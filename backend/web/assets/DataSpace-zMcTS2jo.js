import{V as F,l as w,a7 as P,s as C,q as j,Y as f,P as s,f as l,h as u,c as r,j as t,aX as q,T as m,B as _,x as p,F as h,C as g,L as b,N as G}from"./index-dXo_TUZF.js";import{u as X}from"./userDatabase-Gcq4NMu_.js";import{d as v}from"./database-75i2CyCt.js";import{L as Y}from"./LoadingOutlined-NJIahopc.js";const z={class:"dataspace-container"},H={key:1},J={key:2},K={key:3},ta={__name:"DataSpace",setup(Q){const{t:a}=F(),x=w(!0),L=P(),N=X(),d=C({columns:[{name:a("workspace.dataSpace.database_name"),dataIndex:"name",key:"name"},{title:a("common.status"),dataIndex:"status",key:"status",width:"200px"},{title:a("common.tags"),key:"tags",dataIndex:"tags",width:"200px"},{title:a("common.action"),key:"action",width:"200px"}],data:[],hoverRowVid:null,customRow:n=>({style:{cursor:"pointer"},onClick:async e=>{(e.target.classList.contains("ant-table-cell")||e.target.classList.contains("database-title"))&&await L.push(`/data/${n.vid}`)},onMouseenter:e=>{d.hoverRowVid=n.vid},onMouseleave:e=>{d.hoverRowVid=null}})}),k=async()=>{const n=await v("list",{});n.status==200?(N.setUserDatabases(n.data),d.data=n.data.map(e=>({...e,color:q[e.status],tags:[]})),x.value=!1):f.error(n.msg)};j(async()=>{await k()});const o=C({open:w(!1),creating:w(!1),create:async()=>{o.creating=!0,(await v("create",{name:o.databaseName})).status===200?f.success(a("workspace.dataSpace.create_success")):f.error(a("workspace.dataSpace.create_failed")),await k(),o.creating=!1,o.open=!1}}),R=async n=>{(await v("delete",{vid:n})).status===200?f.success(a("workspace.dataSpace.delete_success")):f.error(a("workspace.dataSpace.delete_failed")),await k()};return(n,e)=>{const D=s("a-button"),V=s("a-input"),I=s("a-form-item"),B=s("a-modal"),M=s("a-typography-text"),S=s("a-tag"),U=s("a-typography-link"),$=s("a-popconfirm"),O=s("a-table"),T=s("a-card"),A=s("a-col"),E=s("a-row");return l(),u("div",z,[r(E,{align:"center",gutter:[16,16]},{default:t(()=>[r(A,{xl:16,lg:18,md:20,sm:22,xs:24},{default:t(()=>[r(T,{loading:x.value},{extra:t(()=>[r(D,{type:"primary",onClick:e[0]||(e[0]=c=>o.open=!0)},{default:t(()=>[m(_(p(a)("workspace.dataSpace.create")),1)]),_:1}),r(B,{open:o.open,"onUpdate:open":e[2]||(e[2]=c=>o.open=c),title:p(a)("workspace.dataSpace.create"),onOk:o.create,confirmLoading:o.creating},{default:t(()=>[r(I,{label:p(a)("workspace.dataSpace.database_name")},{default:t(()=>[r(V,{value:o.databaseName,"onUpdate:value":e[1]||(e[1]=c=>o.databaseName=c)},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["open","title","onOk","confirmLoading"])]),default:t(()=>[r(O,{columns:d.columns,customRow:d.customRow,"data-source":d.data},{headerCell:t(({column:c})=>[c.key==="name"?(l(),u(h,{key:0},[m(_(p(a)("workspace.dataSpace.database_name")),1)],64)):g("",!0)]),bodyCell:t(({column:c,record:i})=>[c.key==="name"?(l(),b(M,{key:0,class:"database-title"},{default:t(()=>[m(_(i.name),1)]),_:2},1024)):c.key==="status"?(l(),u("span",H,[r(S,{color:i.color},{default:t(()=>[i.status==="CREATING"?(l(),b(p(Y),{key:0})):g("",!0),m(" "+_(p(a)(`workspace.dataSpace.status_${i.status.toLowerCase()}`)),1)]),_:2},1032,["color"])])):c.key==="tags"?(l(),u("span",J,[(l(!0),u(h,null,G(i.tags,y=>(l(),b(S,{key:y},{default:t(()=>[m(_(y.toUpperCase()),1)]),_:2},1024))),128))])):c.key==="action"?(l(),u("span",K,[r($,{title:p(a)("workspace.dataSpace.delete_confirm"),onConfirm:y=>R(i.vid)},{default:t(()=>[r(U,{type:"danger"},{default:t(()=>[m(_(p(a)("common.delete")),1)]),_:1})]),_:2},1032,["title","onConfirm"])])):g("",!0)]),_:1},8,["columns","customRow","data-source"])]),_:1},8,["loading"])]),_:1})]),_:1})])}}};export{ta as default};
