import{I as Q,c as t,W as O,s as K,ab as W,a0 as E,r as C,x as F,$ as b,M as n,f as p,K as v,j as e,B as r,T as k,D as w,h as R,F as P,E as S,aM as q,a6 as X}from"./index-DwTab_5X.js";import{a as Y,u as Z}from"./userDatabase-BoM4Lkmx.js";import{d as T,a as B}from"./database-CjPJb4LT.js";import{L as z}from"./LoadingFour-BmztCNPP.js";import{D as G}from"./Delete-DkwO9RIL.js";import{a as aa}from"./util-CDdHKGWf.js";const H=Q("add",!1,function(d){return t("svg",{width:d.size,height:d.size,viewBox:"0 0 48 48",fill:"none"},[t("rect",{x:"6",y:"6",width:"36",height:"36",rx:"3",fill:d.colors[1],stroke:d.colors[0],"stroke-width":d.strokeWidth,"stroke-linejoin":d.strokeLinejoin},null),t("path",{d:"M24 16V32",stroke:d.colors[2],"stroke-width":d.strokeWidth,"stroke-linecap":d.strokeLinecap,"stroke-linejoin":d.strokeLinejoin},null),t("path",{d:"M16 24L32 24",stroke:d.colors[2],"stroke-width":d.strokeWidth,"stroke-linecap":d.strokeLinecap,"stroke-linejoin":d.strokeLinejoin},null)])}),ea={key:1},ta={__name:"VectorDatabaseTable",setup(d){const{t:o}=O(),y=K(!0),x=W(),g=Y(),{userDatabases:D}=E(g),i=C({columns:[{name:o("workspace.dataSpace.database_name"),dataIndex:"name",key:"name"},{title:o("common.status"),dataIndex:"status",key:"status",width:"100px"},{title:o("common.action"),key:"action",width:"80px"}],data:[],hoverRowVid:null,customRow:s=>({style:{cursor:"pointer"},onClick:async a=>{(a.target.classList.contains("ant-table-cell")||a.target.classList.contains("database-title"))&&await x.push(`/data/vector-db/${s.vid}`)},onMouseenter:a=>{i.hoverRowVid=s.vid},onMouseleave:a=>{i.hoverRowVid=null}})}),_=async()=>{const s=await T("list");s.status==200?(g.setUserDatabases(s.data),i.data=s.data.map(a=>({...a,color:q[a.status],tags:[]})),y.value=!1):b.error(s.msg)};F(async()=>{await _()});const c=C({open:!1,creating:!1,databaseName:"",create:async()=>{c.creating=!0;const s=await T("create",{name:c.databaseName});if(s.status===200){b.success(o("workspace.dataSpace.create_success"));let a=setInterval(async()=>{await _();const u=i.data.find(m=>m.vid===s.data.vid);u&&u.status==="VALID"&&clearInterval(a)},5e3)}else b.error(o("workspace.dataSpace.create_failed"));await _(),c.creating=!1,c.open=!1}}),h=async s=>{(await T("delete",{vid:s})).status===200?b.success(o("workspace.dataSpace.delete_success")):b.error(o("workspace.dataSpace.delete_failed")),await _()};return(s,a)=>{const u=n("a-button"),m=n("a-typography-text"),L=n("a-space"),I=n("a-input"),N=n("a-form-item"),$=n("a-form"),M=n("a-modal"),V=n("a-flex"),U=n("a-tag"),j=n("a-popconfirm"),A=n("a-table");return p(),v(A,{columns:i.columns,customRow:i.customRow,"data-source":i.data,pagination:{hideOnSinglePage:!0},loading:y.value},{title:e(()=>[t(V,{justify:"space-between"},{default:e(()=>[t(L,null,{default:e(()=>[t(u,{type:"primary",onClick:a[0]||(a[0]=l=>c.open=!0)},{icon:e(()=>[t(r(H))]),default:e(()=>[k(" "+w(r(o)("workspace.dataSpace.create")),1)]),_:1}),t(m,{type:"secondary"},{default:e(()=>[k(w(r(D).length),1)]),_:1})]),_:1}),t(M,{open:c.open,"onUpdate:open":a[2]||(a[2]=l=>c.open=l),title:r(o)("workspace.dataSpace.create"),onOk:c.create,confirmLoading:c.creating},{default:e(()=>[t($,{"label-col":{span:6},"wrapper-col":{span:18}},{default:e(()=>[t(N,{label:r(o)("workspace.dataSpace.database_name")},{default:e(()=>[t(I,{value:c.databaseName,"onUpdate:value":a[1]||(a[1]=l=>c.databaseName=l)},null,8,["value"])]),_:1},8,["label"])]),_:1})]),_:1},8,["open","title","onOk","confirmLoading"])]),_:1})]),headerCell:e(({column:l})=>[l.key==="name"?(p(),R(P,{key:0},[k(w(r(o)("workspace.dataSpace.database_name")),1)],64)):S("",!0)]),bodyCell:e(({column:l,record:f})=>[l.key==="name"?(p(),v(m,{key:0,class:"database-title"},{default:e(()=>[k(w(f.name),1)]),_:2},1024)):l.key==="status"?(p(),R("span",ea,[t(U,{color:f.color,bordered:!1},{default:e(()=>[f.status==="CREATING"?(p(),v(r(z),{key:0,spin:!0})):S("",!0),k(" "+w(r(o)(`status.${f.status}`)),1)]),_:2},1032,["color"])])):l.key==="action"?(p(),v(j,{key:2,title:r(o)("workspace.dataSpace.delete_confirm"),onConfirm:J=>h(f.vid)},{default:e(()=>[t(u,{danger:"",type:"text"},{icon:e(()=>[t(r(G))]),_:1})]),_:2},1032,["title","onConfirm"])):S("",!0)]),_:1},8,["columns","customRow","data-source","loading"])}}},sa={key:1},oa={__name:"RelationalDatabaseTable",setup(d){const{t:o}=O(),y=K(!0),x=W(),g=Z(),{userRelationalDatabases:D}=E(g),i=C({columns:[{name:o("workspace.dataSpace.database_name"),dataIndex:"name",key:"name"},{title:o("common.status"),dataIndex:"status",key:"status",width:"100px"},{title:o("common.action"),key:"action",width:"80px"}],data:[],hoverRowRid:null,customRow:s=>({style:{cursor:s.status=="VALID"?"pointer":"not-allowed"},onClick:async a=>{s.status=="VALID"&&(a.target.classList.contains("ant-table-cell")||a.target.classList.contains("database-title"))&&await x.push(`/data/relational-db/${s.rid}`)},onMouseenter:a=>{i.hoverRowRid=s.rid},onMouseleave:a=>{i.hoverRowRid=null}})}),_=async()=>{const s=await B("list");s.status==200?(g.setUserRelationalDatabases(s.data),i.data=s.data.map(a=>({...a,color:q[a.status],tags:[]})),y.value=!1):b.error(s.msg)};F(async()=>{await _()});const c=C({open:!1,creating:!1,databaseName:"",create:async()=>{c.creating=!0;const s=await B("create",{name:c.databaseName});if(s.status===200){b.success(o("workspace.dataSpace.create_success"));let a=setInterval(async()=>{await _();const u=i.data.find(m=>m.rid===s.data.rid);u&&u.status==="VALID"&&clearInterval(a)},5e3)}else b.error(o("workspace.dataSpace.create_failed"));await _(),c.creating=!1,c.open=!1}}),h=async s=>{(await B("delete",{rid:s})).status===200?b.success(o("workspace.dataSpace.delete_success")):b.error(o("workspace.dataSpace.delete_failed")),await _()};return(s,a)=>{const u=n("a-button"),m=n("a-typography-text"),L=n("a-space"),I=n("a-input"),N=n("a-form-item"),$=n("a-form"),M=n("a-modal"),V=n("a-flex"),U=n("a-tag"),j=n("a-popconfirm"),A=n("a-table");return p(),v(A,{columns:i.columns,customRow:i.customRow,"data-source":i.data,pagination:{hideOnSinglePage:!0},loading:y.value},{title:e(()=>[t(V,{justify:"space-between"},{default:e(()=>[t(L,null,{default:e(()=>[t(u,{type:"primary",onClick:a[0]||(a[0]=l=>c.open=!0)},{icon:e(()=>[t(r(H))]),default:e(()=>[k(" "+w(r(o)("workspace.dataSpace.create")),1)]),_:1}),t(m,{type:"secondary"},{default:e(()=>[k(w(r(D).length),1)]),_:1})]),_:1}),t(M,{open:c.open,"onUpdate:open":a[2]||(a[2]=l=>c.open=l),title:r(o)("workspace.dataSpace.create"),onOk:c.create,confirmLoading:c.creating},{default:e(()=>[t($,{"label-col":{span:6},"wrapper-col":{span:18}},{default:e(()=>[t(N,{label:r(o)("workspace.dataSpace.database_name")},{default:e(()=>[t(I,{value:c.databaseName,"onUpdate:value":a[1]||(a[1]=l=>c.databaseName=l)},null,8,["value"])]),_:1},8,["label"])]),_:1})]),_:1},8,["open","title","onOk","confirmLoading"])]),_:1})]),headerCell:e(({column:l})=>[l.key==="name"?(p(),R(P,{key:0},[k(w(r(o)("workspace.dataSpace.database_name")),1)],64)):S("",!0)]),bodyCell:e(({column:l,record:f})=>[l.key==="name"?(p(),v(m,{key:0,class:"database-title"},{default:e(()=>[k(w(f.name),1)]),_:2},1024)):l.key==="status"?(p(),R("span",sa,[t(U,{color:f.color,bordered:!1},{default:e(()=>[f.status==="CREATING"?(p(),v(r(z),{key:0,spin:!0})):S("",!0),k(" "+w(r(o)(`workspace.dataSpace.status_${f.status.toLowerCase()}`)),1)]),_:2},1032,["color"])])):l.key==="action"?(p(),v(j,{key:2,title:r(o)("workspace.dataSpace.delete_confirm"),onConfirm:J=>h(f.rid)},{default:e(()=>[t(u,{danger:"",type:"text"},{icon:e(()=>[t(r(G))]),_:1})]),_:2},1032,["title","onConfirm"])):S("",!0)]),_:1},8,["columns","customRow","data-source","loading"])}}},na={class:"dataspace-container"},pa={__name:"DataSpace",setup(d){const{t:o}=O(),y=X(),x=W(),g=K(y.query.tab?y.query.tab:"vector-database"),D=async i=>{await x.push(aa(y.path,{tab:i}))};return(i,_)=>{const c=n("a-card"),h=n("a-tab-pane"),s=n("a-tabs"),a=n("a-col"),u=n("a-row");return p(),R("div",na,[t(u,{align:"center",gutter:[16,16]},{default:e(()=>[t(a,{xl:16,lg:18,md:20,sm:22,xs:24},{default:e(()=>[t(s,{activeKey:g.value,"onUpdate:activeKey":_[0]||(_[0]=m=>g.value=m),centered:"",onChange:D},{default:e(()=>[t(h,{key:"vector-database",tab:r(o)("workspace.dataSpace.vector_database")},{default:e(()=>[t(c,null,{default:e(()=>[t(ta)]),_:1})]),_:1},8,["tab"]),t(h,{key:"relational-database",tab:r(o)("workspace.dataSpace.relational_database")},{default:e(()=>[t(c,null,{default:e(()=>[t(oa)]),_:1})]),_:1},8,["tab"])]),_:1},8,["activeKey"])]),_:1})]),_:1})])}}};export{pa as default};
