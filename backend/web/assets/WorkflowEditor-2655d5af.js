import{v as zo,_ as Go,a as qo,b as Jo,c as Zo,d as Qo,e as Ko,f as en,g as tn,h as on,i as nn,j as an,k as rn,l as ln,m as sn,n as un,o as cn,p as dn,q as pn,r as fn,s as mn,t as hn,u as vn,w as gn,x as _n,y as yn,z as bn,A as wn,B as kn,C as Sn,D as En,Y as Dn,E as xn,F as Cn,G as Tn,H as On,I as In}from"./style-8561330d.js";import{c,A as Nn,g as Gt,u as y,w as An,d as Pn,a as Mn,b as oo,t as Vn,r as ne,e as We,h as ko,o as Fn,f as Un,i as So,j as qt,k as Rn,n as no,l as D,m as jn,p as T,q as z,s as m,v as Z,x as Be,F as xe,y as L,z as $,B as Ve,C as $n,D as je,E as ao,G as Bt,V as Bn,H as Xn,I as Yn,J as Wn,K as ro,L as Ln,M as Hn,N as zn,O as lo,P as Ot,Q as ct,R as Gn,S as io,T as qn,U as Jn,W as Zn,X as Qn}from"./index-a9d65eeb.js";import{u as Kn}from"./userDatabase-c27e31c0.js";import{_ as ea}from"./MarkdownEditor-92ae1062.js";import{_ as Eo}from"./UploaderFieldUse-fdfd962f.js";import{F as ta,T as oa,_ as na,a as aa,b as ra,c as la,d as ia}from"./EchartsRenderer-3ff554ec.js";import{_ as sa}from"./TemperatureInput-0c372114.js";import{_ as Jt}from"./_plugin-vue_export-helper-c27b6911.js";import{d as ua}from"./database-d115207f.js";import"./QuestionPopover-a537b360.js";import"./stringify-ec884b6d.js";import"./index-7f383368.js";var ca={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.3 506.3L781.7 405.6a7.23 7.23 0 00-11.7 5.7V476H548V254h64.8c6 0 9.4-7 5.7-11.7L517.7 114.7a7.14 7.14 0 00-11.3 0L405.6 242.3a7.23 7.23 0 005.7 11.7H476v222H254v-64.8c0-6-7-9.4-11.7-5.7L114.7 506.3a7.14 7.14 0 000 11.3l127.5 100.8c4.7 3.7 11.7.4 11.7-5.7V548h222v222h-64.8c-6 0-9.4 7-5.7 11.7l100.8 127.5c2.9 3.7 8.5 3.7 11.3 0l100.8-127.5c3.7-4.7.4-11.7-5.7-11.7H548V548h222v64.8c0 6 7 9.4 11.7 5.7l127.5-100.8a7.3 7.3 0 00.1-11.4z"}}]},name:"drag",theme:"outlined"};const da=ca;function so(e){for(var o=1;o<arguments.length;o++){var t=arguments[o]!=null?Object(arguments[o]):{},n=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable}))),n.forEach(function(a){pa(e,a,t[a])})}return e}function pa(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}var Zt=function(o,t){var n=so({},o,t.attrs);return c(Nn,so({},n,{icon:da}),null)};Zt.displayName="DragOutlined";Zt.inheritAttrs=!1;const It=Zt;var fa=Object.defineProperty,bt=Object.getOwnPropertySymbols,Do=Object.prototype.hasOwnProperty,xo=Object.prototype.propertyIsEnumerable,uo=(e,o,t)=>o in e?fa(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t,Xe=(e,o)=>{for(var t in o||(o={}))Do.call(o,t)&&uo(e,t,o[t]);if(bt)for(var t of bt(o))xo.call(o,t)&&uo(e,t,o[t]);return e},Co=(e,o)=>{var t={};for(var n in e)Do.call(e,n)&&o.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&bt)for(var n of bt(e))o.indexOf(n)<0&&xo.call(e,n)&&(t[n]=e[n]);return t};const To="[vue-draggable-plus]: ";function ma(e){console.warn(To+e)}function ha(e){console.error(To+e)}function va(e,o,t){Array.isArray(e)&&t>=0&&t<e.length&&e.splice(t,0,e.splice(o,1)[0])}function ga(e){return e.replace(/-(\w)/g,(o,t)=>t?t.toUpperCase():"")}function _a(e){return Object.keys(e).reduce((o,t)=>(typeof e[t]<"u"&&(o[ga(t)]=e[t]),o),{})}function ya(e,o){if(Array.isArray(e))return e.splice(o,1)}function ba(e,o,t){if(Array.isArray(e))return e.splice(o,0,t)}function wa(e){return typeof e>"u"}function ka(e){return typeof e=="string"}function co(e,o,t){const n=e.children[t];e.insertBefore(o,n)}function Nt(e){e.parentNode&&e.parentNode.removeChild(e)}function Sa(e,o=document){var t;let n=null;return typeof(o==null?void 0:o.querySelector)=="function"?n=(t=o==null?void 0:o.querySelector)==null?void 0:t.call(o,e):n=document.querySelector(e),n||ma(`Element not found: ${e}`),n}function Ea(e,o,t=null){return function(...n){return e.apply(t,n),o.apply(t,n)}}function Da(e,o){const t=Xe({},e);return Object.keys(o).forEach(n=>{t[n]?t[n]=Ea(e[n],o[n]):t[n]=o[n]}),t}function xa(e){return e instanceof HTMLElement}function Ca(e,o){Object.keys(e).forEach(t=>{o(t,e[t])})}/**!
 * Sortable 1.15.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function po(e,o){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);o&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function ye(e){for(var o=1;o<arguments.length;o++){var t=arguments[o]!=null?arguments[o]:{};o%2?po(Object(t),!0).forEach(function(n){Ta(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):po(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function ht(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ht=function(o){return typeof o}:ht=function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},ht(e)}function Ta(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}function we(){return we=Object.assign||function(e){for(var o=1;o<arguments.length;o++){var t=arguments[o];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},we.apply(this,arguments)}function Oa(e,o){if(e==null)return{};var t={},n=Object.keys(e),a,r;for(r=0;r<n.length;r++)a=n[r],!(o.indexOf(a)>=0)&&(t[a]=e[a]);return t}function Ia(e,o){if(e==null)return{};var t=Oa(e,o),n,a;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],!(o.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(t[n]=e[n])}return t}var Na="1.15.0";function be(e){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(e)}var ke=be(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),at=be(/Edge/i),fo=be(/firefox/i),Ke=be(/safari/i)&&!be(/chrome/i)&&!be(/android/i),Oo=be(/iP(ad|od|hone)/i),Io=be(/chrome/i)&&be(/android/i),No={capture:!1,passive:!1};function N(e,o,t){e.addEventListener(o,t,!ke&&No)}function I(e,o,t){e.removeEventListener(o,t,!ke&&No)}function wt(e,o){if(o){if(o[0]===">"&&(o=o.substring(1)),e)try{if(e.matches)return e.matches(o);if(e.msMatchesSelector)return e.msMatchesSelector(o);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(o)}catch{return!1}return!1}}function Aa(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function ge(e,o,t,n){if(e){t=t||document;do{if(o!=null&&(o[0]===">"?e.parentNode===t&&wt(e,o):wt(e,o))||n&&e===t)return e;if(e===t)break}while(e=Aa(e))}return null}var mo=/\s+/g;function ue(e,o,t){if(e&&o)if(e.classList)e.classList[t?"add":"remove"](o);else{var n=(" "+e.className+" ").replace(mo," ").replace(" "+o+" "," ");e.className=(n+(t?" "+o:"")).replace(mo," ")}}function w(e,o,t){var n=e&&e.style;if(n){if(t===void 0)return document.defaultView&&document.defaultView.getComputedStyle?t=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(t=e.currentStyle),o===void 0?t:t[o];!(o in n)&&o.indexOf("webkit")===-1&&(o="-webkit-"+o),n[o]=t+(typeof t=="string"?"":"px")}}function Le(e,o){var t="";if(typeof e=="string")t=e;else do{var n=w(e,"transform");n&&n!=="none"&&(t=n+" "+t)}while(!o&&(e=e.parentNode));var a=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return a&&new a(t)}function Ao(e,o,t){if(e){var n=e.getElementsByTagName(o),a=0,r=n.length;if(t)for(;a<r;a++)t(n[a],a);return n}return[]}function _e(){var e=document.scrollingElement;return e||document.documentElement}function q(e,o,t,n,a){if(!(!e.getBoundingClientRect&&e!==window)){var r,l,u,s,p,f,h;if(e!==window&&e.parentNode&&e!==_e()?(r=e.getBoundingClientRect(),l=r.top,u=r.left,s=r.bottom,p=r.right,f=r.height,h=r.width):(l=0,u=0,s=window.innerHeight,p=window.innerWidth,f=window.innerHeight,h=window.innerWidth),(o||t)&&e!==window&&(a=a||e.parentNode,!ke))do if(a&&a.getBoundingClientRect&&(w(a,"transform")!=="none"||t&&w(a,"position")!=="static")){var E=a.getBoundingClientRect();l-=E.top+parseInt(w(a,"border-top-width")),u-=E.left+parseInt(w(a,"border-left-width")),s=l+r.height,p=u+r.width;break}while(a=a.parentNode);if(n&&e!==window){var g=Le(a||e),v=g&&g.a,_=g&&g.d;g&&(l/=_,u/=v,h/=v,f/=_,s=l+f,p=u+h)}return{top:l,left:u,bottom:s,right:p,width:h,height:f}}}function ho(e,o,t){for(var n=Te(e,!0),a=q(e)[o];n;){var r=q(n)[t],l=void 0;if(t==="top"||t==="left"?l=a>=r:l=a<=r,!l)return n;if(n===_e())break;n=Te(n,!1)}return!1}function He(e,o,t,n){for(var a=0,r=0,l=e.children;r<l.length;){if(l[r].style.display!=="none"&&l[r]!==k.ghost&&(n||l[r]!==k.dragged)&&ge(l[r],t.draggable,e,!1)){if(a===o)return l[r];a++}r++}return null}function Qt(e,o){for(var t=e.lastElementChild;t&&(t===k.ghost||w(t,"display")==="none"||o&&!wt(t,o));)t=t.previousElementSibling;return t||null}function fe(e,o){var t=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)e.nodeName.toUpperCase()!=="TEMPLATE"&&e!==k.clone&&(!o||wt(e,o))&&t++;return t}function vo(e){var o=0,t=0,n=_e();if(e)do{var a=Le(e),r=a.a,l=a.d;o+=e.scrollLeft*r,t+=e.scrollTop*l}while(e!==n&&(e=e.parentNode));return[o,t]}function Pa(e,o){for(var t in e)if(e.hasOwnProperty(t)){for(var n in o)if(o.hasOwnProperty(n)&&o[n]===e[t][n])return Number(t)}return-1}function Te(e,o){if(!e||!e.getBoundingClientRect)return _e();var t=e,n=!1;do if(t.clientWidth<t.scrollWidth||t.clientHeight<t.scrollHeight){var a=w(t);if(t.clientWidth<t.scrollWidth&&(a.overflowX=="auto"||a.overflowX=="scroll")||t.clientHeight<t.scrollHeight&&(a.overflowY=="auto"||a.overflowY=="scroll")){if(!t.getBoundingClientRect||t===document.body)return _e();if(n||o)return t;n=!0}}while(t=t.parentNode);return _e()}function Ma(e,o){if(e&&o)for(var t in o)o.hasOwnProperty(t)&&(e[t]=o[t]);return e}function At(e,o){return Math.round(e.top)===Math.round(o.top)&&Math.round(e.left)===Math.round(o.left)&&Math.round(e.height)===Math.round(o.height)&&Math.round(e.width)===Math.round(o.width)}var et;function Po(e,o){return function(){if(!et){var t=arguments,n=this;t.length===1?e.call(n,t[0]):e.apply(n,t),et=setTimeout(function(){et=void 0},o)}}}function Va(){clearTimeout(et),et=void 0}function Mo(e,o,t){e.scrollLeft+=o,e.scrollTop+=t}function Vo(e){var o=window.Polymer,t=window.jQuery||window.Zepto;return o&&o.dom?o.dom(e).cloneNode(!0):t?t(e).clone(!0)[0]:e.cloneNode(!0)}var de="Sortable"+new Date().getTime();function Fa(){var e=[],o;return{captureAnimationState:function(){if(e=[],!!this.options.animation){var t=[].slice.call(this.el.children);t.forEach(function(n){if(!(w(n,"display")==="none"||n===k.ghost)){e.push({target:n,rect:q(n)});var a=ye({},e[e.length-1].rect);if(n.thisAnimationDuration){var r=Le(n,!0);r&&(a.top-=r.f,a.left-=r.e)}n.fromRect=a}})}},addAnimationState:function(t){e.push(t)},removeAnimationState:function(t){e.splice(Pa(e,{target:t}),1)},animateAll:function(t){var n=this;if(!this.options.animation){clearTimeout(o),typeof t=="function"&&t();return}var a=!1,r=0;e.forEach(function(l){var u=0,s=l.target,p=s.fromRect,f=q(s),h=s.prevFromRect,E=s.prevToRect,g=l.rect,v=Le(s,!0);v&&(f.top-=v.f,f.left-=v.e),s.toRect=f,s.thisAnimationDuration&&At(h,f)&&!At(p,f)&&(g.top-f.top)/(g.left-f.left)===(p.top-f.top)/(p.left-f.left)&&(u=Ra(g,h,E,n.options)),At(f,p)||(s.prevFromRect=p,s.prevToRect=f,u||(u=n.options.animation),n.animate(s,g,f,u)),u&&(a=!0,r=Math.max(r,u),clearTimeout(s.animationResetTimer),s.animationResetTimer=setTimeout(function(){s.animationTime=0,s.prevFromRect=null,s.fromRect=null,s.prevToRect=null,s.thisAnimationDuration=null},u),s.thisAnimationDuration=u)}),clearTimeout(o),a?o=setTimeout(function(){typeof t=="function"&&t()},r):typeof t=="function"&&t(),e=[]},animate:function(t,n,a,r){if(r){w(t,"transition",""),w(t,"transform","");var l=Le(this.el),u=l&&l.a,s=l&&l.d,p=(n.left-a.left)/(u||1),f=(n.top-a.top)/(s||1);t.animatingX=!!p,t.animatingY=!!f,w(t,"transform","translate3d("+p+"px,"+f+"px,0)"),this.forRepaintDummy=Ua(t),w(t,"transition","transform "+r+"ms"+(this.options.easing?" "+this.options.easing:"")),w(t,"transform","translate3d(0,0,0)"),typeof t.animated=="number"&&clearTimeout(t.animated),t.animated=setTimeout(function(){w(t,"transition",""),w(t,"transform",""),t.animated=!1,t.animatingX=!1,t.animatingY=!1},r)}}}}function Ua(e){return e.offsetWidth}function Ra(e,o,t,n){return Math.sqrt(Math.pow(o.top-e.top,2)+Math.pow(o.left-e.left,2))/Math.sqrt(Math.pow(o.top-t.top,2)+Math.pow(o.left-t.left,2))*n.animation}var Ue=[],Pt={initializeByDefault:!0},rt={mount:function(e){for(var o in Pt)Pt.hasOwnProperty(o)&&!(o in e)&&(e[o]=Pt[o]);Ue.forEach(function(t){if(t.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),Ue.push(e)},pluginEvent:function(e,o,t){var n=this;this.eventCanceled=!1,t.cancel=function(){n.eventCanceled=!0};var a=e+"Global";Ue.forEach(function(r){o[r.pluginName]&&(o[r.pluginName][a]&&o[r.pluginName][a](ye({sortable:o},t)),o.options[r.pluginName]&&o[r.pluginName][e]&&o[r.pluginName][e](ye({sortable:o},t)))})},initializePlugins:function(e,o,t,n){Ue.forEach(function(l){var u=l.pluginName;if(!(!e.options[u]&&!l.initializeByDefault)){var s=new l(e,o,e.options);s.sortable=e,s.options=e.options,e[u]=s,we(t,s.defaults)}});for(var a in e.options)if(e.options.hasOwnProperty(a)){var r=this.modifyOption(e,a,e.options[a]);typeof r<"u"&&(e.options[a]=r)}},getEventProperties:function(e,o){var t={};return Ue.forEach(function(n){typeof n.eventProperties=="function"&&we(t,n.eventProperties.call(o[n.pluginName],e))}),t},modifyOption:function(e,o,t){var n;return Ue.forEach(function(a){e[a.pluginName]&&a.optionListeners&&typeof a.optionListeners[o]=="function"&&(n=a.optionListeners[o].call(e[a.pluginName],t))}),n}};function ja(e){var o=e.sortable,t=e.rootEl,n=e.name,a=e.targetEl,r=e.cloneEl,l=e.toEl,u=e.fromEl,s=e.oldIndex,p=e.newIndex,f=e.oldDraggableIndex,h=e.newDraggableIndex,E=e.originalEvent,g=e.putSortable,v=e.extraEventProperties;if(o=o||t&&t[de],!!o){var _,X=o.options,M="on"+n.charAt(0).toUpperCase()+n.substr(1);window.CustomEvent&&!ke&&!at?_=new CustomEvent(n,{bubbles:!0,cancelable:!0}):(_=document.createEvent("Event"),_.initEvent(n,!0,!0)),_.to=l||t,_.from=u||t,_.item=a||t,_.clone=r,_.oldIndex=s,_.newIndex=p,_.oldDraggableIndex=f,_.newDraggableIndex=h,_.originalEvent=E,_.pullMode=g?g.lastPutMode:void 0;var F=ye(ye({},v),rt.getEventProperties(n,o));for(var U in F)_[U]=F[U];t&&t.dispatchEvent(_),X[M]&&X[M].call(o,_)}}var $a=["evt"],le=function(e,o){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=t.evt,a=Ia(t,$a);rt.pluginEvent.bind(k)(e,o,ye({dragEl:d,parentEl:B,ghostEl:x,rootEl:V,nextEl:Me,lastDownEl:vt,cloneEl:j,cloneHidden:Ce,dragStarted:Je,putSortable:K,activeSortable:k.active,originalEvent:n,oldIndex:Ye,oldDraggableIndex:tt,newIndex:ce,newDraggableIndex:De,hideGhostForTarget:jo,unhideGhostForTarget:$o,cloneNowHidden:function(){Ce=!0},cloneNowShown:function(){Ce=!1},dispatchSortableEvent:function(r){oe({sortable:o,name:r,originalEvent:n})}},a))};function oe(e){ja(ye({putSortable:K,cloneEl:j,targetEl:d,rootEl:V,oldIndex:Ye,oldDraggableIndex:tt,newIndex:ce,newDraggableIndex:De},e))}var d,B,x,V,Me,vt,j,Ce,Ye,ce,tt,De,dt,K,$e=!1,kt=!1,St=[],Ae,ve,Mt,Vt,go,_o,Je,Re,ot,nt=!1,pt=!1,gt,te,Ft=[],Xt=!1,Et=[],xt=typeof document<"u",ft=Oo,yo=at||ke?"cssFloat":"float",Ba=xt&&!Io&&!Oo&&"draggable"in document.createElement("div"),Fo=function(){if(xt){if(ke)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto",e.style.pointerEvents==="auto"}}(),Uo=function(e,o){var t=w(e),n=parseInt(t.width)-parseInt(t.paddingLeft)-parseInt(t.paddingRight)-parseInt(t.borderLeftWidth)-parseInt(t.borderRightWidth),a=He(e,0,o),r=He(e,1,o),l=a&&w(a),u=r&&w(r),s=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+q(a).width,p=u&&parseInt(u.marginLeft)+parseInt(u.marginRight)+q(r).width;if(t.display==="flex")return t.flexDirection==="column"||t.flexDirection==="column-reverse"?"vertical":"horizontal";if(t.display==="grid")return t.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(a&&l.float&&l.float!=="none"){var f=l.float==="left"?"left":"right";return r&&(u.clear==="both"||u.clear===f)?"vertical":"horizontal"}return a&&(l.display==="block"||l.display==="flex"||l.display==="table"||l.display==="grid"||s>=n&&t[yo]==="none"||r&&t[yo]==="none"&&s+p>n)?"vertical":"horizontal"},Xa=function(e,o,t){var n=t?e.left:e.top,a=t?e.right:e.bottom,r=t?e.width:e.height,l=t?o.left:o.top,u=t?o.right:o.bottom,s=t?o.width:o.height;return n===l||a===u||n+r/2===l+s/2},Ya=function(e,o){var t;return St.some(function(n){var a=n[de].options.emptyInsertThreshold;if(!(!a||Qt(n))){var r=q(n),l=e>=r.left-a&&e<=r.right+a,u=o>=r.top-a&&o<=r.bottom+a;if(l&&u)return t=n}}),t},Ro=function(e){function o(a,r){return function(l,u,s,p){var f=l.options.group.name&&u.options.group.name&&l.options.group.name===u.options.group.name;if(a==null&&(r||f))return!0;if(a==null||a===!1)return!1;if(r&&a==="clone")return a;if(typeof a=="function")return o(a(l,u,s,p),r)(l,u,s,p);var h=(r?l:u).options.group.name;return a===!0||typeof a=="string"&&a===h||a.join&&a.indexOf(h)>-1}}var t={},n=e.group;(!n||ht(n)!="object")&&(n={name:n}),t.name=n.name,t.checkPull=o(n.pull,!0),t.checkPut=o(n.put),t.revertClone=n.revertClone,e.group=t},jo=function(){!Fo&&x&&w(x,"display","none")},$o=function(){!Fo&&x&&w(x,"display","")};xt&&!Io&&document.addEventListener("click",function(e){if(kt)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),kt=!1,!1},!0);var Pe=function(e){if(d){e=e.touches?e.touches[0]:e;var o=Ya(e.clientX,e.clientY);if(o){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.target=t.rootEl=o,t.preventDefault=void 0,t.stopPropagation=void 0,o[de]._onDragOver(t)}}},Wa=function(e){d&&d.parentNode[de]._isOutsideThisEl(e.target)};function k(e,o){if(!(e&&e.nodeType&&e.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=o=we({},o),e[de]=this;var t={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Uo(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(r,l){r.setData("Text",l.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:k.supportPointer!==!1&&"PointerEvent"in window&&!Ke,emptyInsertThreshold:5};rt.initializePlugins(this,e,t);for(var n in t)!(n in o)&&(o[n]=t[n]);Ro(o);for(var a in this)a.charAt(0)==="_"&&typeof this[a]=="function"&&(this[a]=this[a].bind(this));this.nativeDraggable=o.forceFallback?!1:Ba,this.nativeDraggable&&(this.options.touchStartThreshold=1),o.supportPointer?N(e,"pointerdown",this._onTapStart):(N(e,"mousedown",this._onTapStart),N(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(N(e,"dragover",this),N(e,"dragenter",this)),St.push(this.el),o.store&&o.store.get&&this.sort(o.store.get(this)||[]),we(this,Fa())}k.prototype={constructor:k,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(Re=null)},_getDirection:function(e,o){return typeof this.options.direction=="function"?this.options.direction.call(this,e,o,d):this.options.direction},_onTapStart:function(e){if(e.cancelable){var o=this,t=this.el,n=this.options,a=n.preventOnFilter,r=e.type,l=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,u=(l||e).target,s=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||u,p=n.filter;if(Qa(t),!d&&!(/mousedown|pointerdown/.test(r)&&e.button!==0||n.disabled)&&!s.isContentEditable&&!(!this.nativeDraggable&&Ke&&u&&u.tagName.toUpperCase()==="SELECT")&&(u=ge(u,n.draggable,t,!1),!(u&&u.animated)&&vt!==u)){if(Ye=fe(u),tt=fe(u,n.draggable),typeof p=="function"){if(p.call(this,e,u,this)){oe({sortable:o,rootEl:s,name:"filter",targetEl:u,toEl:t,fromEl:t}),le("filter",o,{evt:e}),a&&e.cancelable&&e.preventDefault();return}}else if(p&&(p=p.split(",").some(function(f){if(f=ge(s,f.trim(),t,!1),f)return oe({sortable:o,rootEl:f,name:"filter",targetEl:u,fromEl:t,toEl:t}),le("filter",o,{evt:e}),!0}),p)){a&&e.cancelable&&e.preventDefault();return}n.handle&&!ge(s,n.handle,t,!1)||this._prepareDragStart(e,l,u)}}},_prepareDragStart:function(e,o,t){var n=this,a=n.el,r=n.options,l=a.ownerDocument,u;if(t&&!d&&t.parentNode===a){var s=q(t);if(V=a,d=t,B=d.parentNode,Me=d.nextSibling,vt=t,dt=r.group,k.dragged=d,Ae={target:d,clientX:(o||e).clientX,clientY:(o||e).clientY},go=Ae.clientX-s.left,_o=Ae.clientY-s.top,this._lastX=(o||e).clientX,this._lastY=(o||e).clientY,d.style["will-change"]="all",u=function(){if(le("delayEnded",n,{evt:e}),k.eventCanceled){n._onDrop();return}n._disableDelayedDragEvents(),!fo&&n.nativeDraggable&&(d.draggable=!0),n._triggerDragStart(e,o),oe({sortable:n,name:"choose",originalEvent:e}),ue(d,r.chosenClass,!0)},r.ignore.split(",").forEach(function(p){Ao(d,p.trim(),Ut)}),N(l,"dragover",Pe),N(l,"mousemove",Pe),N(l,"touchmove",Pe),N(l,"mouseup",n._onDrop),N(l,"touchend",n._onDrop),N(l,"touchcancel",n._onDrop),fo&&this.nativeDraggable&&(this.options.touchStartThreshold=4,d.draggable=!0),le("delayStart",this,{evt:e}),r.delay&&(!r.delayOnTouchOnly||o)&&(!this.nativeDraggable||!(at||ke))){if(k.eventCanceled){this._onDrop();return}N(l,"mouseup",n._disableDelayedDrag),N(l,"touchend",n._disableDelayedDrag),N(l,"touchcancel",n._disableDelayedDrag),N(l,"mousemove",n._delayedDragTouchMoveHandler),N(l,"touchmove",n._delayedDragTouchMoveHandler),r.supportPointer&&N(l,"pointermove",n._delayedDragTouchMoveHandler),n._dragStartTimer=setTimeout(u,r.delay)}else u()}},_delayedDragTouchMoveHandler:function(e){var o=e.touches?e.touches[0]:e;Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){d&&Ut(d),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;I(e,"mouseup",this._disableDelayedDrag),I(e,"touchend",this._disableDelayedDrag),I(e,"touchcancel",this._disableDelayedDrag),I(e,"mousemove",this._delayedDragTouchMoveHandler),I(e,"touchmove",this._delayedDragTouchMoveHandler),I(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,o){o=o||e.pointerType=="touch"&&e,!this.nativeDraggable||o?this.options.supportPointer?N(document,"pointermove",this._onTouchMove):o?N(document,"touchmove",this._onTouchMove):N(document,"mousemove",this._onTouchMove):(N(d,"dragend",this),N(V,"dragstart",this._onDragStart));try{document.selection?_t(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,o){if($e=!1,V&&d){le("dragStarted",this,{evt:o}),this.nativeDraggable&&N(document,"dragover",Wa);var t=this.options;!e&&ue(d,t.dragClass,!1),ue(d,t.ghostClass,!0),k.active=this,e&&this._appendGhost(),oe({sortable:this,name:"start",originalEvent:o})}else this._nulling()},_emulateDragOver:function(){if(ve){this._lastX=ve.clientX,this._lastY=ve.clientY,jo();for(var e=document.elementFromPoint(ve.clientX,ve.clientY),o=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(ve.clientX,ve.clientY),e!==o);)o=e;if(d.parentNode[de]._isOutsideThisEl(e),o)do{if(o[de]){var t=void 0;if(t=o[de]._onDragOver({clientX:ve.clientX,clientY:ve.clientY,target:e,rootEl:o}),t&&!this.options.dragoverBubble)break}e=o}while(o=o.parentNode);$o()}},_onTouchMove:function(e){if(Ae){var o=this.options,t=o.fallbackTolerance,n=o.fallbackOffset,a=e.touches?e.touches[0]:e,r=x&&Le(x,!0),l=x&&r&&r.a,u=x&&r&&r.d,s=ft&&te&&vo(te),p=(a.clientX-Ae.clientX+n.x)/(l||1)+(s?s[0]-Ft[0]:0)/(l||1),f=(a.clientY-Ae.clientY+n.y)/(u||1)+(s?s[1]-Ft[1]:0)/(u||1);if(!k.active&&!$e){if(t&&Math.max(Math.abs(a.clientX-this._lastX),Math.abs(a.clientY-this._lastY))<t)return;this._onDragStart(e,!0)}if(x){r?(r.e+=p-(Mt||0),r.f+=f-(Vt||0)):r={a:1,b:0,c:0,d:1,e:p,f};var h="matrix(".concat(r.a,",").concat(r.b,",").concat(r.c,",").concat(r.d,",").concat(r.e,",").concat(r.f,")");w(x,"webkitTransform",h),w(x,"mozTransform",h),w(x,"msTransform",h),w(x,"transform",h),Mt=p,Vt=f,ve=a}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!x){var e=this.options.fallbackOnBody?document.body:V,o=q(d,!0,ft,!0,e),t=this.options;if(ft){for(te=e;w(te,"position")==="static"&&w(te,"transform")==="none"&&te!==document;)te=te.parentNode;te!==document.body&&te!==document.documentElement?(te===document&&(te=_e()),o.top+=te.scrollTop,o.left+=te.scrollLeft):te=_e(),Ft=vo(te)}x=d.cloneNode(!0),ue(x,t.ghostClass,!1),ue(x,t.fallbackClass,!0),ue(x,t.dragClass,!0),w(x,"transition",""),w(x,"transform",""),w(x,"box-sizing","border-box"),w(x,"margin",0),w(x,"top",o.top),w(x,"left",o.left),w(x,"width",o.width),w(x,"height",o.height),w(x,"opacity","0.8"),w(x,"position",ft?"absolute":"fixed"),w(x,"zIndex","100000"),w(x,"pointerEvents","none"),k.ghost=x,e.appendChild(x),w(x,"transform-origin",go/parseInt(x.style.width)*100+"% "+_o/parseInt(x.style.height)*100+"%")}},_onDragStart:function(e,o){var t=this,n=e.dataTransfer,a=t.options;if(le("dragStart",this,{evt:e}),k.eventCanceled){this._onDrop();return}le("setupClone",this),k.eventCanceled||(j=Vo(d),j.removeAttribute("id"),j.draggable=!1,j.style["will-change"]="",this._hideClone(),ue(j,this.options.chosenClass,!1),k.clone=j),t.cloneId=_t(function(){le("clone",t),!k.eventCanceled&&(t.options.removeCloneOnHide||V.insertBefore(j,d),t._hideClone(),oe({sortable:t,name:"clone"}))}),!o&&ue(d,a.dragClass,!0),o?(kt=!0,t._loopId=setInterval(t._emulateDragOver,50)):(I(document,"mouseup",t._onDrop),I(document,"touchend",t._onDrop),I(document,"touchcancel",t._onDrop),n&&(n.effectAllowed="move",a.setData&&a.setData.call(t,n,d)),N(document,"drop",t),w(d,"transform","translateZ(0)")),$e=!0,t._dragStartId=_t(t._dragStarted.bind(t,o,e)),N(document,"selectstart",t),Je=!0,Ke&&w(document.body,"user-select","none")},_onDragOver:function(e){var o=this.el,t=e.target,n,a,r,l=this.options,u=l.group,s=k.active,p=dt===u,f=l.sort,h=K||s,E,g=this,v=!1;if(Xt)return;function _(me,ze){le(me,g,ye({evt:e,isOwner:p,axis:E?"vertical":"horizontal",revert:r,dragRect:n,targetRect:a,canSort:f,fromSortable:h,target:t,completed:M,onMove:function(Oe,Ge){return mt(V,o,d,n,Oe,q(Oe),e,Ge)},changed:F},ze))}function X(){_("dragOverAnimationCapture"),g.captureAnimationState(),g!==h&&h.captureAnimationState()}function M(me){return _("dragOverCompleted",{insertion:me}),me&&(p?s._hideClone():s._showClone(g),g!==h&&(ue(d,K?K.options.ghostClass:s.options.ghostClass,!1),ue(d,l.ghostClass,!0)),K!==g&&g!==k.active?K=g:g===k.active&&K&&(K=null),h===g&&(g._ignoreWhileAnimating=t),g.animateAll(function(){_("dragOverAnimationComplete"),g._ignoreWhileAnimating=null}),g!==h&&(h.animateAll(),h._ignoreWhileAnimating=null)),(t===d&&!d.animated||t===o&&!t.animated)&&(Re=null),!l.dragoverBubble&&!e.rootEl&&t!==document&&(d.parentNode[de]._isOutsideThisEl(e.target),!me&&Pe(e)),!l.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),v=!0}function F(){ce=fe(d),De=fe(d,l.draggable),oe({sortable:g,name:"change",toEl:o,newIndex:ce,newDraggableIndex:De,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),t=ge(t,l.draggable,o,!0),_("dragOver"),k.eventCanceled)return v;if(d.contains(e.target)||t.animated&&t.animatingX&&t.animatingY||g._ignoreWhileAnimating===t)return M(!1);if(kt=!1,s&&!l.disabled&&(p?f||(r=B!==V):K===this||(this.lastPutMode=dt.checkPull(this,s,d,e))&&u.checkPut(this,s,d,e))){if(E=this._getDirection(e,t)==="vertical",n=q(d),_("dragOverValid"),k.eventCanceled)return v;if(r)return B=V,X(),this._hideClone(),_("revert"),k.eventCanceled||(Me?V.insertBefore(d,Me):V.appendChild(d)),M(!0);var U=Qt(o,l.draggable);if(!U||Ga(e,E,this)&&!U.animated){if(U===d)return M(!1);if(U&&o===e.target&&(t=U),t&&(a=q(t)),mt(V,o,d,n,t,a,e,!!t)!==!1)return X(),U&&U.nextSibling?o.insertBefore(d,U.nextSibling):o.appendChild(d),B=o,F(),M(!0)}else if(U&&za(e,E,this)){var ie=He(o,0,l,!0);if(ie===d)return M(!1);if(t=ie,a=q(t),mt(V,o,d,n,t,a,e,!1)!==!1)return X(),o.insertBefore(d,ie),B=o,F(),M(!0)}else if(t.parentNode===o){a=q(t);var S=0,O,ee=d.parentNode!==o,Y=!Xa(d.animated&&d.toRect||n,t.animated&&t.toRect||a,E),W=E?"top":"left",ae=ho(t,"top","top")||ho(d,"top","top"),Se=ae?ae.scrollTop:void 0;Re!==t&&(O=a[W],nt=!1,pt=!Y&&l.invertSwap||ee),S=qa(e,t,a,E,Y?1:l.swapThreshold,l.invertedSwapThreshold==null?l.swapThreshold:l.invertedSwapThreshold,pt,Re===t);var se;if(S!==0){var J=fe(d);do J-=S,se=B.children[J];while(se&&(w(se,"display")==="none"||se===x))}if(S===0||se===t)return M(!1);Re=t,ot=S;var Q=t.nextElementSibling,pe=!1;pe=S===1;var P=mt(V,o,d,n,t,a,e,pe);if(P!==!1)return(P===1||P===-1)&&(pe=P===1),Xt=!0,setTimeout(Ha,30),X(),pe&&!Q?o.appendChild(d):t.parentNode.insertBefore(d,pe?Q:t),ae&&Mo(ae,0,Se-ae.scrollTop),B=d.parentNode,O!==void 0&&!pt&&(gt=Math.abs(O-q(t)[W])),F(),M(!0)}if(o.contains(d))return M(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){I(document,"mousemove",this._onTouchMove),I(document,"touchmove",this._onTouchMove),I(document,"pointermove",this._onTouchMove),I(document,"dragover",Pe),I(document,"mousemove",Pe),I(document,"touchmove",Pe)},_offUpEvents:function(){var e=this.el.ownerDocument;I(e,"mouseup",this._onDrop),I(e,"touchend",this._onDrop),I(e,"pointerup",this._onDrop),I(e,"touchcancel",this._onDrop),I(document,"selectstart",this)},_onDrop:function(e){var o=this.el,t=this.options;if(ce=fe(d),De=fe(d,t.draggable),le("drop",this,{evt:e}),B=d&&d.parentNode,ce=fe(d),De=fe(d,t.draggable),k.eventCanceled){this._nulling();return}$e=!1,pt=!1,nt=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Yt(this.cloneId),Yt(this._dragStartId),this.nativeDraggable&&(I(document,"drop",this),I(o,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Ke&&w(document.body,"user-select",""),w(d,"transform",""),e&&(Je&&(e.cancelable&&e.preventDefault(),!t.dropBubble&&e.stopPropagation()),x&&x.parentNode&&x.parentNode.removeChild(x),(V===B||K&&K.lastPutMode!=="clone")&&j&&j.parentNode&&j.parentNode.removeChild(j),d&&(this.nativeDraggable&&I(d,"dragend",this),Ut(d),d.style["will-change"]="",Je&&!$e&&ue(d,K?K.options.ghostClass:this.options.ghostClass,!1),ue(d,this.options.chosenClass,!1),oe({sortable:this,name:"unchoose",toEl:B,newIndex:null,newDraggableIndex:null,originalEvent:e}),V!==B?(ce>=0&&(oe({rootEl:B,name:"add",toEl:B,fromEl:V,originalEvent:e}),oe({sortable:this,name:"remove",toEl:B,originalEvent:e}),oe({rootEl:B,name:"sort",toEl:B,fromEl:V,originalEvent:e}),oe({sortable:this,name:"sort",toEl:B,originalEvent:e})),K&&K.save()):ce!==Ye&&ce>=0&&(oe({sortable:this,name:"update",toEl:B,originalEvent:e}),oe({sortable:this,name:"sort",toEl:B,originalEvent:e})),k.active&&((ce==null||ce===-1)&&(ce=Ye,De=tt),oe({sortable:this,name:"end",toEl:B,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){le("nulling",this),V=d=B=x=Me=j=vt=Ce=Ae=ve=Je=ce=De=Ye=tt=Re=ot=K=dt=k.dragged=k.ghost=k.clone=k.active=null,Et.forEach(function(e){e.checked=!0}),Et.length=Mt=Vt=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":d&&(this._onDragOver(e),La(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],o,t=this.el.children,n=0,a=t.length,r=this.options;n<a;n++)o=t[n],ge(o,r.draggable,this.el,!1)&&e.push(o.getAttribute(r.dataIdAttr)||Za(o));return e},sort:function(e,o){var t={},n=this.el;this.toArray().forEach(function(a,r){var l=n.children[r];ge(l,this.options.draggable,n,!1)&&(t[a]=l)},this),o&&this.captureAnimationState(),e.forEach(function(a){t[a]&&(n.removeChild(t[a]),n.appendChild(t[a]))}),o&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,o){return ge(e,o||this.options.draggable,this.el,!1)},option:function(e,o){var t=this.options;if(o===void 0)return t[e];var n=rt.modifyOption(this,e,o);typeof n<"u"?t[e]=n:t[e]=o,e==="group"&&Ro(t)},destroy:function(){le("destroy",this);var e=this.el;e[de]=null,I(e,"mousedown",this._onTapStart),I(e,"touchstart",this._onTapStart),I(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(I(e,"dragover",this),I(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(o){o.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),St.splice(St.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!Ce){if(le("hideClone",this),k.eventCanceled)return;w(j,"display","none"),this.options.removeCloneOnHide&&j.parentNode&&j.parentNode.removeChild(j),Ce=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(Ce){if(le("showClone",this),k.eventCanceled)return;d.parentNode==V&&!this.options.group.revertClone?V.insertBefore(j,d):Me?V.insertBefore(j,Me):V.appendChild(j),this.options.group.revertClone&&this.animate(d,j),w(j,"display",""),Ce=!1}}};function La(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function mt(e,o,t,n,a,r,l,u){var s,p=e[de],f=p.options.onMove,h;return window.CustomEvent&&!ke&&!at?s=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(s=document.createEvent("Event"),s.initEvent("move",!0,!0)),s.to=o,s.from=e,s.dragged=t,s.draggedRect=n,s.related=a||o,s.relatedRect=r||q(o),s.willInsertAfter=u,s.originalEvent=l,e.dispatchEvent(s),f&&(h=f.call(p,s,l)),h}function Ut(e){e.draggable=!1}function Ha(){Xt=!1}function za(e,o,t){var n=q(He(t.el,0,t.options,!0)),a=10;return o?e.clientX<n.left-a||e.clientY<n.top&&e.clientX<n.right:e.clientY<n.top-a||e.clientY<n.bottom&&e.clientX<n.left}function Ga(e,o,t){var n=q(Qt(t.el,t.options.draggable)),a=10;return o?e.clientX>n.right+a||e.clientX<=n.right&&e.clientY>n.bottom&&e.clientX>=n.left:e.clientX>n.right&&e.clientY>n.top||e.clientX<=n.right&&e.clientY>n.bottom+a}function qa(e,o,t,n,a,r,l,u){var s=n?e.clientY:e.clientX,p=n?t.height:t.width,f=n?t.top:t.left,h=n?t.bottom:t.right,E=!1;if(!l){if(u&&gt<p*a){if(!nt&&(ot===1?s>f+p*r/2:s<h-p*r/2)&&(nt=!0),nt)E=!0;else if(ot===1?s<f+gt:s>h-gt)return-ot}else if(s>f+p*(1-a)/2&&s<h-p*(1-a)/2)return Ja(o)}return E=E||l,E&&(s<f+p*r/2||s>h-p*r/2)?s>f+p/2?1:-1:0}function Ja(e){return fe(d)<fe(e)?1:-1}function Za(e){for(var o=e.tagName+e.className+e.src+e.href+e.textContent,t=o.length,n=0;t--;)n+=o.charCodeAt(t);return n.toString(36)}function Qa(e){Et.length=0;for(var o=e.getElementsByTagName("input"),t=o.length;t--;){var n=o[t];n.checked&&Et.push(n)}}function _t(e){return setTimeout(e,0)}function Yt(e){return clearTimeout(e)}xt&&N(document,"touchmove",function(e){(k.active||$e)&&e.cancelable&&e.preventDefault()});k.utils={on:N,off:I,css:w,find:Ao,is:function(e,o){return!!ge(e,o,e,!1)},extend:Ma,throttle:Po,closest:ge,toggleClass:ue,clone:Vo,index:fe,nextTick:_t,cancelNextTick:Yt,detectDirection:Uo,getChild:He};k.get=function(e){return e[de]};k.mount=function(){for(var e=arguments.length,o=new Array(e),t=0;t<e;t++)o[t]=arguments[t];o[0].constructor===Array&&(o=o[0]),o.forEach(function(n){if(!n.prototype||!n.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(n));n.utils&&(k.utils=ye(ye({},k.utils),n.utils)),rt.mount(n)})};k.create=function(e,o){return new k(e,o)};k.version=Na;var G=[],Ze,Wt,Lt=!1,Rt,jt,Dt,Qe;function Ka(){function e(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var o in this)o.charAt(0)==="_"&&typeof this[o]=="function"&&(this[o]=this[o].bind(this))}return e.prototype={dragStarted:function(o){var t=o.originalEvent;this.sortable.nativeDraggable?N(document,"dragover",this._handleAutoScroll):this.options.supportPointer?N(document,"pointermove",this._handleFallbackAutoScroll):t.touches?N(document,"touchmove",this._handleFallbackAutoScroll):N(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(o){var t=o.originalEvent;!this.options.dragOverBubble&&!t.rootEl&&this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?I(document,"dragover",this._handleAutoScroll):(I(document,"pointermove",this._handleFallbackAutoScroll),I(document,"touchmove",this._handleFallbackAutoScroll),I(document,"mousemove",this._handleFallbackAutoScroll)),bo(),yt(),Va()},nulling:function(){Dt=Wt=Ze=Lt=Qe=Rt=jt=null,G.length=0},_handleFallbackAutoScroll:function(o){this._handleAutoScroll(o,!0)},_handleAutoScroll:function(o,t){var n=this,a=(o.touches?o.touches[0]:o).clientX,r=(o.touches?o.touches[0]:o).clientY,l=document.elementFromPoint(a,r);if(Dt=o,t||this.options.forceAutoScrollFallback||at||ke||Ke){$t(o,this.options,l,t);var u=Te(l,!0);Lt&&(!Qe||a!==Rt||r!==jt)&&(Qe&&bo(),Qe=setInterval(function(){var s=Te(document.elementFromPoint(a,r),!0);s!==u&&(u=s,yt()),$t(o,n.options,s,t)},10),Rt=a,jt=r)}else{if(!this.options.bubbleScroll||Te(l,!0)===_e()){yt();return}$t(o,this.options,Te(l,!1),!1)}}},we(e,{pluginName:"scroll",initializeByDefault:!0})}function yt(){G.forEach(function(e){clearInterval(e.pid)}),G=[]}function bo(){clearInterval(Qe)}var $t=Po(function(e,o,t,n){if(o.scroll){var a=(e.touches?e.touches[0]:e).clientX,r=(e.touches?e.touches[0]:e).clientY,l=o.scrollSensitivity,u=o.scrollSpeed,s=_e(),p=!1,f;Wt!==t&&(Wt=t,yt(),Ze=o.scroll,f=o.scrollFn,Ze===!0&&(Ze=Te(t,!0)));var h=0,E=Ze;do{var g=E,v=q(g),_=v.top,X=v.bottom,M=v.left,F=v.right,U=v.width,ie=v.height,S=void 0,O=void 0,ee=g.scrollWidth,Y=g.scrollHeight,W=w(g),ae=g.scrollLeft,Se=g.scrollTop;g===s?(S=U<ee&&(W.overflowX==="auto"||W.overflowX==="scroll"||W.overflowX==="visible"),O=ie<Y&&(W.overflowY==="auto"||W.overflowY==="scroll"||W.overflowY==="visible")):(S=U<ee&&(W.overflowX==="auto"||W.overflowX==="scroll"),O=ie<Y&&(W.overflowY==="auto"||W.overflowY==="scroll"));var se=S&&(Math.abs(F-a)<=l&&ae+U<ee)-(Math.abs(M-a)<=l&&!!ae),J=O&&(Math.abs(X-r)<=l&&Se+ie<Y)-(Math.abs(_-r)<=l&&!!Se);if(!G[h])for(var Q=0;Q<=h;Q++)G[Q]||(G[Q]={});(G[h].vx!=se||G[h].vy!=J||G[h].el!==g)&&(G[h].el=g,G[h].vx=se,G[h].vy=J,clearInterval(G[h].pid),(se!=0||J!=0)&&(p=!0,G[h].pid=setInterval((function(){n&&this.layer===0&&k.active._onTouchMove(Dt);var pe=G[this.layer].vy?G[this.layer].vy*u:0,P=G[this.layer].vx?G[this.layer].vx*u:0;typeof f=="function"&&f.call(k.dragged.parentNode[de],P,pe,e,Dt,G[this.layer].el)!=="continue"||Mo(G[this.layer].el,P,pe)}).bind({layer:h}),24))),h++}while(o.bubbleScroll&&E!==s&&(E=Te(E,!1)));Lt=p}},30),Bo=function(e){var o=e.originalEvent,t=e.putSortable,n=e.dragEl,a=e.activeSortable,r=e.dispatchSortableEvent,l=e.hideGhostForTarget,u=e.unhideGhostForTarget;if(o){var s=t||a;l();var p=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:o,f=document.elementFromPoint(p.clientX,p.clientY);u(),s&&!s.el.contains(f)&&(r("spill"),this.onSpill({dragEl:n,putSortable:t}))}};function Kt(){}Kt.prototype={startIndex:null,dragStart:function(e){var o=e.oldDraggableIndex;this.startIndex=o},onSpill:function(e){var o=e.dragEl,t=e.putSortable;this.sortable.captureAnimationState(),t&&t.captureAnimationState();var n=He(this.sortable.el,this.startIndex,this.options);n?this.sortable.el.insertBefore(o,n):this.sortable.el.appendChild(o),this.sortable.animateAll(),t&&t.animateAll()},drop:Bo};we(Kt,{pluginName:"revertOnSpill"});function eo(){}eo.prototype={onSpill:function(e){var o=e.dragEl,t=e.putSortable,n=t||this.sortable;n.captureAnimationState(),o.parentNode&&o.parentNode.removeChild(o),n.animateAll()},drop:Bo};we(eo,{pluginName:"removeOnSpill"});k.mount(new Ka);k.mount(eo,Kt);function er(e){return e==null?e:JSON.parse(JSON.stringify(e))}function tr(e){Gt()&&Fn(e)}function or(e){Gt()?Un(e):e()}const wo="__CLONE__DRAGGABLE__ELEMENT__NODE__";function Ht(...e){var o,t;const n=(o=Gt())==null?void 0:o.proxy,a=e[0];let[,r,l]=e;Array.isArray(y(r))||(l=r,r=null);let u=null;const{immediate:s=!0,clone:p=er}=(t=y(l))!=null?t:{};function f(S){var O;S.item[wo]=p(y((O=y(r))==null?void 0:O[S.oldIndex]))}function h(S){const O=S.item[wo];wa(O)||(Nt(S.item),ba(y(r),S.newIndex,O))}function E(S){const{from:O,item:ee,oldIndex:Y,pullMode:W,clone:ae}=S;if(W==="clone"){co(O,ee,Y),Nt(ae);return}ya(y(r),Y)}function g(S){const{from:O,item:ee,oldIndex:Y,newIndex:W}=S;Nt(ee),co(O,ee,Y),va(y(r),Y,W)}const v={onUpdate:g,onStart:f,onAdd:h,onRemove:E};function _(S){const O=y(a);return S||(S=ka(O)?Sa(O,n==null?void 0:n.$el):O),S&&!xa(S)&&(S=S.$el),S||ha("Root element not found"),S}function X(){var S;const O=(S=y(l))!=null?S:{},ee=Co(O,["immediate","clone"]);return Da(r===null?{}:v,ee)}const M=S=>{S=_(S),u&&F.destroy(),u=new k(S,X())};An(l,()=>{u&&Ca(X(),(S,O)=>{u==null||u.option(S,O)})},{deep:!0});const F={option:(S,O)=>u==null?void 0:u.option(S,O),destroy:()=>{u==null||u.destroy(),u=null},save:()=>u==null?void 0:u.save(),toArray:()=>u==null?void 0:u.toArray(),closest:(...S)=>u==null?void 0:u.closest(...S)},U=()=>F==null?void 0:F.option("disabled",!0),ie=()=>F==null?void 0:F.option("disabled",!1);return or(()=>{s&&M()}),tr(F.destroy),Xe({start:M,pause:U,resume:ie},F)}const zt=["update","start","add","remove","choose","unchoose","end","sort","filter","clone","move","change"],nr=["onUpdate","onStart","onAdd","onRemove","animation","ghostClass","group","sort","disabled","store","handle","draggable","swapThreshold","invertSwap","invertedSwapThreshold","removeCloneOnHide","direction","chosenClass","dragClass","ignore","filter","preventOnFilter","easing","setData","dropBubble","dragoverBubble","dataIdAttr","delay","delayOnTouchOnly","touchStartThreshold","forceFallback","fallbackClass","fallbackOnBody","fallbackTolerance","fallbackOffset","supportPointer","emptyInsertThreshold","scroll","forceAutoScrollFallback","scrollSensitivity","scrollSpeed","bubbleScroll","modelValue","tag","target",...zt.map(e=>`on${e.replace(/^\S/,o=>o.toUpperCase())}`)],ar=Pn({name:"VueDraggable",model:{prop:"modelValue",event:"update:modelValue"},props:nr,emits:["update:modelValue",...zt],setup(e,{slots:o,emit:t,expose:n}){const a=Mn(),r=zt.reduce((f,h)=>{const E=`on${h.replace(/^\S/,g=>g.toUpperCase())}`;return f[E]=g=>t(h,g),f},{}),l=oo(()=>{const f=Vn(e),h=Co(f,["modelValue"]),E=Object.entries(h).reduce((g,[v,_])=>{const X=y(_);return X!==void 0&&(g[v]=X),g},{});return Xe(Xe({},r),_a(Xe(Xe({},a),E)))}),u=oo({get:()=>e.modelValue,set:f=>t("update:modelValue",f)}),s=ne(),p=We(Ht(e.target||s,u,l));return n(p),()=>{if(o.default)return ko(e.tag||"div",{ref:s},o.default(p))}}});const rr={class:"draggable-item-content"},lr={key:0},ir={key:1},sr={key:2},ur={key:3},cr={key:4},dr={key:5},pr={key:0,class:"ui-special-item-container"},fr={__name:"UIDesign",props:{modelValue:{}},emits:["update:modelValue"],setup(e){const o=So(e,"modelValue"),{t}=qt(),n=Rn(o.value),a=We(n),r=ne(a.inputFields),l=ne(a.outputNodes),u=ne(a.triggerNodes),s=ne([{id:"typography-paragraph",required:!0,placeholder:t("components.workspace.uiDesign.typography-paragraph.placeholder"),show:!1,multiline:!0,value:"",password:!1,name:"typography-paragraph",display_name:"typography-paragraph",type:"str",clear_after_run:!0,list:!1,field_type:"typography-paragraph"}]),p=()=>{o.value.data.ui={inputFields:r.value,outputNodes:l.value}},f=ne(!1),h=ne(),E=We({animation:150,ghostClass:"ghost",handle:".handle",group:{name:"fields",pull:!1},onStart:()=>{f.value=!0},onAdd:()=>{p()},onEnd:()=>{p(),no(()=>{f.value=!1})}});Ht(h,r,E);const g=ne(),v=We({animation:150,ghostClass:"ghost",handle:".handle",group:{name:"fields",pull:!1},onStart:()=>{f.value=!0},onAdd:()=>{p()},onEnd:()=>{p(),no(()=>{f.value=!1})}});Ht(g,l,v);const _=(X,M)=>{X.splice(M,1),p()};return(X,M)=>{const F=D("a-menu-item"),U=D("a-tooltip"),ie=D("a-menu"),S=D("a-layout-sider"),O=D("a-typography-title"),ee=D("a-select"),Y=D("a-textarea"),W=D("a-input"),ae=D("a-input-number"),Se=D("a-checkbox"),se=D("a-form-item"),J=D("a-col"),Q=D("a-row"),pe=D("a-form"),P=D("a-divider"),me=D("a-button"),ze=D("a-popconfirm"),Oe=D("a-space"),Ge=D("cron-ant"),qe=D("a-card"),Ee=D("a-typography-paragraph"),lt=D("a-layout-content"),he=D("a-layout"),b=jn("highlight");return T(),z(he,{class:"ui-design-layout","has-sider":"",style:{height:"100%","min-height":"calc(100vh - 40px - 40px)"}},{default:m(()=>[c(S,{style:{overflow:"auto",backgroundColor:"#fff"},class:"custom-scrollbar"},{default:m(()=>[c(ie,{theme:"light",mode:"inline",ref:"siderMenu"},{default:m(()=>[c(y(ar),{modelValue:s.value,"onUpdate:modelValue":M[0]||(M[0]=i=>s.value=i),animation:"150",group:{name:"fields",pull:"clone",put:!1},sort:!1},{default:m(()=>[(T(!0),Z(xe,null,Be(s.value,(i,A)=>(T(),z(U,{key:`node-${A}`,title:y(t)(`components.workspace.uiDesign.${i.name}.tip`),placement:"right"},{default:m(()=>[c(F,{class:"draggable-menu-item",id:i.id},{default:m(()=>[c(y(It)),Ve("span",null,$(y(t)(`components.workspace.uiDesign.${i.name}.title`)),1)]),_:2},1032,["id"])]),_:2},1032,["title"]))),128))]),_:1},8,["modelValue"])]),_:1},512)]),_:1}),c(he,{style:{"background-color":"#fff"}},{default:m(()=>[c(lt,{style:{margin:"24px 16px 0",overflow:"initial"}},{default:m(()=>[c(Q,{gutter:[16,16]},{default:m(()=>[c(J,{xxl:6,xl:8,lg:10,md:24},{default:m(()=>[c(Q,{gutter:[16,16]},{default:m(()=>[c(O,{level:3},{default:m(()=>[c(y(ta),{class:"text-primary"}),L(" "+$(y(t)("workspace.workflowSpace.inputs")),1)]),_:1}),c(J,{span:24},{default:m(()=>[c(pe,{layout:"vertical",ref_key:"inputFieldsEl",ref:h},{default:m(()=>[(T(!0),Z(xe,null,Be(r.value,(i,A)=>(T(),Z("div",{class:"draggable-item",key:`field-${i}-${A}`},[c(y(It),{class:"handle"}),y($n).includes(i.field_type)?je("",!0):(T(),z(se,{key:0,class:"draggable-item-content"},{label:m(()=>[L($(i.display_name),1)]),default:m(()=>[i.category=="llms"&&i=="temperature"?(T(),z(sa,{key:0,modelValue:i.value,"onUpdate:modelValue":C=>i.value=C},null,8,["modelValue","onUpdate:modelValue"])):i.field_type=="select"?(T(),z(ee,{key:1,value:i.value,"onUpdate:value":C=>i.value=C,options:i.options},null,8,["value","onUpdate:value","options"])):i.field_type=="textarea"?(T(),z(Y,{key:2,value:i.value,"onUpdate:value":C=>i.value=C,autoSize:!0,showCount:!0,placeholder:i.placeholder},null,8,["value","onUpdate:value","placeholder"])):i.field_type=="input"?(T(),z(W,{key:3,value:i.value,"onUpdate:value":C=>i.value=C,placeholder:i.placeholder},null,8,["value","onUpdate:value","placeholder"])):i.field_type=="number"?(T(),z(ae,{key:4,value:i.value,"onUpdate:value":C=>i.value=C,placeholder:i.placeholder},null,8,["value","onUpdate:value","placeholder"])):i.field_type=="checkbox"?(T(),z(Se,{key:5,checked:i.value,"onUpdate:checked":C=>i.value=C},null,8,["checked","onUpdate:checked"])):i.field_type=="file"?(T(),z(Eo,{key:6,modelValue:i.value,"onUpdate:modelValue":C=>i.value=C},null,8,["modelValue","onUpdate:modelValue"])):i.field_type=="list"?(T(),z(na,{key:7,modelValue:i.value,"onUpdate:modelValue":C=>i.value=C},null,8,["modelValue","onUpdate:modelValue"])):je("",!0)]),_:2},1024)),i.field_type=="typography-paragraph"?(T(),z(Q,{key:1,class:"draggable-item-content"},{default:m(()=>[c(J,{span:24,class:"ui-special-item-container"},{default:m(()=>[c(Y,{class:"ui-special-item",value:i.value,"onUpdate:value":C=>i.value=C,placeholder:i.placeholder,"auto-size":"",onChange:p},null,8,["value","onUpdate:value","placeholder"]),c(y(ao),{class:"ui-special-item-delete",onClick:C=>_(r.value,A)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)):je("",!0)]))),128))]),_:1},512)]),_:1}),c(P),c(J,{span:24},{default:m(()=>[c(Q,{gutter:[16,16]},{default:m(()=>[(T(!0),Z(xe,null,Be(u.value,i=>(T(),z(J,{key:`node-${i.id}`,span:24},{default:m(()=>[i.type=="ButtonTrigger"?(T(),z(me,{key:0,type:"primary",block:""},{default:m(()=>[L($(i.data.template.button_text.value),1)]),_:2},1024)):i.type=="ScheduleTrigger"?(T(),z(qe,{key:1,title:y(t)("components.nodes.triggers.ScheduleTrigger.schedule_settings")},{extra:m(()=>[c(Oe,null,{default:m(()=>[c(me,{type:"primary"},{default:m(()=>[L($(y(t)("components.nodes.triggers.ScheduleTrigger.save_schedule_settings")),1)]),_:1}),c(ze,{title:y(t)("workspace.workflowSpace.delete_schedule_trigger_confirm")},{default:m(()=>[c(me,{type:"primary",danger:""},{default:m(()=>[L($(y(t)("workspace.workflowSpace.delete")),1)]),_:1})]),_:1},8,["title"])]),_:1})]),default:m(()=>[c(Ge,{modelValue:i.data.template.schedule.value,"onUpdate:modelValue":A=>i.data.template.schedule.value=A,"button-props":{type:"primary",shape:"round"},locale:X.language},null,8,["modelValue","onUpdate:modelValue","locale"])]),_:2},1032,["title"])):je("",!0)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1}),c(J,{xxl:18,xl:16,lg:14,md:24},{default:m(()=>[c(O,{level:3,style:{display:"flex","justify-content":"space-between"}},{default:m(()=>[Ve("span",null,[c(y(oa),{class:"text-primary"}),L(" "+$(y(t)("workspace.workflowSpace.outputs")),1)])]),_:1}),c(Q,{gutter:[16,16],ref_key:"outputNodesEl",ref:g},{default:m(()=>[(T(!0),Z(xe,null,Be(l.value,(i,A)=>(T(),z(J,{span:24,class:"draggable-item",key:`node-${i.id}-${A}`},{default:m(()=>{var C;return[c(y(It),{class:"handle"}),Ve("div",rr,[i.type=="Text"?(T(),Z("div",lr,[c(O,{level:5},{default:m(()=>[L($(i.data.template.output_title.value),1)]),_:2},1024),i.data.template.render_markdown.value?(T(),Z(xe,{key:0},[Bt(c(y(Bn),{source:i.data.template.text.value,class:"markdown-body custom-hljs"},null,8,["source"]),[[b]]),c(Ee,{copyable:{text:i.data.template.text.value}},null,8,["copyable"])],64)):(T(),z(Ee,{key:1,copyable:{text:i.data.template.text.value}},{default:m(()=>[L($(i.data.template.text.value),1)]),_:2},1032,["copyable"]))])):i.type=="Audio"?(T(),Z("div",ir,[c(aa,{audios:[(C=i.data.template.audio_url)==null?void 0:C.value]},null,8,["audios"])])):i.type=="Mindmap"?(T(),Z("div",sr,[c(ra,{content:i.data.template.content.value,style:{width:"100%","min-height":"50vh"}},null,8,["content"])])):i.type=="Mermaid"?(T(),Z("div",ur,[c(la,{content:i.data.template.content.value,style:{width:"100%","min-height":"50vh"}},null,8,["content"])])):i.type=="Echarts"?(T(),Z("div",cr,[c(ia,{option:i.data.template.option.value,style:{width:"100%","min-height":"50vh"}},null,8,["option"])])):(T(),Z("div",dr,[i.field_type=="typography-paragraph"?(T(),Z("div",pr,[c(Y,{class:"ui-special-item",value:i.value,"onUpdate:value":H=>i.value=H,placeholder:i.placeholder,"auto-size":"",onChange:p},null,8,["value","onUpdate:value","placeholder"]),c(y(ao),{class:"ui-special-item-delete",onClick:H=>_(l.value,A)},null,8,["onClick"])])):je("",!0)]))])]}),_:2},1024))),128))]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}},mr=Jt(fr,[["__scopeId","data-v-01ce6c33"]]);const hr={__name:"VueFlowStyleSettings",props:{modelValue:{}},emits:Xn(["save"],["update:modelValue"]),setup(e,{emit:o}){const t=So(e,"modelValue"),{t:n}=qt(),a=ne(!1),r=()=>{o("save",t),a.value=!1};return(l,u)=>{const s=D("a-button"),p=D("a-select-option"),f=D("a-select"),h=D("a-form-item"),E=D("a-switch"),g=D("a-form"),v=D("a-drawer");return T(),Z(xe,null,[c(s,{onClick:u[0]||(u[0]=_=>a.value=!0),class:"settings-button"},{default:m(()=>[L($(y(n)("components.workspace.vueFlowStyleSettings.title")),1)]),_:1}),c(v,{open:a.value,"onUpdate:open":u[3]||(u[3]=_=>a.value=_),class:"custom-class",title:y(n)("components.workspace.vueFlowStyleSettings.title"),placement:"right"},{extra:m(()=>[c(s,{type:"primary",onClick:r},{default:m(()=>[L($(y(n)("common.save")),1)]),_:1})]),default:m(()=>[c(g,{model:t.value,"label-col":{span:8},"wrapper-col":{span:16},autocomplete:"off"},{default:m(()=>[c(h,{label:y(n)("components.workspace.vueFlowStyleSettings.edge_type"),name:"edge_type"},{default:m(()=>[c(f,{value:t.value.edge.type,"onUpdate:value":u[1]||(u[1]=_=>t.value.edge.type=_)},{default:m(()=>[c(p,{value:"bezier"},{default:m(()=>[L($(y(n)("components.workspace.vueFlowStyleSettings.edge_type_bezier")),1)]),_:1}),c(p,{value:"step"},{default:m(()=>[L($(y(n)("components.workspace.vueFlowStyleSettings.edge_type_step")),1)]),_:1}),c(p,{value:"smoothstep"},{default:m(()=>[L($(y(n)("components.workspace.vueFlowStyleSettings.edge_type_smoothstep")),1)]),_:1}),c(p,{value:"straight"},{default:m(()=>[L($(y(n)("components.workspace.vueFlowStyleSettings.edge_type_straight")),1)]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),c(h,{label:y(n)("components.workspace.vueFlowStyleSettings.edge_animated"),name:"edge_animated"},{default:m(()=>[c(E,{checked:t.value.edge.animated,"onUpdate:checked":u[2]||(u[2]=_=>t.value.edge.animated=_)},null,8,["checked"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["open","title"])],64)}}},vr=Jt(hr,[["__scopeId","data-v-33ef65ae"]]);const gr={key:0,class:"loading-container"},_r={key:1,class:"editor-container"},yr={class:"title-container"},br=["data-node-type"],wr={__name:"WorkflowEditor",setup(e){const{t:o}=qt(),t=ne(!0),n=Yn(),a=Wn(),r=n.params.workflowId,l=ne(o("workspace.workflowEditor.workflow_canvas")),u=We([o("workspace.workflowEditor.workflow_info"),o("workspace.workflowEditor.workflow_canvas"),o("workspace.workflowEditor.workflow_ui_design")]),s=Kn(),{userDatabases:p}=ro(s),f=Ln(),h=Hn(),{vueFlowStyleSettings:E}=ro(h),g=ne(""),v=ne({}),_=ne([]),X=()=>{Se.value.forEach(b=>{b.type=E.value.edge.type,b.animated=E.value.edge.animated,b.style=E.value.edge.style}),h.setVueFlowStyleSettings(E.value)};zn(async()=>{const b=lo("get",{wid:r}),i=ua("list",{}),A=await b,C=await i;if(C.status==200&&s.setUserDatabases(C.data),A.status!=200){Ot.error(o("workspace.workflowSpace.get_workflow_failed")),a.push({name:"WorkflowSpaceMain"});return}v.value=A.data,v.value.data.nodes.forEach(H=>{H.category=="vectorDb"&&(H.data.template.database.options=p.value.filter(re=>re.status=="VALID").map(re=>({value:re.vid,label:re.name})))}),v.value.tags=v.value.tags.map(H=>H.tid),_.value=[...v.value.data.nodes,...v.value.data.edges],_.value.forEach(H=>{H.events={change:re=>J(),delete:re=>Q(re)}}),g.value=ct(v.value),t.value=!1});const M=()=>{const b=Y();v.value.data={...b,ui:v.value.data.ui||{}}},F=ne(!1),U=async()=>{F.value=!0;const b=v.value.data.ui||{},i=Y();v.value.data={...i,ui:b},(await lo("update",{wid:r,...v.value})).status==200?(Ot.success(o("workspace.workflowSpace.save_success")),g.value=ct(v.value)):Ot.error(o("workspace.workflowSpace.save_failed")),f.updateUserWorkflow(v.value),F.value=!1},ie=()=>{const b=v.value.data.ui||{},i=Y();v.value.data={...i,ui:b},g.value!=ct(v.value)?Zn.confirm({title:o("common.back"),icon:ko(Qn),content:o("workspace.workflowEditor.exit_not_saved_confirm"),okText:o("workspace.workflowEditor.save_and_exit"),cancelText:o("workspace.workflowEditor.exit_without_save"),onOk(){U().then(()=>{a.push({name:"WorkflowUse",params:{workflowId:r}})})},onCancel(){a.push({name:"WorkflowUse",params:{workflowId:r}})}}):a.push({name:"WorkflowUse",params:{workflowId:r}})},{addEdges:S,updateEdge:O,onConnect:ee,toObject:Y,viewport:W,vueFlowRef:ae,edges:Se}=zo();ee(b=>{b.type=E.value.edge.type,b.animated=E.value.edge.animated,b.style=E.value.edge.style,S([b])});const se=({edge:b,connection:i})=>{O(b,i)},J=b=>{},Q=b=>{_.value=_.value.filter(i=>i.id!==b.id),_.value=_.value.filter(i=>!(i.source&&i.source===b.id||i.target&&i.target===b.id))},pe=b=>{_.value=_.value.filter(i=>!(i.source===b.edge.source&&i.target===b.edge.target&&i.sourceHandle===b.edge.sourceHandle&&i.targetHandle===b.edge.targetHandle))};let P;const me=b=>{P&&document.body.removeChild(P);let i=b.target.getBoundingClientRect();P=b.target.cloneNode(!0),P.style.position="absolute",P.style.top=i.top+"px",P.style.left=i.left+"px",P.style.width=i.width+"px",P.style.height=i.height+"px",P.style.opacity="0.5",P.style.zIndex="1000",document.body.appendChild(P)},ze=b=>{P&&(P.style.left=b.touches[0].clientX+"px",P.style.top=b.touches[0].clientY+"px")},Oe=b=>{P&&(document.body.removeChild(P),P=null);let i=b.srcElement.dataset.nodeType;i||(i=b.srcElement.children[0].dataset.nodeType);const A=lt[i],C=In(),H=JSON.parse(JSON.stringify(qe[i].props.templateData));H.description=o(`components.nodes.${A}.${i}.description`),Object.keys(H.template).forEach(Ne=>{H.template[Ne].display_name=o(`components.nodes.${A}.${i}.${Ne}`)});const re=ae.value.getBoundingClientRect(),{x:Ct,y:it,zoom:st}=W.value;let Fe=0,Ie=0;b.type=="touchend"?(Fe=b.changedTouches[0].clientX-re.left,Ie=b.changedTouches[0].clientY-re.top):(Fe=b.clientX-re.left,Ie=b.clientY-re.top);const Tt={id:C,type:i,category:A,position:{x:(Fe-Ct)/st,y:(Ie-it)/st},data:H,events:{change:Ne=>J(),delete:Ne=>Q(Ne)}};_.value.push(Tt)},Ge=Object.assign({"/src/components/nodes/controlFlows/Conditional.vue":Go,"/src/components/nodes/controlFlows/Empty.vue":qo,"/src/components/nodes/controlFlows/RandomChoice.vue":Jo,"/src/components/nodes/fileProcessing/FileLoader.vue":Zo,"/src/components/nodes/imageGeneration/StableDiffusion.vue":Qo,"/src/components/nodes/llms/ChatGLM.vue":Ko,"/src/components/nodes/llms/OpenAI.vue":en,"/src/components/nodes/outputs/Document.vue":tn,"/src/components/nodes/outputs/Echarts.vue":on,"/src/components/nodes/outputs/Email.vue":nn,"/src/components/nodes/outputs/Mermaid.vue":an,"/src/components/nodes/outputs/Mindmap.vue":rn,"/src/components/nodes/outputs/Text.vue":ln,"/src/components/nodes/textProcessing/ListRender.vue":sn,"/src/components/nodes/textProcessing/MarkdownToHtml.vue":un,"/src/components/nodes/textProcessing/TemplateCompose.vue":cn,"/src/components/nodes/textProcessing/TextInOut.vue":dn,"/src/components/nodes/textProcessing/TextSplitters.vue":pn,"/src/components/nodes/textProcessing/TextTruncation.vue":fn,"/src/components/nodes/tools/ImageSearch.vue":mn,"/src/components/nodes/tools/ProgrammingFunction.vue":hn,"/src/components/nodes/triggers/ButtonTrigger.vue":vn,"/src/components/nodes/vectorDb/AddData.vue":gn,"/src/components/nodes/vectorDb/DeleteData.vue":_n,"/src/components/nodes/vectorDb/Search.vue":yn,"/src/components/nodes/webCrawlers/BilibiliCrawler.vue":bn,"/src/components/nodes/webCrawlers/TextCrawler.vue":wn,"/src/components/nodes/webCrawlers/YoutubeCrawler.vue":kn}),qe={},Ee={},lt={};Object.entries(Ge).forEach(([b,i])=>{const A=b.match(/\/([^/]+)\.vue$/)[1];qe[A]=Gn(i.default);const C=b.match(/\/([^/]+)\/[^/]+\.vue$/)[1];Ee[C]||(Ee[C]=[]),Ee[C].push(A),lt[A]=C});const he=We({open:!1,code:"",openEditor:async()=>{let b=Y();b.ui=v.value.data.ui||{},he.code=JSON.stringify(b,null,2),he.open=!0},updateCode:b=>{const i=JSON.parse(b);v.value.data.ui=i.ui||{},_.value=[...i.nodes,...i.edges],_.value.forEach(A=>{A.events={change:C=>J(),delete:C=>Q(C)}}),v.value.data.nodes=i.nodes,v.value.data.edges=i.edges,v.value.data.nodes.forEach(A=>{A.category=="vectorDb"&&(A.data.template.database.options=p.value.filter(C=>C.status=="VALID").map(C=>({value:C.vid,label:C.name})))}),g.value=ct(v.value)}});return(b,i)=>{const A=D("a-spin"),C=D("a-typography-link"),H=D("a-col"),re=D("a-typography-text"),Ct=D("a-segmented"),it=D("a-button"),st=D("a-space"),Fe=D("a-row"),Ie=D("a-divider"),Tt=D("a-menu-item"),Ne=D("a-sub-menu"),Xo=D("a-menu"),Yo=D("a-layout-sider"),Wo=D("a-layout-content"),to=D("a-layout");return t.value?(T(),Z("div",gr,[c(A,{size:"large"})])):(T(),Z("div",_r,[Ve("div",yr,[c(Fe,{type:"flex",align:"middle",justify:"space-between",gutter:[16,16],style:{width:"100%"}},{default:m(()=>[c(H,{flex:"0 0"},{default:m(()=>[c(C,{onClick:ie,style:{"text-wrap":"nowrap"}},{default:m(()=>[c(y(qn)),L(" "+$(y(o)("common.back")),1)]),_:1})]),_:1}),c(H,{flex:"0 0"},{default:m(()=>[c(re,{class:"title",editable:{triggerType:["text","icon"]},content:v.value.title,"onUpdate:content":i[0]||(i[0]=R=>v.value.title=R)},null,8,["content"])]),_:1}),c(H,{flex:"1 0",style:{display:"flex","justify-content":"center"}},{default:m(()=>[c(Ct,{value:l.value,"onUpdate:value":i[1]||(i[1]=R=>l.value=R),options:u,onChange:M},null,8,["value","options"])]),_:1}),c(H,{flex:"0 0",style:{display:"flex","justify-content":"end"}},{default:m(()=>[c(st,null,{default:m(()=>[c(it,{onClick:he.openEditor},{default:m(()=>[L($(y(o)("workspace.workflowEditor.edit_code"))+" ",1),c(Sn,{language:"json",open:he.open,"onUpdate:open":i[2]||(i[2]=R=>he.open=R),code:he.code,"onUpdate:code":i[3]||(i[3]=R=>he.code=R),onSave:he.updateCode},null,8,["open","code","onSave"])]),_:1},8,["onClick"]),c(it,{type:"primary",onClick:U,loading:F.value},{default:m(()=>[L($(y(o)("common.save")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),Bt(Ve("div",null,[c(Fe,{justify:"center"},{default:m(()=>[c(H,{lg:10,md:12,sm:18,xs:24},{default:m(()=>[c(Ie,null,{default:m(()=>[L($(y(o)("workspace.workflowEditor.tags")),1)]),_:1}),c(En,{modelValue:v.value.tags,"onUpdate:modelValue":i[4]||(i[4]=R=>v.value.tags=R)},null,8,["modelValue"]),c(Ie,null,{default:m(()=>[L($(y(o)("workspace.workflowEditor.brief_info")),1)]),_:1}),c(ea,{markdown:v.value.brief,"onUpdate:markdown":i[5]||(i[5]=R=>v.value.brief=R)},null,8,["markdown"]),c(Ie,null,{default:m(()=>[L($(y(o)("workspace.workflowEditor.brief_images")),1)]),_:1}),Ve("div",null,[c(Eo,{modelValue:v.value.images,"onUpdate:modelValue":i[6]||(i[6]=R=>v.value.images=R),multiple:!0},null,8,["modelValue"])])]),_:1})]),_:1})],512),[[io,l.value==y(o)("workspace.workflowEditor.workflow_info")]]),Bt(c(to,{"has-sider":"",style:{height:"100%"}},{default:m(()=>[c(Yo,{style:{overflow:"auto",backgroundColor:"#fff"},class:"custom-scrollbar"},{default:m(()=>[c(Xo,{theme:"light",mode:"inline"},{default:m(()=>[(T(!0),Z(xe,null,Be(Object.keys(Ee),(R,Lo)=>(T(),z(Ne,{key:`category-${Lo}`},{title:m(()=>[L($(y(o)(`components.nodes.${R}.title`)),1)]),default:m(()=>[(T(!0),Z(xe,null,Be(Ee[R],(ut,Ho)=>(T(),z(Tt,{"data-node-type":ut,id:ut,draggable:"true",onTouchstart:me,onTouchmove:ze,onDragend:Oe,onTouchend:Oe,key:`node-${Ho}`},{default:m(()=>[Ve("span",{"data-node-type":ut},$(y(o)(`components.nodes.${R}.${ut}.title`)),9,br)]),_:2},1032,["data-node-type","id"]))),128))]),_:2},1024))),128))]),_:1})]),_:1}),c(to,null,{default:m(()=>[c(Wo,{style:{margin:"24px 16px 0",overflow:"initial"}},{default:m(()=>[c(y(Dn),{modelValue:_.value,"onUpdate:modelValue":i[8]||(i[8]=R=>_.value=R),"node-types":qe,edgesUpdatable:!0,onEdgeUpdate:se,onEdgeDoubleClick:pe,"snap-to-grid":!0,"snap-grid":[20,20]},{default:m(()=>[c(y(xn)),c(y(Cn)),c(y(Tn),{variant:y(On).Dots},null,8,["variant"]),c(vr,{modelValue:y(E),"onUpdate:modelValue":i[7]||(i[7]=R=>Jn(E)?E.value=R:null),onSave:X},null,8,["modelValue"])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},512),[[io,l.value==y(o)("workspace.workflowEditor.workflow_canvas")]]),l.value==y(o)("workspace.workflowEditor.workflow_ui_design")?(T(),z(mr,{key:0,modelValue:v.value,"onUpdate:modelValue":i[9]||(i[9]=R=>v.value=R)},null,8,["modelValue"])):je("",!0)]))}}},Mr=Jt(wr,[["__scopeId","data-v-f926ebb7"]]);export{Mr as default};
