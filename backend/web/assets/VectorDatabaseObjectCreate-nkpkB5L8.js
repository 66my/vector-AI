import{_ as ee,W as te,s as j,r as N,a as ae,x as le,h as w,c as t,j as e,a7 as oe,ab as se,a1 as C,M as d,f as c,B as l,T as u,D as n,aN as re,aO as de,K as i,F as R,E as b,C as ne}from"./index-26IlJ65o.js";import{_ as ce}from"./UploaderFieldUse-fWpQKorS.js";import{_ as ue}from"./QuestionPopover-PQlmzDlV.js";import{d as _e,b as ie}from"./database-DdkAp0db.js";import{C as be}from"./Check-Cd7fhjuZ.js";import{C as me}from"./Close-CmNKIQuR.js";import{F as pe}from"./FileCabinet-DOoa5TN4.js";import"./Delete-BIY05YyZ.js";const fe={key:0,class:"loading-container"},ke={key:1,class:"dataspace-container"},ve=["href"],je={__name:"VectorDatabaseObjectCreate",setup(he){const{t:a}=te(),h=j(!0),q=oe(),A=se(),O=q.params.databaseId,g=j({}),o=N({add_method:"url",use_oversea_crawler:!1,source_url:"",files:[],title:"",content:""}),_=N({split_method:"general",chunk_length:1e3,delimiter:"\\n",remove_url_and_email:!1}),m=j(0),E=j([{title:a("workspace.databaseObjectCreate.add_object"),content:"First-content"},{title:a("workspace.databaseObjectCreate.process_rules"),content:"Second-content"},{title:a("workspace.databaseObjectCreate.finish"),content:"Last-content"}]),M=ae(()=>{if(m.value==0)return o.add_method=="url"?o.source_url=="":o.add_method=="files"?o.files.length==0:o.title==""||o.content=="";m.value==1}),P=async()=>{const k=await _e("get",{vid:O});k.status==200?g.value=k.data:C.error(k.msg)};le(async()=>{h.value=!0,await P(),h.value=!1});const y=j(!1),T=async()=>{if(o.add_method=="text"&&o.content.length==0){C.error(a("workspace.databaseObjectCreate.content_empty"));return}y.value=!0;const k=await ie("create",{vid:O,...o,process_rules:_});k.status===200?C.success(a("workspace.databaseObjectCreate.create_success")):C.error(a("workspace.databaseObjectCreate.create_failed")),y.value=!1,await A.push({name:"VectorDatabaseObjectDetail",params:{databaseId:O,objectId:k.data.oid}})};return(k,s)=>{const z=d("a-spin"),I=d("router-link"),x=d("a-breadcrumb-item"),H=d("a-breadcrumb"),D=d("a-col"),K=d("a-steps"),v=d("a-radio-button"),S=d("a-radio-group"),p=d("a-form-item"),$=d("a-checkbox"),U=d("a-input"),L=d("a-textarea"),B=d("a-form"),W=d("a-input-number"),f=d("a-descriptions-item"),G=d("a-list-item-meta"),J=d("a-list-item"),Q=d("a-list"),X=d("a-descriptions"),F=d("a-row"),V=d("a-button"),Y=d("a-space"),Z=d("a-card");return h.value?(c(),w("div",fe,[t(z)])):(c(),w("div",ke,[t(F,{justify:"center",gutter:[16,16]},{default:e(()=>[t(D,{xl:16,lg:18,md:20,sm:22,xs:24},{default:e(()=>[t(H,null,{default:e(()=>[t(x,null,{default:e(()=>[t(I,{to:"/data"},{default:e(()=>[t(l(pe)),u(" "+n(l(a)("components.layout.basicHeader.data_space")),1)]),_:1})]),_:1}),t(x,null,{default:e(()=>[t(I,{to:`/data/vector-db/${g.value.vid}`},{default:e(()=>[t(l(re)),u(" "+n(g.value.name),1)]),_:1},8,["to"])]),_:1}),t(x,null,{default:e(()=>[u(n(l(a)("workspace.databaseObjectCreate.add_object")),1)]),_:1})]),_:1})]),_:1}),t(D,{xl:16,lg:18,md:20,sm:22,xs:24},{default:e(()=>[t(Z,{loading:h.value},{title:e(()=>[t(l(de)),u(" "+n(l(a)("workspace.databaseObjectCreate.add_object")),1)]),default:e(()=>[t(K,{current:m.value,items:E.value,style:{"margin-bottom":"30px"}},null,8,["current","items"]),m.value==0?(c(),i(B,{key:0,"label-col":{span:6}},{default:e(()=>[t(p,{label:l(a)("workspace.databaseObjectCreate.add_method")},{default:e(()=>[t(S,{value:o.add_method,"onUpdate:value":s[0]||(s[0]=r=>o.add_method=r)},{default:e(()=>[t(v,{value:"url"},{default:e(()=>[u(n(l(a)("workspace.databaseObjectCreate.add_method_url")),1)]),_:1}),t(v,{value:"files"},{default:e(()=>[u(n(l(a)("workspace.databaseObjectCreate.add_method_files")),1)]),_:1}),t(v,{value:"text"},{default:e(()=>[u(n(l(a)("workspace.databaseObjectCreate.add_method_text")),1)]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),o.add_method=="url"?(c(),w(R,{key:0},[o.add_method=="url"?(c(),i(p,{key:0,label:l(a)("workspace.databaseObjectCreate.use_oversea_crawler")},{default:e(()=>[t($,{checked:o.use_oversea_crawler,"onUpdate:checked":s[1]||(s[1]=r=>o.use_oversea_crawler=r)},null,8,["checked"])]),_:1},8,["label"])):b("",!0),t(p,{label:l(a)("workspace.databaseObjectCreate.object_source_url")},{default:e(()=>[t(U,{value:o.source_url,"onUpdate:value":s[2]||(s[2]=r=>o.source_url=r)},null,8,["value"])]),_:1},8,["label"])],64)):b("",!0),o.add_method=="files"?(c(),i(ce,{key:1,modelValue:o.files,"onUpdate:modelValue":s[3]||(s[3]=r=>o.files=r),multiple:!0,style:{"margin-bottom":"30px"}},null,8,["modelValue"])):b("",!0),o.add_method=="text"?(c(),w(R,{key:2},[t(p,{label:l(a)("workspace.databaseObjectCreate.object_title")},{default:e(()=>[t(U,{value:o.title,"onUpdate:value":s[4]||(s[4]=r=>o.title=r)},null,8,["value"])]),_:1},8,["label"]),t(p,{label:l(a)("workspace.databaseObjectCreate.object_content")},{default:e(()=>[t(L,{value:o.content,"onUpdate:value":s[5]||(s[5]=r=>o.content=r),"auto-size":!0,"show-count":!0},null,8,["value"])]),_:1},8,["label"])],64)):b("",!0)]),_:1})):b("",!0),m.value==1?(c(),i(B,{key:1,"label-col":{span:6}},{default:e(()=>[t(p,{label:l(a)("workspace.databaseObjectCreate.split_method")},{default:e(()=>[t(S,{value:_.split_method,"onUpdate:value":s[6]||(s[6]=r=>_.split_method=r)},{default:e(()=>[t(v,{value:"general"},{default:e(()=>[u(n(l(a)("workspace.databaseObjectCreate.split_method_general")),1)]),_:1}),t(v,{value:"delimeter"},{default:e(()=>[u(n(l(a)("workspace.databaseObjectCreate.split_method_delimeter")),1)]),_:1}),t(v,{value:"markdown"},{default:e(()=>[u(n(l(a)("workspace.databaseObjectCreate.split_method_markdown")),1)]),_:1}),t(v,{value:"table"},{default:e(()=>[u(n(l(a)("workspace.databaseObjectCreate.split_method_table")),1)]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),["delimeter","table"].includes(_.split_method)?b("",!0):(c(),i(p,{key:0},{label:e(()=>[u(n(l(a)("workspace.databaseObjectCreate.chunk_length"))+" ",1),t(ue,{contents:[l(a)("workspace.databaseObjectCreate.question.chunk_length.1"),l(a)("workspace.databaseObjectCreate.question.chunk_length.2"),l(a)("workspace.databaseObjectCreate.question.chunk_length.3")]},null,8,["contents"])]),default:e(()=>[t(W,{value:_.chunk_length,"onUpdate:value":s[7]||(s[7]=r=>_.chunk_length=r)},null,8,["value"])]),_:1})),_.split_method=="delimeter"?(c(),i(p,{key:1,label:l(a)("workspace.databaseObjectCreate.delimiter")},{default:e(()=>[t(U,{value:_.delimiter,"onUpdate:value":s[8]||(s[8]=r=>_.delimiter=r),style:{width:"200px"}},null,8,["value"])]),_:1},8,["label"])):b("",!0),t(p,{label:l(a)("workspace.databaseObjectCreate.remove_url_and_email")},{default:e(()=>[t($,{checked:_.remove_url_and_email,"onUpdate:checked":s[9]||(s[9]=r=>_.remove_url_and_email=r)},null,8,["checked"])]),_:1},8,["label"])]),_:1})):b("",!0),t(F,{align:"center",gutter:[16,16]},{default:e(()=>[t(D,{xl:16,md:24},{default:e(()=>[m.value==2?(c(),i(X,{key:0,bordered:""},{default:e(()=>[t(f,{label:l(a)("workspace.databaseObjectCreate.add_method"),span:3},{default:e(()=>[u(n(l(a)(`workspace.databaseObjectCreate.add_method_${o.add_method}`)),1)]),_:1},8,["label"]),o.add_method=="url"?(c(),i(f,{key:0,label:l(a)("workspace.databaseObjectCreate.object_source_url"),span:3},{default:e(()=>[ne("a",{href:o.source_url,target:"_blank"},n(o.source_url),9,ve)]),_:1},8,["label"])):b("",!0),o.add_method=="files"?(c(),i(f,{key:1,label:l(a)("workspace.databaseObjectCreate.object_files"),span:3},{default:e(()=>[t(Q,{dataSource:o.files},{renderItem:e(({item:r})=>[t(J,null,{default:e(()=>[t(G,{title:r},null,8,["title"])]),_:2},1024)]),_:1},8,["dataSource"])]),_:1},8,["label"])):b("",!0),o.add_method=="text"?(c(),i(f,{key:2,label:l(a)("workspace.databaseObjectCreate.object_title"),span:1},{default:e(()=>[u(n(o.title),1)]),_:1},8,["label"])):b("",!0),o.add_method=="text"?(c(),i(f,{key:3,label:l(a)("workspace.databaseObjectCreate.object_content"),span:2},{default:e(()=>[u(n(o.content),1)]),_:1},8,["label"])):b("",!0),t(f,{label:l(a)("workspace.databaseObjectCreate.split_method")},{default:e(()=>[u(n(l(a)(`workspace.databaseObjectCreate.split_method_${_.split_method}`)),1)]),_:1},8,["label"]),_.split_method!="delimeter"?(c(),i(f,{key:4,label:l(a)("workspace.databaseObjectCreate.chunk_length")},{default:e(()=>[u(n(_.chunk_length),1)]),_:1},8,["label"])):b("",!0),_.split_method=="delimeter"?(c(),i(f,{key:5,label:l(a)("workspace.databaseObjectCreate.delimiter")},{default:e(()=>[u(n(_.delimiter),1)]),_:1},8,["label"])):b("",!0),t(f,{label:l(a)("workspace.databaseObjectCreate.remove_url_and_email")},{default:e(()=>[_.remove_url_and_email?(c(),i(l(be),{key:0})):(c(),i(l(me),{key:1}))]),_:1},8,["label"])]),_:1})):b("",!0)]),_:1})]),_:1}),t(Y,{style:{float:"right"}},{default:e(()=>[t(V,{disabled:m.value==0,onClick:s[10]||(s[10]=r=>m.value-=1)},{default:e(()=>[u(n(l(a)("common.previous_step")),1)]),_:1},8,["disabled"]),m.value<2?(c(),i(V,{key:0,type:"primary",disabled:M.value,onClick:s[11]||(s[11]=r=>m.value+=1)},{default:e(()=>[u(n(l(a)("common.next_step")),1)]),_:1},8,["disabled"])):b("",!0),m.value==2?(c(),i(V,{key:1,type:"primary",loading:y.value,onClick:T},{default:e(()=>[u(n(l(a)("workspace.databaseObjectCreate.finish")),1)]),_:1},8,["loading"])):b("",!0)]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1})]))}}},Ve=ee(je,[["__scopeId","data-v-58c1a07f"]]);export{Ve as default};
