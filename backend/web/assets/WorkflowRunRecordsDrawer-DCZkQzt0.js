import{I as y,c as t,W as q,l as L,s as G,m as O,aU as v,Z as W,N as h,b as l,f as d,g as w,T as c,A as k,y as n,F as f,B as C,G as Z,ah as p}from"./index-BK2R8M7z.js";import{T as x}from"./Time-M-IDJqHi.js";const Q=y("consume",!1,function(e){return t("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[t("path",{d:"M4 14C4 12.8954 4.89543 12 6 12H42C43.1046 12 44 12.8954 44 14V40C44 41.1046 43.1046 42 42 42H6C4.89543 42 4 41.1046 4 40V14Z",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M19 19L24 24L29 19",stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M18 25H30",stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M18 31H30",stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M24 25V35",stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M8 6H40",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])}),$=y("control",!0,function(e){return t("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[t("rect",{x:"9",y:"4",width:"30",height:"40",rx:"2",stroke:e.colors[0],"stroke-width":e.strokeWidth},null),t("circle",{cx:"24",cy:"31",r:"6",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth},null),t("path",{d:"M18 12H21",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M18 18H21",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M27 18H30",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])}),P=y("list-numbers",!0,function(e){return t("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[t("path",{d:"M20 9H42",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M20 19H42",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M20 29H42",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M20 39H42",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M6 29H12V32L6 38V39H12",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M7 11L9 9V19M9 19H7M9 19H11",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])}),J=y("tag",!1,function(e){return t("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[t("path",{d:"M8 44L8 6C8 4.89543 8.89543 4 10 4H38C39.1046 4 40 4.89543 40 6V44L24 35.7273L8 44Z",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M16 18H32",stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])}),K={key:2,class:"action-container"},te={__name:"WorkflowRunRecordsDrawer",props:{workflowId:{type:String,required:!1,default:""},buttonType:{type:String,required:!1,default:"primary"},showWorkflowTitle:{type:Boolean,required:!1,default:!1},openType:{type:String,required:!1,default:"detail"}},emits:["open-record"],setup(e,{emit:H}){const{t:o}=q(),R=L(!0),_=e,M=_.showWorkflowTitle?"80vw":"70vw",T={NOT_STARTED:"purple",QUEUED:"orange",RUNNING:"blue",FINISHED:"green",FAILED:"red"},m=L(!1),I=async()=>{m.value=!0,await s.load({}),R.value=!1},z=()=>{m.value=!1},j=H,N=[{text:o("components.workspace.workflowRunRecordsDrawer.status_not_started"),value:"NOT_STARTED"},{text:o("components.workspace.workflowRunRecordsDrawer.status_queued"),value:"QUEUED"},{text:o("components.workspace.workflowRunRecordsDrawer.status_running"),value:"RUNNING"},{text:o("components.workspace.workflowRunRecordsDrawer.status_finished"),value:"FINISHED"},{text:o("components.workspace.workflowRunRecordsDrawer.status_failed"),value:"FAILED"}],D=L([{title:o("components.workspace.workflowRunRecordsDrawer.start_time"),key:"start_time",dataIndex:"start_time",sorter:!0,sortDirections:["descend","ascend"],width:"156px"},{title:o("components.workspace.workflowRunRecordsDrawer.end_time"),key:"end_time",dataIndex:"end_time",sorter:!0,sortDirections:["descend","ascend"],width:"156px"},{title:o("components.workspace.workflowRunRecordsDrawer.status"),key:"status",dataIndex:"status",filters:N,width:"150px"},{title:o("common.action"),key:"action",width:"100px"}]);_.showWorkflowTitle&&D.value.splice(0,0,{title:o("components.workspace.workflowRunRecordsDrawer.workflow_title"),key:"workflow_title",dataIndex:"workflow_title"});const s=G({data:[],loading:!1,current:1,pageSize:10,total:0,pagination:O(()=>({total:s.total,current:s.current,pageSize:s.pageSize})),handleTableChange:(u,a,r)=>{s.load({page_size:u.pageSize,page:u.current,sort_field:r.field,sort_order:r.order,status:a.status})},load:async u=>{s.loading=!0;const a=await v("list",{wid:_.workflowId,...u});a.status==200?s.data=a.data.records.map(r=>(r.start_time=r.start_time?new Date(r.start_time).toLocaleString():"-",r.end_time=r.end_time?new Date(r.end_time).toLocaleString():"-",r)):W.error(a.msg),s.total=a.data.total,s.pageSize=a.data.page_size,s.current=a.data.page,s.loading=!1}}),S=async(u,a)=>{if(R.value=!0,_.openType=="detail"){const r=await v("get",{rid:u});r.status==200?(j("open-record",r.data),m.value=!1):W.error(r.msg)}else j("open-record",{rid:u,wid:a.wid}),m.value=!1;R.value=!1};return(u,a)=>{const r=h("a-button"),b=h("a-tag"),E=h("a-typography-link"),V=h("a-table"),B=h("a-col"),U=h("a-row"),A=h("a-spin"),F=h("a-drawer");return l(),d(f,null,[t(r,{type:_.buttonType,onClick:I},{default:w(()=>[c(k(n(o)("components.workspace.workflowRunRecordsDrawer.workflows_run_records")),1)]),_:1},8,["type"]),t(F,{title:n(o)("components.workspace.workflowRunRecordsDrawer.my_workflows_run_records"),width:n(M),open:m.value,onClose:z},{default:w(()=>[t(A,{spinning:R.value},{default:w(()=>[t(U,{justify:"space-between",align:"middle"},{default:w(()=>[t(B,{span:24},{default:w(()=>[t(V,{loading:s.loading,columns:D.value,customRow:s.customRow,"data-source":s.data,pagination:s.pagination,onChange:s.handleTableChange},{headerCell:w(({column:i})=>[i.key==="workflow_title"?(l(),d(f,{key:0},[t(n(P)),c(" "+k(n(o)("components.workspace.workflowRunRecordsDrawer.workflow_title")),1)],64)):i.key==="start_time"?(l(),d(f,{key:1},[t(n(x)),c(" "+k(n(o)("components.workspace.workflowRunRecordsDrawer.start_time")),1)],64)):i.key==="end_time"?(l(),d(f,{key:2},[t(n(x)),c(" "+k(n(o)("components.workspace.workflowRunRecordsDrawer.end_time")),1)],64)):i.key==="status"?(l(),d(f,{key:3},[t(n(J)),c(" "+k(n(o)("components.workspace.workflowRunRecordsDrawer.status")),1)],64)):i.key==="used_credits"?(l(),d(f,{key:4},[t(n(Q)),c(" "+k(n(o)("components.workspace.workflowRunRecordsDrawer.used_credits")),1)],64)):i.key==="action"?(l(),d(f,{key:5},[t(n($)),c(" "+k(n(o)("common.action")),1)],64)):C("",!0)]),bodyCell:w(({column:i,record:g})=>[i.key==="workflow_title"?(l(),d(f,{key:0},[c(k(g.workflow.title),1)],64)):i.key==="status"?(l(),Z(b,{key:1,color:T[g.status]},{default:w(()=>[c(k(n(o)(`components.workspace.workflowRunRecordsDrawer.status_${g.status.toLowerCase()}`)),1)]),_:2},1032,["color"])):i.key==="action"?(l(),d("div",K,[t(E,{onClick:p(X=>S(g.rid,g.workflow),["prevent"])},{default:w(()=>[c(k(n(o)("components.workspace.workflowRunRecordsDrawer.check_record")),1)]),_:2},1032,["onClick"])])):C("",!0)]),_:1},8,["loading","columns","customRow","data-source","pagination","onChange"])]),_:1})]),_:1})]),_:1},8,["spinning"])]),_:1},8,["title","width","open"])],64)}}};export{$ as C,te as _};
