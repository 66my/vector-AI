import{I as W,c as e,_ as ee,W as te,s as U,r as O,a as ae,$ as g,x as oe,h as y,j as a,a6 as ne,ab as se,M as i,f as c,B as o,T as m,D as p,aN as le,F as v,E as h,K as f}from"./index-DwTab_5X.js";import{b as V,d as T}from"./database-CjPJb4LT.js";import{f as ie}from"./util-CDdHKGWf.js";import{F as re}from"./FileCabinet-BuyP0NlZ.js";import{U as ce}from"./Upload-BVjAltdR.js";import{E as S}from"./Edit-C0BO63Nx.js";import{L as de}from"./LoadingFour-BmztCNPP.js";import{D as ue}from"./Delete-DkwO9RIL.js";const _e=W("audio-file",!0,function(t){return e("svg",{width:t.size,height:t.size,viewBox:"0 0 48 48",fill:"none"},[e("path",{d:"M8 44V4H31L40 14.5V44H8Z",fill:t.colors[1],stroke:t.colors[0],"stroke-width":t.strokeWidth,"stroke-linecap":t.strokeLinecap,"stroke-linejoin":t.strokeLinejoin},null),e("path",{d:"M32 14L26 16.9688V31.5",stroke:t.colors[2],"stroke-width":t.strokeWidth,"stroke-linecap":t.strokeLinecap,"stroke-linejoin":t.strokeLinejoin},null),e("circle",{cx:"20.5",cy:"31.5",r:"5.5",fill:t.colors[3],stroke:t.colors[2],"stroke-width":t.strokeWidth,"stroke-linecap":t.strokeLinecap,"stroke-linejoin":t.strokeLinejoin},null)])}),me=W("picture-one",!0,function(t){return e("svg",{width:t.size,height:t.size,viewBox:"0 0 48 48",fill:"none"},[e("path",{d:"M39 6H9C7.34315 6 6 7.34315 6 9V39C6 40.6569 7.34315 42 9 42H39C40.6569 42 42 40.6569 42 39V9C42 7.34315 40.6569 6 39 6Z",stroke:t.colors[0],"stroke-width":t.strokeWidth,"stroke-linecap":t.strokeLinecap,"stroke-linejoin":t.strokeLinejoin},null),e("path",{d:"M18 23C20.7614 23 23 20.7614 23 18C23 15.2386 20.7614 13 18 13C15.2386 13 13 15.2386 13 18C13 20.7614 15.2386 23 18 23Z",fill:t.colors[1],stroke:t.colors[0],"stroke-width":t.strokeWidth,"stroke-linecap":t.strokeLinecap,"stroke-linejoin":t.strokeLinejoin},null),e("path",{d:"M42 36L31 26L21 35L14 29L6 35",stroke:t.colors[0],"stroke-width":t.strokeWidth,"stroke-linecap":t.strokeLinecap,"stroke-linejoin":t.strokeLinejoin},null)])}),pe={class:"dataspace-container"},ke={key:1},fe={__name:"VectorDatabaseDetail",setup(t){const{t:n}=te(),j=U(!0),$=ne(),L=se(),w=$.params.databaseId,b=U({}),s=O({columns:[{name:n("workspace.databaseDetail.object_title"),dataIndex:"title",key:"title"},{title:n("workspace.databaseDetail.data_type"),key:"data_type",dataIndex:"data_type",width:"100px"},{title:n("workspace.databaseDetail.source_url"),key:"source_url",dataIndex:"source_url",width:"100px"},{title:n("common.create_time"),key:"create_time",dataIndex:"create_time",sorter:!0,sortDirections:["descend","ascend"],width:"150px"},{title:n("common.action"),key:"action",width:"80px"}],data:[],loading:!1,current:1,pageSize:10,total:0,pagination:ae(()=>({total:s.total,current:s.current,pageSize:s.pageSize})),handleTableChange:(r,l,k)=>{s.load({page_size:r.pageSize,page:r.current,sort_field:k.field,sort_order:k.order})},hoverRowOid:null,customRow:r=>({style:{cursor:"pointer"},onClick:async l=>{(l.target.classList.contains("ant-table-cell")||l.target.classList.contains("object-title"))&&await L.push(`/data/vector-db/${w}/object/${r.oid}`)},onMouseenter:l=>{s.hoverRowOid=r.vid},onMouseleave:l=>{s.hoverRowOid=null}}),load:async r=>{s.loading=!0;const l=await V("list",{vid:w,...r});l.status==200?s.data=l.data.objects.map(k=>(k.create_time=ie(k.create_time),k)):g.error(l.msg),s.total=l.data.total,s.pageSize=l.data.page_size,s.current=l.data.page,s.loading=!1}}),B=async()=>{await s.load({});const r=await T("get",{vid:w});r.status==200?(b.value=r.data,j.value=!1):g.error(r.msg)};oe(async()=>{await B()});const E=async()=>{await L.push(`/data/${w}/create`)},F=r=>{V("delete",{oid:r}).then(l=>{l.status===200?g.success(n("workspace.databaseDetail.delete_success")):g.error(n("workspace.databaseDetail.delete_failed")),s.load({})})},u=O({open:!1,form:{name:b.value.name},show:()=>{u.open=!0,u.form.name=b.value.name},ok:async()=>{const r=await T("update",{vid:w,...u.form});r.status==200?(g.success(n("common.save_success")),b.value.name=u.form.name,u.open=!1):g.error(r.msg)}});return(r,l)=>{const k=i("router-link"),I=i("a-breadcrumb-item"),A=i("a-breadcrumb"),z=i("a-col"),H=i("a-typography-title"),C=i("a-button"),R=i("a-tooltip"),P=i("a-input"),N=i("a-form-item"),Z=i("a-form"),q=i("a-modal"),G=i("a-flex"),x=i("a-typography-text"),D=i("a-tag"),K=i("a-typography-link"),X=i("a-popconfirm"),J=i("a-table"),Q=i("a-card"),Y=i("a-row");return c(),y("div",pe,[e(Y,{align:"center",gutter:[16,16]},{default:a(()=>[e(z,{xl:16,lg:18,md:20,sm:22,xs:24},{default:a(()=>[e(A,null,{default:a(()=>[e(I,null,{default:a(()=>[e(k,{to:"/data"},{default:a(()=>[e(o(re)),m(" "+p(o(n)("components.layout.basicHeader.data_space")),1)]),_:1})]),_:1}),e(I,null,{default:a(()=>[e(o(le)),m(" "+p(b.value.name),1)]),_:1})]),_:1})]),_:1}),e(z,{xl:16,lg:18,md:20,sm:22,xs:24},{default:a(()=>[e(Q,{loading:j.value},{title:a(()=>[e(H,{level:2,class:"black-text",style:{"margin-bottom":"0"},content:b.value.name},null,8,["content"])]),extra:a(()=>[e(G,{gap:"middle"},{default:a(()=>[e(R,{title:o(n)("workspace.databaseDetail.modify_database_info")},{default:a(()=>[e(C,{type:"text",size:"large",class:"title-edit-button",onClick:u.show},{icon:a(()=>[e(o(S))]),_:1},8,["onClick"])]),_:1},8,["title"]),e(q,{title:o(n)("workspace.databaseDetail.modify_database_info"),onOk:u.ok,"confirm-loading":u.createLoading,open:u.open,"onUpdate:open":l[1]||(l[1]=_=>u.open=_)},{default:a(()=>[e(Z,{model:b.value,layout:"vertical"},{default:a(()=>[e(N,{label:o(n)("workspace.dataSpace.database_name"),name:"name",rules:[{required:!0}]},{default:a(()=>[e(P,{value:u.form.name,"onUpdate:value":l[0]||(l[0]=_=>u.form.name=_)},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["title","onOk","confirm-loading","open"]),e(R,{title:o(n)("workspace.databaseDetail.add_object")},{default:a(()=>[e(C,{type:"text",size:"large",onClick:E},{icon:a(()=>[e(o(ce))]),_:1})]),_:1},8,["title"])]),_:1})]),default:a(()=>[e(J,{loading:s.loading,customRow:s.customRow,columns:s.columns,"data-source":s.data,pagination:s.pagination,onChange:s.handleTableChange},{headerCell:a(({column:_})=>[_.key==="title"?(c(),y(v,{key:0},[m(p(o(n)("workspace.databaseDetail.object_title")),1)],64)):h("",!0)]),bodyCell:a(({column:_,record:d})=>{var M;return[_.key==="title"?(c(),y(v,{key:0},[d.status=="PR"?(c(),f(x,{key:0,disabled:""},{default:a(()=>[m(p(d.title)+" ",1),e(o(de),{spin:!0})]),_:2},1024)):(c(),f(x,{key:1,class:"object-title"},{default:a(()=>[m(p(d.title),1)]),_:2},1024))],64)):_.key==="data_type"?(c(),y("span",ke,[d.data_type.toUpperCase()=="TEXT"?(c(),f(D,{key:0,color:"blue",bordered:!1},{default:a(()=>[e(o(S)),m(" "+p(o(n)(`workspace.databaseDetail.data_type_${d.data_type.toUpperCase()}`)),1)]),_:2},1024)):h("",!0),d.data_type.toUpperCase()=="IMAGE"?(c(),f(D,{key:1,color:"green",bordered:!1},{default:a(()=>[e(o(me)),m(" "+p(o(n)(`workspace.databaseDetail.data_type_${d.data_type.toUpperCase()}`)),1)]),_:2},1024)):h("",!0),d.data_type.toUpperCase()=="AUDIO"?(c(),f(D,{key:2,color:"purple",bordered:!1},{default:a(()=>[e(o(_e)),m(" "+p(o(n)(`workspace.databaseDetail.data_type_${d.data_type.toUpperCase()}`)),1)]),_:2},1024)):h("",!0)])):_.key==="source_url"?(c(),y(v,{key:2},[((M=d.source_url)==null?void 0:M.length)>0?(c(),f(K,{key:0,href:d.source_url,target:"_blank"},{default:a(()=>[m(p(o(n)("workspace.databaseDetail.source_url")),1)]),_:2},1032,["href"])):(c(),f(x,{key:1,disabled:""},{default:a(()=>[m(p(o(n)("workspace.databaseDetail.source_url")),1)]),_:1}))],64)):_.key==="action"?(c(),y(v,{key:3},[d.status!="PR"?(c(),f(X,{key:0,placement:"leftTop",title:o(n)("workspace.databaseDetail.delete_confirm"),onConfirm:be=>F(d.oid)},{default:a(()=>[e(C,{type:"text",danger:""},{icon:a(()=>[e(o(ue))]),_:1})]),_:2},1032,["title","onConfirm"])):h("",!0)],64)):h("",!0)]}),_:1},8,["loading","customRow","columns","data-source","pagination","onChange"])]),_:1},8,["loading"])]),_:1})]),_:1})])}}},je=ee(fe,[["__scopeId","data-v-ee06909a"]]);export{je as default};
