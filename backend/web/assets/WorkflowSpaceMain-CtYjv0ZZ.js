import{I as Z,c as t,_ as G,a4 as ye,a5 as ve,W as F,M as c,f as u,K as m,j as o,B as s,E as M,a as P,ad as le,C as B,h as T,F as z,G as N,T as S,D as v,ae as ne,H as xe,s as D,ab as X,Y as re,Z as Y,x as ie,r as ce,v as Q,a1 as W,w as Se,n as Ce,a6 as We,$ as Te,a0 as be,af as se,a7 as ze}from"./index-BVaY_PMd.js";import{g as je,f as E,a as Me}from"./util-Dhsj7fS-.js";import{u as Le,w as Ve,a as V}from"./userWorkflows-dXACoOKq.js";import{_ as Re,C as qe}from"./WorkflowRunRecordsDrawer-Bb4UKzcG.js";import{C as Ie,a as de,T as Be}from"./TagOne-PIGalbfk.js";import{A as $e,B as Ue}from"./AuthorComponent-CSlCNCCA.js";import{S as J}from"./Star-CbFhe3Fj.js";import{D as ue}from"./Delete-ButkBd9H.js";import{M as He}from"./More-BYyuxc-b.js";import{P as Ae}from"./Plus-CB3V3YkT.js";import{T as Pe}from"./Time-BXQ5NMLt.js";const De=Z("list-one",!0,function(e){return t("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[t("path",{d:"M18 6H34V12H18V6Z",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M18 21H38V27H18V21Z",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M18 36H44V42H18V36Z",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),t("circle",{cx:"8",cy:"9",r:"2",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth},null),t("circle",{cx:"8",cy:"24",r:"2",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth},null),t("circle",{cx:"8",cy:"39",r:"2",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth},null)])}),Ze=Z("more-app",!0,function(e){return t("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[t("path",{d:"M18 4H6C4.89543 4 4 4.89543 4 6V18C4 19.1046 4.89543 20 6 20H18C19.1046 20 20 19.1046 20 18V6C20 4.89543 19.1046 4 18 4Z",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M18 28H6C4.89543 28 4 28.8954 4 30V42C4 43.1046 4.89543 44 6 44H18C19.1046 44 20 43.1046 20 42V30C20 28.8954 19.1046 28 18 28Z",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M42 4H30C28.8954 4 28 4.89543 28 6V18C28 19.1046 28.8954 20 30 20H42C43.1046 20 44 19.1046 44 18V6C44 4.89543 43.1046 4 42 4Z",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M28 28H44",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M36 36H44",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M28 44H44",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])}),Fe=Z("search",!0,function(e){return t("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[t("path",{d:"M21 38C30.3888 38 38 30.3888 38 21C38 11.6112 30.3888 4 21 4C11.6112 4 4 11.6112 4 21C4 30.3888 11.6112 38 21 38Z",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M26.657 14.3431C25.2093 12.8954 23.2093 12 21.0001 12C18.791 12 16.791 12.8954 15.3433 14.3431",stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M33.2216 33.2217L41.7069 41.707",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])}),Oe=Z("user",!1,function(e){return t("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[t("circle",{cx:"24",cy:"12",r:"8",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M42 44C42 34.0589 33.9411 26 24 26C14.0589 26 6 34.0589 6 44",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])}),Ke=Z("view-grid-card",!1,function(e){return t("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[t("rect",{x:"6",y:"6",width:"36",height:"36",rx:"3",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linejoin":e.strokeLinejoin},null),t("rect",{x:"13",y:"13",width:"8",height:"8",fill:e.colors[3],stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linejoin":e.strokeLinejoin},null),t("rect",{x:"27",y:"13",width:"8",height:"8",fill:e.colors[3],stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linejoin":e.strokeLinejoin},null),t("rect",{x:"13",y:"27",width:"8",height:"8",fill:e.colors[3],stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linejoin":e.strokeLinejoin},null),t("rect",{x:"27",y:"27",width:"8",height:"8",fill:e.colors[3],stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linejoin":e.strokeLinejoin},null)])}),Ne={__name:"InputSearch",props:{modelValue:{},modelModifiers:{}},emits:ye(["search","clear-search"],["update:modelValue"]),setup(e,{emit:r}){const _=ve(e,"modelValue"),{t:p}=F(),x=r,b=()=>{x("search")},l=()=>{_.value="",x("clear-search")};return(y,w)=>{const k=c("a-input");return u(),m(k,{value:_.value,"onUpdate:value":w[0]||(w[0]=h=>_.value=h),placeholder:s(p)("components.inputSearch.input_search_text"),onPressEnter:b,class:"search-input"},{prefix:o(()=>[t(s(Fe))]),suffix:o(()=>[_.value.length>0?(u(),m(s(Ie),{key:0,class:"clear-search-button",theme:"filled",onClick:l,style:{cursor:"pointer"}})):M("",!0)]),_:1},8,["value","placeholder"])}}},fe=G(Ne,[["__scopeId","data-v-28414df6"]]),Ee={class:"gradient-layer"},Ge={key:1,class:"meta-text"},Qe={__name:"WorkflowCard",props:{id:{type:String,required:!1,default:""},title:{type:String,required:!0},tags:{type:Array,required:!0,default:()=>[]},images:{type:Array,required:!1,default:()=>[]},brief:{type:String,required:!1,default:""},author:{type:[Object,Boolean],required:!1,default:!1},datetime:{type:[String,Boolean],required:!1,default:!1},forks:{type:[Number,Boolean],required:!1,default:0},extra:{type:[Object,Boolean],required:!1,default:!1},starred:{type:[Boolean,void 0],required:!1,default:void 0},loading:{type:Boolean,required:!1,default:!1}},emits:["star","clone","delete"],setup(e,{emit:r}){const _=e,p=r,{t:x}=F(),b=P(()=>_.images.length===0?{backgroundColor:le[je(0,le.length-1)]}:{backgroundImage:`url(${_.images[0]})`});return(l,y)=>{const w=c("a-tag"),k=c("a-tooltip"),h=c("a-button"),a=c("a-menu-item"),R=c("a-typography-text"),q=c("a-popconfirm"),I=c("a-menu"),$=c("a-dropdown"),g=c("a-flex"),U=c("a-typography-title"),O=c("a-card");return u(),m(O,{id:e.id,loading:e.loading,class:"workflow-card",hoverable:"",style:xe(b.value)},{default:o(()=>[B("div",Ee,[t(g,{vertical:"",class:"info-container"},{default:o(()=>[t(g,{justify:"space-between",style:{"flex-grow":"1"}},{default:o(()=>[B("div",null,[(u(!0),T(z,null,N(e.tags,(n,i)=>(u(),m(w,{key:i,color:n.color,style:{"margin-bottom":"10px"}},{default:o(()=>[S(v(n.title),1)]),_:2},1032,["color"]))),128))]),B("div",null,[t(g,{align:"center"},{default:o(()=>[typeof e.starred<"u"?(u(),m(h,{key:0,size:"small",type:"text",onClick:y[0]||(y[0]=ne(n=>p("star"),["prevent"]))},{icon:o(()=>[t(k,{title:e.starred?s(x)("workspace.workflowSpace.delete_from_fast_access"):s(x)("workspace.workflowSpace.add_to_fast_access")},{default:o(()=>[t(s(J),{theme:e.starred?"filled":"outline",fill:"#fff"},null,8,["theme"])]),_:1},8,["title"])]),_:1})):M("",!0),e.extra?(u(),m($,{key:1},{overlay:o(()=>[t(I,null,{default:o(()=>[t(a,{key:"clone",onClick:y[1]||(y[1]=n=>p("clone",e.id))},{default:o(()=>[t(s(de)),S(" "+v(s(x)("workspace.workflowSpace.clone_workflow")),1)]),_:1}),t(q,{title:s(x)("workspace.workflowSpace.delete_confirm"),onConfirm:y[2]||(y[2]=n=>p("delete",e.id))},{default:o(()=>[t(a,{key:"delete"},{default:o(()=>[t(R,{type:"danger"},{default:o(()=>[t(s(ue)),S(" "+v(s(x)("common.delete")),1)]),_:1})]),_:1})]),_:1},8,["title"])]),_:1})]),default:o(()=>[t(h,{size:"large",type:"text"},{default:o(()=>[t(s(He),{theme:"filled",size:"24",fill:"#fff"})]),_:1})]),_:1})):M("",!0)]),_:1})])]),_:1}),t(U,{level:4,class:"workflow-title"},{default:o(()=>[S(v(e.title),1)]),_:1}),t(g,{align:"center",justify:"space-between",class:"meta-info-container"},{default:o(()=>[e.author?(u(),m($e,{key:0,author:e.author,fontColor:"#fff"},null,8,["author"])):M("",!0),e.datetime?(u(),T("span",Ge,v(e.datetime),1)):M("",!0),typeof e.forks=="number"?(u(),m(g,{key:2,align:"center",class:"meta-text"},{default:o(()=>[t(s(Ue)),B("span",null,v(e.forks>=10?e.forks:"<10"),1)]),_:1})):M("",!0)]),_:1})]),_:1})])]),_:1},8,["id","loading","style"])}}},ke=G(Qe,[["__scopeId","data-v-5ec9d829"]]),Ye={key:2,class:"action-container"},Je={__name:"MyWorkflows",setup(e){const{t:r}=F(),_=D(!0),p=X(),x=re(),{language:b,workflowDisplayPreference:l}=Y(x),y=Le(),{userWorkflows:w,userWorkflowsTotal:k}=Y(y),h=D([]);ie(async()=>{const n=p.currentRoute.value.query.search_text;let i={};n&&(i={search_text:n},a.searchText=n);const[d,j]=await Promise.all([a.load({page_size:a.pageSize,...i}),Ve("list",{})]);j.status==200&&(h.value=j.data),_.value=!1});const a=ce({columns:[{name:r("workspace.workflowSpaceMain.workflow_title"),dataIndex:"title",key:"title"},{title:r("workspace.workflowSpaceMain.tags"),key:"tags",dataIndex:"tags",filters:P(()=>h.value.map(n=>({text:n.title,value:n.tid}))),width:"300px"},{title:r("workspace.workflowSpaceMain.update_time"),key:"update_time",dataIndex:"update_time",sorter:!0,sortDirections:["descend","ascend"],width:"160px"},{title:r("common.action"),key:"action",width:"160px"}],data:w.value,loading:!1,current:1,pageSize:l.value=="card"?16:10,total:k.value,pagination:P(()=>({total:a.total,current:a.current,pageSize:a.pageSize})),selectTag:"all",selectTagChange:async()=>{a.loading=!0,await a.load({tags:[a.selectTag]}),a.loading=!1},searching:!1,searchText:"",hoverRowWid:null,customRow:n=>({style:{cursor:"pointer"},onClick:async i=>{(i.target.classList.contains("ant-table-cell")||i.target.classList.contains("workflow-title"))&&await Q(async()=>{await p.push({name:"WorkflowUse",params:{workflowId:n.wid}})})},onMouseenter:i=>{a.hoverRowWid=n.wid},onMouseleave:i=>{a.hoverRowWid=null}}),searchWorkflows:async()=>{a.loading=!0,a.searching=!0,await a.load({page_size:a.pageSize,search_text:a.searchText}),a.searching=!1,a.loading=!1,await p.push({query:{...p.currentRoute.value.query,search_text:a.searchText}})},clearSearch:async()=>{a.loading=!0,a.searching=!0,a.searchText="",await a.load({page_size:a.pageSize}),a.searching=!1,a.loading=!1,await p.push({query:{...p.currentRoute.value.query,search_text:void 0}})},handleTableChange:(n,i,d)=>{a.load({page_size:n.pageSize,page:n.current,sort_field:d.field,sort_order:d.order,tags:i.tags,search_text:a.searchText})},handleCardViewChange:n=>{a.load({page_size:a.pageSize,page:n,search_text:a.searchText})},load:async n=>{a.loading=!0;const i=await V("list",n);i.status==200?a.data=i.data.workflows.map(d=>(d.create_time=E(d.create_time),d.update_time=E(d.update_time),d.key=d.wid,d)):W.error(i.msg),a.total=i.data.total,a.pageSize=i.data.page_size,a.current=i.data.page,a.loading=!1}});Se(()=>l.value,n=>{l.value=="card"?(a.load({page_size:16}),a.pageSize=16):a.load({page_size:10}),x.setWorkflowDisplayPreference(l.value)});const R=async n=>{(await V("delete",{wid:n})).status==200?(W.success(r("workspace.workflowSpace.delete_success")),y.deleteUserWorkflow(n),a.load({})):W.error(r("workspace.workflowSpace.delete_failed"))},q=async n=>{(await V("add_to_fast_access",{wid:n})).status==200?(W.success(r("workspace.workflowSpace.add_to_fast_access_success")),await y.refreshWorkflows(),a.data=a.data.map(d=>(d.wid==n&&(d.is_fast_access=!0),d))):W.error(r("workspace.workflowSpace.add_to_fast_access_failed"))},I=async n=>{(await V("delete_from_fast_access",{wid:n})).status==200?(W.success(r("workspace.workflowSpace.delete_from_fast_access_success")),await y.refreshWorkflows(),a.data=a.data.map(d=>(d.wid==n&&(d.is_fast_access=!1),d))):W.error(r("workspace.workflowSpace.delete_from_fast_access_failed"))},$=async n=>{n.is_fast_access?await I(n.wid):await q(n.wid)},g=async n=>{_.value=!0;const i=await V("create",{title:r("workspace.workflowSpace.new_workflow"),language:b.value});if(i.status!=200){W.error(i.msg);return}const d=i.data;await y.refreshWorkflows(),Q(async()=>{await p.push({name:"WorkflowEditor",params:{workflowId:d.wid}})})},U=async n=>{_.value=!0;const i=a.data.find(A=>A.wid==n);i.loading=!0;const d=await V("get",{wid:n});if(d.status!=200){W.error(r("workspace.workflowSpace.clone_failed"));return}const j=await V("create",{...d.data,title:d.data.title+" "+r("workspace.workflowSpace.clone_workflow")});if(i.loading=!1,j.status!=200){W.error(j.data.msg);return}const H=j.data;await y.refreshWorkflows(),Q(async()=>{await p.push({name:"WorkflowUse",params:{workflowId:H.wid}})})},O=async n=>{await p.push({name:"WorkflowUse",params:{workflowId:n.wid},query:{rid:n.rid}})};return(n,i)=>{const d=c("a-tooltip"),j=c("a-segmented"),H=c("a-button"),A=c("a-space"),K=c("a-flex"),ee=c("router-link"),te=c("a-col"),we=c("a-pagination"),_e=c("a-row"),he=c("a-typography-text"),ae=c("a-typography-link"),ge=c("a-tag"),me=c("a-popconfirm"),oe=c("a-typography-paragraph"),pe=c("a-table");return u(),m(K,{vertical:"",gap:"middle"},{default:o(()=>[t(K,{wrap:"wrap",align:"middle",justify:"space-between",gap:"small"},{default:o(()=>[t(fe,{modelValue:a.searchText,"onUpdate:modelValue":i[0]||(i[0]=f=>a.searchText=f),onSearch:a.searchWorkflows,onClearSearch:a.clearSearch},null,8,["modelValue","onSearch","onClearSearch"]),t(K,{justify:"flex-end"},{default:o(()=>[t(A,null,{default:o(()=>[t(j,{size:"middle",value:s(l),"onUpdate:value":i[1]||(i[1]=f=>Ce(l)?l.value=f:null),options:[{value:"card"},{value:"list"}]},{label:o(({value:f})=>[f=="card"?(u(),m(d,{key:0,title:s(r)("common.card_view")},{default:o(()=>[t(s(Ke))]),_:1},8,["title"])):(u(),m(d,{key:1,title:s(r)("common.table_view")},{default:o(()=>[t(s(De))]),_:1},8,["title"]))]),_:1},8,["value"]),t(H,{type:"primary",onClick:g},{default:o(()=>[t(s(Ae)),S(" "+v(s(r)("workspace.workflowSpaceMain.create_workflow")),1)]),_:1}),t(Re,{buttonType:"default",openType:"simple",showWorkflowTitle:!0,onOpenRecord:O})]),_:1})]),_:1})]),_:1}),s(l)=="card"?(u(),m(_e,{key:0,gutter:[16,16],style:{"margin-bottom":"80px"}},{default:o(()=>[(u(!0),T(z,null,N(a.data,f=>(u(),m(te,{xxl:6,xl:8,lg:8,md:12,sm:24,xs:24,key:f.pid},{default:o(()=>[t(ee,{to:{name:"WorkflowUse",params:{workflowId:f.wid}}},{default:o(()=>[t(ke,{title:f.title,tags:f.tags,images:f.images,brief:f.brief,author:!1,datetime:f.update_time,forks:!1,extra:!0,loading:f.loading,starred:f.is_fast_access,onStar:C=>$(f),onClone:C=>U(f.wid),onDelete:C=>R(f.wid)},null,8,["title","tags","images","brief","datetime","loading","starred","onStar","onClone","onDelete"])]),_:2},1032,["to"])]),_:2},1024))),128)),t(te,{span:24},{default:o(()=>[t(K,{justify:"flex-end"},{default:o(()=>[t(we,{current:a.current,"onUpdate:current":i[2]||(i[2]=f=>a.current=f),pageSize:a.pageSize,"onUpdate:pageSize":i[3]||(i[3]=f=>a.pageSize=f),total:a.total,"show-less-items":"",onChange:a.handleCardViewChange},null,8,["current","pageSize","total","onChange"])]),_:1})]),_:1})]),_:1})):(u(),m(pe,{key:1,loading:_.value||a.loading,columns:a.columns,customRow:a.customRow,"data-source":a.data,pagination:a.pagination,onChange:a.handleTableChange},{headerCell:o(({column:f})=>[f.key==="title"?(u(),T(z,{key:0},[t(s(We)),S(" "+v(s(r)("workspace.workflowSpaceMain.workflow_title")),1)],64)):f.key==="tags"?(u(),T(z,{key:1},[t(s(Be)),S(" "+v(s(r)("workspace.workflowSpaceMain.tags")),1)],64)):f.key==="update_time"?(u(),T(z,{key:2},[t(s(Pe)),S(" "+v(s(r)("workspace.workflowSpaceMain.update_time")),1)],64)):f.key==="action"?(u(),T(z,{key:3},[t(s(qe)),S(" "+v(s(r)("common.action")),1)],64)):M("",!0)]),bodyCell:o(({column:f,record:C,index:at})=>[f.key==="title"?(u(),m(A,{key:0},{default:o(()=>[t(he,{class:"workflow-title"},{default:o(()=>[S(v(C.title),1)]),_:2},1024),C.is_fast_access?(u(),m(d,{key:1,title:s(r)("workspace.workflowSpace.delete_from_fast_access")},{default:o(()=>[t(ae,{onClick:L=>I(C.wid)},{default:o(()=>[t(s(J),{theme:"filled"})]),_:2},1032,["onClick"])]),_:2},1032,["title"])):(u(),m(d,{key:0,title:s(r)("workspace.workflowSpace.add_to_fast_access")},{default:o(()=>[t(ae,{onClick:L=>q(C.wid)},{default:o(()=>[Te(t(s(J),null,null,512),[[be,a.hoverRowWid==C.wid]])]),_:2},1032,["onClick"])]),_:2},1032,["title"]))]),_:2},1024)):f.key==="tags"?(u(),m(A,{key:1},{default:o(()=>[(u(!0),T(z,null,N(C.tags,L=>(u(),m(ge,{color:L.color,key:L.tid},{default:o(()=>[S(v(L.title),1)]),_:2},1032,["color"]))),128))]),_:2},1024)):f.key==="action"?(u(),T("div",Ye,[t(d,{title:s(r)("workspace.workflowSpace.clone_workflow")},{default:o(()=>[t(H,{type:"text",onClick:ne(L=>U(C.wid),["prevent"])},{icon:o(()=>[t(s(de))]),_:2},1032,["onClick"])]),_:2},1032,["title"]),t(d,{title:s(r)("workspace.workflowSpace.delete")},{default:o(()=>[t(me,{title:s(r)("workspace.workflowSpace.delete_confirm"),onConfirm:L=>R(C.wid)},{default:o(()=>[t(H,{type:"text",danger:""},{icon:o(()=>[t(s(ue))]),_:1})]),_:2},1032,["title","onConfirm"])]),_:2},1032,["title"])])):M("",!0)]),emptyText:o(()=>[t(oe,{type:"secondary"},{default:o(()=>[S(v(s(r)("components.workspace.myWorkflows.no_workflows_1")),1)]),_:1}),t(oe,{type:"secondary"},{default:o(()=>[S(v(s(r)("components.workspace.myWorkflows.no_workflows_2"))+" ",1),t(ee,{to:"/workflow/?tab=official-workflow-templates"},{default:o(()=>[S(v(s(r)("workspace.workflowSpaceMain.official_workflow_template")),1)]),_:1})]),_:1})]),_:1},8,["loading","columns","customRow","data-source","pagination","onChange"]))]),_:1})}}},Xe={__name:"WorkflowTemplatesMarket",setup(e){const{t:r}=F();D(!0);const _=X(),p=re();Y(p);const x=D([]),b=P(()=>{let w=[{label:r("common.all_tags"),value:"all"}];return w=w.concat(x.value.map(k=>({label:k.title,value:k.tid}))),w});ie(async()=>{const w=_.currentRoute.value.query.search_text;let k={};w&&(k={search_text:w},l.searchText=w);const[h,a]=await Promise.all([l.load({is_official:!0,...k}),se("list_tags",{})]);a.status==200&&(x.value=a.data)});const l=ce({data:[],loading:!0,current:1,pageSize:10,total:0,pagination:P(()=>({total:l.total,current:l.current,pageSize:l.pageSize})),selectTag:"all",selectTagChange:async()=>{l.loading=!0,await l.load({tags:[l.selectTag],is_official:!0}),l.loading=!1},hoverRowWid:null,handleTableChange:(w,k,h)=>{l.load({page_size:w.pageSize,page:w.current,sort_field:h.field,sort_order:h.order,tags:k.tags})},searching:!1,searchText:"",searchWorkflows:async()=>{l.searching=!0,await l.load({page_size:l.pageSize,search_text:l.searchText}),l.searching=!1,await _.push({query:{..._.currentRoute.value.query,search_text:l.searchText}})},clearSearch:async()=>{l.searching=!0,l.searchText="",await l.load({page_size:l.pageSize}),l.searching=!1,await _.push({query:{..._.currentRoute.value.query,search_text:void 0}})},load:async w=>{l.loading=!0;const k=await se("list_templates",{client:"PC",...w});k.status==200?l.data=k.data.templates.map(h=>(h.create_time=E(h.create_time),h.update_time=E(h.update_time),h)):W.error(k.msg),l.total=k.data.total,l.pageSize=k.data.page_size,l.current=k.data.page,l.loading=!1}}),y=async w=>{await _.push({name:"WorkflowTemplate",params:{workflowTemplateId:w}})};return(w,k)=>{const h=c("a-select"),a=c("a-flex"),R=c("a-col"),q=c("a-row"),I=c("a-spin"),$=c("a-divider");return u(),T(z,null,[t(a,{vertical:"",gap:"middle"},{default:o(()=>[t(a,{justify:"space-between"},{default:o(()=>[t(fe,{modelValue:l.searchText,"onUpdate:modelValue":k[0]||(k[0]=g=>l.searchText=g),onSearch:l.searchWorkflows,onClearSearch:l.clearSearch},null,8,["modelValue","onSearch","onClearSearch"]),t(h,{value:l.selectTag,"onUpdate:value":k[1]||(k[1]=g=>l.selectTag=g),style:{width:"200px"},options:b.value,onChange:l.selectTagChange},null,8,["value","options","onChange"])]),_:1}),t(I,{spinning:l.loading},{default:o(()=>[t(q,{gutter:[16,16]},{default:o(()=>[(u(!0),T(z,null,N(l.data,(g,U)=>(u(),m(R,{xl:6,lg:8,md:8,sm:12,xs:24,key:g.tid,onClick:O=>y(g.tid)},{default:o(()=>[t(ke,{id:g.tid,title:g.title,tags:g.tags,images:g.images,brief:g.brief,author:g.user,forks:g.used_count},null,8,["id","title","tags","images","brief","author","forks"])]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1},8,["spinning"])]),_:1}),t($)],64)}}},et=G(Xe,[["__scopeId","data-v-cd627f7b"]]),tt={__name:"WorkflowSpaceMain",setup(e){const{t:r}=F(),_=ze(),p=X(),x=D(_.query.tab?_.query.tab:"my-workflows"),b=async l=>{await p.push(Me(_.path,{tab:l}))};return(l,y)=>{const w=c("a-tab-pane"),k=c("a-tabs");return u(),m(k,{activeKey:x.value,"onUpdate:activeKey":y[0]||(y[0]=h=>x.value=h),onChange:b},{default:o(()=>[t(w,{key:"my-workflows"},{tab:o(()=>[B("span",null,[t(s(Oe)),S(" "+v(s(r)("workspace.workflowSpaceMain.my_workflows")),1)])]),default:o(()=>[t(Je)]),_:1}),t(w,{key:"official-workflow-templates"},{tab:o(()=>[B("span",null,[t(s(Ze),{theme:"filled"}),S(" "+v(s(r)("workspace.workflowSpaceMain.official_workflow_template")),1)])]),default:o(()=>[t(et)]),_:1})]),_:1},8,["activeKey"])}}},wt=G(tt,[["__scopeId","data-v-a0d4668b"]]);export{wt as default};
