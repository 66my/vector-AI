import{v as $o,_ as Xo,a as Yo,b as Wo,c as Lo,d as Ho,e as zo,f as Go,g as qo,h as Jo,i as Zo,j as Qo,k as Ko,l as en,m as tn,n as on,o as nn,p as an,q as rn,r as ln,s as sn,t as un,u as cn,w as dn,x as pn,y as fn,z as hn,A as mn,B as vn,C as gn,D as _n,Y as bn,E as yn,F as wn,G as kn,H as Dn,I as En}from"./style-e95e98b2.js";import{c as p,A as Sn,g as Wt,u as D,w as xn,d as Cn,a as Tn,b as Jt,t as On,r as ie,e as ze,h as mo,o as In,f as Nn,i as An,j as vo,k as Pn,n as Zt,l as x,m as Mn,p as C,q as L,s as _,v as Z,x as We,F as Re,y as re,z as Q,B as Fe,C as Un,D as Xe,E as Qt,G as Rt,V as Vn,H as Rn,I as Fn,J as jn,K as Bn,L as $n,M as Kt,N as St,O as it,P as Xn,Q as eo,R as Yn,S as Wn,T as Ln}from"./index-c6a122c5.js";import{u as Hn}from"./userDatabase-f85eee75.js";import{_ as zn}from"./MarkdownEditor-8d67db71.js";import{_ as go}from"./UploaderFieldUse-26603386.js";import{F as Gn,T as qn,_ as Jn,a as Zn,b as Qn,c as Kn,d as ea}from"./EchartsRenderer-27509432.js";import{_ as ta}from"./TemperatureInput-fbe381b0.js";import{_ as _o}from"./_plugin-vue_export-helper-c27b6911.js";import{d as oa}from"./database-d7598a41.js";import"./QuestionPopover-4ddaeae2.js";import"./stringify-ec884b6d.js";import"./index-7f383368.js";var na={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.3 506.3L781.7 405.6a7.23 7.23 0 00-11.7 5.7V476H548V254h64.8c6 0 9.4-7 5.7-11.7L517.7 114.7a7.14 7.14 0 00-11.3 0L405.6 242.3a7.23 7.23 0 005.7 11.7H476v222H254v-64.8c0-6-7-9.4-11.7-5.7L114.7 506.3a7.14 7.14 0 000 11.3l127.5 100.8c4.7 3.7 11.7.4 11.7-5.7V548h222v222h-64.8c-6 0-9.4 7-5.7 11.7l100.8 127.5c2.9 3.7 8.5 3.7 11.3 0l100.8-127.5c3.7-4.7.4-11.7-5.7-11.7H548V548h222v64.8c0 6 7 9.4 11.7 5.7l127.5-100.8a7.3 7.3 0 00.1-11.4z"}}]},name:"drag",theme:"outlined"};const aa=na;function to(e){for(var o=1;o<arguments.length;o++){var t=arguments[o]!=null?Object(arguments[o]):{},n=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable}))),n.forEach(function(a){ra(e,a,t[a])})}return e}function ra(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}var Lt=function(o,t){var n=to({},o,t.attrs);return p(Sn,to({},n,{icon:aa}),null)};Lt.displayName="DragOutlined";Lt.inheritAttrs=!1;const xt=Lt;var la=Object.defineProperty,gt=Object.getOwnPropertySymbols,bo=Object.prototype.hasOwnProperty,yo=Object.prototype.propertyIsEnumerable,oo=(e,o,t)=>o in e?la(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t,Le=(e,o)=>{for(var t in o||(o={}))bo.call(o,t)&&oo(e,t,o[t]);if(gt)for(var t of gt(o))yo.call(o,t)&&oo(e,t,o[t]);return e},wo=(e,o)=>{var t={};for(var n in e)bo.call(e,n)&&o.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&gt)for(var n of gt(e))o.indexOf(n)<0&&yo.call(e,n)&&(t[n]=e[n]);return t};const ko="[vue-draggable-plus]: ";function ia(e){console.warn(ko+e)}function sa(e){console.error(ko+e)}function ua(e,o,t){Array.isArray(e)&&t>=0&&t<e.length&&e.splice(t,0,e.splice(o,1)[0])}function ca(e){return e.replace(/-(\w)/g,(o,t)=>t?t.toUpperCase():"")}function da(e){return Object.keys(e).reduce((o,t)=>(typeof e[t]<"u"&&(o[ca(t)]=e[t]),o),{})}function pa(e,o){if(Array.isArray(e))return e.splice(o,1)}function fa(e,o,t){if(Array.isArray(e))return e.splice(o,0,t)}function ha(e){return typeof e>"u"}function ma(e){return typeof e=="string"}function no(e,o,t){const n=e.children[t];e.insertBefore(o,n)}function Ct(e){e.parentNode&&e.parentNode.removeChild(e)}function va(e,o=document){var t;let n=null;return typeof(o==null?void 0:o.querySelector)=="function"?n=(t=o==null?void 0:o.querySelector)==null?void 0:t.call(o,e):n=document.querySelector(e),n||ia(`Element not found: ${e}`),n}function ga(e,o,t=null){return function(...n){return e.apply(t,n),o.apply(t,n)}}function _a(e,o){const t=Le({},e);return Object.keys(o).forEach(n=>{t[n]?t[n]=ga(e[n],o[n]):t[n]=o[n]}),t}function ba(e){return e instanceof HTMLElement}function ya(e,o){Object.keys(e).forEach(t=>{o(t,e[t])})}/**!
 * Sortable 1.15.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function ao(e,o){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);o&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function we(e){for(var o=1;o<arguments.length;o++){var t=arguments[o]!=null?arguments[o]:{};o%2?ao(Object(t),!0).forEach(function(n){wa(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ao(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function pt(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?pt=function(o){return typeof o}:pt=function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},pt(e)}function wa(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}function Ee(){return Ee=Object.assign||function(e){for(var o=1;o<arguments.length;o++){var t=arguments[o];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Ee.apply(this,arguments)}function ka(e,o){if(e==null)return{};var t={},n=Object.keys(e),a,r;for(r=0;r<n.length;r++)a=n[r],!(o.indexOf(a)>=0)&&(t[a]=e[a]);return t}function Da(e,o){if(e==null)return{};var t=ka(e,o),n,a;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],!(o.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(t[n]=e[n])}return t}var Ea="1.15.0";function De(e){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(e)}var Se=De(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),at=De(/Edge/i),ro=De(/firefox/i),Ke=De(/safari/i)&&!De(/chrome/i)&&!De(/android/i),Do=De(/iP(ad|od|hone)/i),Eo=De(/chrome/i)&&De(/android/i),So={capture:!1,passive:!1};function I(e,o,t){e.addEventListener(o,t,!Se&&So)}function O(e,o,t){e.removeEventListener(o,t,!Se&&So)}function _t(e,o){if(o){if(o[0]===">"&&(o=o.substring(1)),e)try{if(e.matches)return e.matches(o);if(e.msMatchesSelector)return e.msMatchesSelector(o);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(o)}catch{return!1}return!1}}function Sa(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function be(e,o,t,n){if(e){t=t||document;do{if(o!=null&&(o[0]===">"?e.parentNode===t&&_t(e,o):_t(e,o))||n&&e===t)return e;if(e===t)break}while(e=Sa(e))}return null}var lo=/\s+/g;function pe(e,o,t){if(e&&o)if(e.classList)e.classList[t?"add":"remove"](o);else{var n=(" "+e.className+" ").replace(lo," ").replace(" "+o+" "," ");e.className=(n+(t?" "+o:"")).replace(lo," ")}}function w(e,o,t){var n=e&&e.style;if(n){if(t===void 0)return document.defaultView&&document.defaultView.getComputedStyle?t=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(t=e.currentStyle),o===void 0?t:t[o];!(o in n)&&o.indexOf("webkit")===-1&&(o="-webkit-"+o),n[o]=t+(typeof t=="string"?"":"px")}}function Ge(e,o){var t="";if(typeof e=="string")t=e;else do{var n=w(e,"transform");n&&n!=="none"&&(t=n+" "+t)}while(!o&&(e=e.parentNode));var a=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return a&&new a(t)}function xo(e,o,t){if(e){var n=e.getElementsByTagName(o),a=0,r=n.length;if(t)for(;a<r;a++)t(n[a],a);return n}return[]}function ye(){var e=document.scrollingElement;return e||document.documentElement}function G(e,o,t,n,a){if(!(!e.getBoundingClientRect&&e!==window)){var r,l,s,i,d,f,v;if(e!==window&&e.parentNode&&e!==ye()?(r=e.getBoundingClientRect(),l=r.top,s=r.left,i=r.bottom,d=r.right,f=r.height,v=r.width):(l=0,s=0,i=window.innerHeight,d=window.innerWidth,f=window.innerHeight,v=window.innerWidth),(o||t)&&e!==window&&(a=a||e.parentNode,!Se))do if(a&&a.getBoundingClientRect&&(w(a,"transform")!=="none"||t&&w(a,"position")!=="static")){var h=a.getBoundingClientRect();l-=h.top+parseInt(w(a,"border-top-width")),s-=h.left+parseInt(w(a,"border-left-width")),i=l+r.height,d=s+r.width;break}while(a=a.parentNode);if(n&&e!==window){var m=Ge(a||e),A=m&&m.a,S=m&&m.d;m&&(l/=S,s/=A,v/=A,f/=S,i=l+f,d=s+v)}return{top:l,left:s,bottom:i,right:d,width:v,height:f}}}function io(e,o,t){for(var n=Oe(e,!0),a=G(e)[o];n;){var r=G(n)[t],l=void 0;if(t==="top"||t==="left"?l=a>=r:l=a<=r,!l)return n;if(n===ye())break;n=Oe(n,!1)}return!1}function qe(e,o,t,n){for(var a=0,r=0,l=e.children;r<l.length;){if(l[r].style.display!=="none"&&l[r]!==k.ghost&&(n||l[r]!==k.dragged)&&be(l[r],t.draggable,e,!1)){if(a===o)return l[r];a++}r++}return null}function Ht(e,o){for(var t=e.lastElementChild;t&&(t===k.ghost||w(t,"display")==="none"||o&&!_t(t,o));)t=t.previousElementSibling;return t||null}function ve(e,o){var t=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)e.nodeName.toUpperCase()!=="TEMPLATE"&&e!==k.clone&&(!o||_t(e,o))&&t++;return t}function so(e){var o=0,t=0,n=ye();if(e)do{var a=Ge(e),r=a.a,l=a.d;o+=e.scrollLeft*r,t+=e.scrollTop*l}while(e!==n&&(e=e.parentNode));return[o,t]}function xa(e,o){for(var t in e)if(e.hasOwnProperty(t)){for(var n in o)if(o.hasOwnProperty(n)&&o[n]===e[t][n])return Number(t)}return-1}function Oe(e,o){if(!e||!e.getBoundingClientRect)return ye();var t=e,n=!1;do if(t.clientWidth<t.scrollWidth||t.clientHeight<t.scrollHeight){var a=w(t);if(t.clientWidth<t.scrollWidth&&(a.overflowX=="auto"||a.overflowX=="scroll")||t.clientHeight<t.scrollHeight&&(a.overflowY=="auto"||a.overflowY=="scroll")){if(!t.getBoundingClientRect||t===document.body)return ye();if(n||o)return t;n=!0}}while(t=t.parentNode);return ye()}function Ca(e,o){if(e&&o)for(var t in o)o.hasOwnProperty(t)&&(e[t]=o[t]);return e}function Tt(e,o){return Math.round(e.top)===Math.round(o.top)&&Math.round(e.left)===Math.round(o.left)&&Math.round(e.height)===Math.round(o.height)&&Math.round(e.width)===Math.round(o.width)}var et;function Co(e,o){return function(){if(!et){var t=arguments,n=this;t.length===1?e.call(n,t[0]):e.apply(n,t),et=setTimeout(function(){et=void 0},o)}}}function Ta(){clearTimeout(et),et=void 0}function To(e,o,t){e.scrollLeft+=o,e.scrollTop+=t}function Oo(e){var o=window.Polymer,t=window.jQuery||window.Zepto;return o&&o.dom?o.dom(e).cloneNode(!0):t?t(e).clone(!0)[0]:e.cloneNode(!0)}var he="Sortable"+new Date().getTime();function Oa(){var e=[],o;return{captureAnimationState:function(){if(e=[],!!this.options.animation){var t=[].slice.call(this.el.children);t.forEach(function(n){if(!(w(n,"display")==="none"||n===k.ghost)){e.push({target:n,rect:G(n)});var a=we({},e[e.length-1].rect);if(n.thisAnimationDuration){var r=Ge(n,!0);r&&(a.top-=r.f,a.left-=r.e)}n.fromRect=a}})}},addAnimationState:function(t){e.push(t)},removeAnimationState:function(t){e.splice(xa(e,{target:t}),1)},animateAll:function(t){var n=this;if(!this.options.animation){clearTimeout(o),typeof t=="function"&&t();return}var a=!1,r=0;e.forEach(function(l){var s=0,i=l.target,d=i.fromRect,f=G(i),v=i.prevFromRect,h=i.prevToRect,m=l.rect,A=Ge(i,!0);A&&(f.top-=A.f,f.left-=A.e),i.toRect=f,i.thisAnimationDuration&&Tt(v,f)&&!Tt(d,f)&&(m.top-f.top)/(m.left-f.left)===(d.top-f.top)/(d.left-f.left)&&(s=Na(m,v,h,n.options)),Tt(f,d)||(i.prevFromRect=d,i.prevToRect=f,s||(s=n.options.animation),n.animate(i,m,f,s)),s&&(a=!0,r=Math.max(r,s),clearTimeout(i.animationResetTimer),i.animationResetTimer=setTimeout(function(){i.animationTime=0,i.prevFromRect=null,i.fromRect=null,i.prevToRect=null,i.thisAnimationDuration=null},s),i.thisAnimationDuration=s)}),clearTimeout(o),a?o=setTimeout(function(){typeof t=="function"&&t()},r):typeof t=="function"&&t(),e=[]},animate:function(t,n,a,r){if(r){w(t,"transition",""),w(t,"transform","");var l=Ge(this.el),s=l&&l.a,i=l&&l.d,d=(n.left-a.left)/(s||1),f=(n.top-a.top)/(i||1);t.animatingX=!!d,t.animatingY=!!f,w(t,"transform","translate3d("+d+"px,"+f+"px,0)"),this.forRepaintDummy=Ia(t),w(t,"transition","transform "+r+"ms"+(this.options.easing?" "+this.options.easing:"")),w(t,"transform","translate3d(0,0,0)"),typeof t.animated=="number"&&clearTimeout(t.animated),t.animated=setTimeout(function(){w(t,"transition",""),w(t,"transform",""),t.animated=!1,t.animatingX=!1,t.animatingY=!1},r)}}}}function Ia(e){return e.offsetWidth}function Na(e,o,t,n){return Math.sqrt(Math.pow(o.top-e.top,2)+Math.pow(o.left-e.left,2))/Math.sqrt(Math.pow(o.top-t.top,2)+Math.pow(o.left-t.left,2))*n.animation}var Be=[],Ot={initializeByDefault:!0},rt={mount:function(e){for(var o in Ot)Ot.hasOwnProperty(o)&&!(o in e)&&(e[o]=Ot[o]);Be.forEach(function(t){if(t.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),Be.push(e)},pluginEvent:function(e,o,t){var n=this;this.eventCanceled=!1,t.cancel=function(){n.eventCanceled=!0};var a=e+"Global";Be.forEach(function(r){o[r.pluginName]&&(o[r.pluginName][a]&&o[r.pluginName][a](we({sortable:o},t)),o.options[r.pluginName]&&o[r.pluginName][e]&&o[r.pluginName][e](we({sortable:o},t)))})},initializePlugins:function(e,o,t,n){Be.forEach(function(l){var s=l.pluginName;if(!(!e.options[s]&&!l.initializeByDefault)){var i=new l(e,o,e.options);i.sortable=e,i.options=e.options,e[s]=i,Ee(t,i.defaults)}});for(var a in e.options)if(e.options.hasOwnProperty(a)){var r=this.modifyOption(e,a,e.options[a]);typeof r<"u"&&(e.options[a]=r)}},getEventProperties:function(e,o){var t={};return Be.forEach(function(n){typeof n.eventProperties=="function"&&Ee(t,n.eventProperties.call(o[n.pluginName],e))}),t},modifyOption:function(e,o,t){var n;return Be.forEach(function(a){e[a.pluginName]&&a.optionListeners&&typeof a.optionListeners[o]=="function"&&(n=a.optionListeners[o].call(e[a.pluginName],t))}),n}};function Aa(e){var o=e.sortable,t=e.rootEl,n=e.name,a=e.targetEl,r=e.cloneEl,l=e.toEl,s=e.fromEl,i=e.oldIndex,d=e.newIndex,f=e.oldDraggableIndex,v=e.newDraggableIndex,h=e.originalEvent,m=e.putSortable,A=e.extraEventProperties;if(o=o||t&&t[he],!!o){var S,F=o.options,M="on"+n.charAt(0).toUpperCase()+n.substr(1);window.CustomEvent&&!Se&&!at?S=new CustomEvent(n,{bubbles:!0,cancelable:!0}):(S=document.createEvent("Event"),S.initEvent(n,!0,!0)),S.to=l||t,S.from=s||t,S.item=a||t,S.clone=r,S.oldIndex=i,S.newIndex=d,S.oldDraggableIndex=f,S.newDraggableIndex=v,S.originalEvent=h,S.pullMode=m?m.lastPutMode:void 0;var X=we(we({},A),rt.getEventProperties(n,o));for(var j in X)S[j]=X[j];t&&t.dispatchEvent(S),F[M]&&F[M].call(o,S)}}var Pa=["evt"],le=function(e,o){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=t.evt,a=Da(t,Pa);rt.pluginEvent.bind(k)(e,o,we({dragEl:c,parentEl:$,ghostEl:E,rootEl:U,nextEl:Ve,lastDownEl:ft,cloneEl:R,cloneHidden:Te,dragStarted:Je,putSortable:J,activeSortable:k.active,originalEvent:n,oldIndex:He,oldDraggableIndex:tt,newIndex:fe,newDraggableIndex:Ce,hideGhostForTarget:Po,unhideGhostForTarget:Mo,cloneNowHidden:function(){Te=!0},cloneNowShown:function(){Te=!1},dispatchSortableEvent:function(r){ae({sortable:o,name:r,originalEvent:n})}},a))};function ae(e){Aa(we({putSortable:J,cloneEl:R,targetEl:c,rootEl:U,oldIndex:He,oldDraggableIndex:tt,newIndex:fe,newDraggableIndex:Ce},e))}var c,$,E,U,Ve,ft,R,Te,He,fe,tt,Ce,st,J,Ye=!1,bt=!1,yt=[],Me,_e,It,Nt,uo,co,Je,$e,ot,nt=!1,ut=!1,ht,oe,At=[],Ft=!1,wt=[],Dt=typeof document<"u",ct=Do,po=at||Se?"cssFloat":"float",Ma=Dt&&!Eo&&!Do&&"draggable"in document.createElement("div"),Io=function(){if(Dt){if(Se)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto",e.style.pointerEvents==="auto"}}(),No=function(e,o){var t=w(e),n=parseInt(t.width)-parseInt(t.paddingLeft)-parseInt(t.paddingRight)-parseInt(t.borderLeftWidth)-parseInt(t.borderRightWidth),a=qe(e,0,o),r=qe(e,1,o),l=a&&w(a),s=r&&w(r),i=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+G(a).width,d=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+G(r).width;if(t.display==="flex")return t.flexDirection==="column"||t.flexDirection==="column-reverse"?"vertical":"horizontal";if(t.display==="grid")return t.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(a&&l.float&&l.float!=="none"){var f=l.float==="left"?"left":"right";return r&&(s.clear==="both"||s.clear===f)?"vertical":"horizontal"}return a&&(l.display==="block"||l.display==="flex"||l.display==="table"||l.display==="grid"||i>=n&&t[po]==="none"||r&&t[po]==="none"&&i+d>n)?"vertical":"horizontal"},Ua=function(e,o,t){var n=t?e.left:e.top,a=t?e.right:e.bottom,r=t?e.width:e.height,l=t?o.left:o.top,s=t?o.right:o.bottom,i=t?o.width:o.height;return n===l||a===s||n+r/2===l+i/2},Va=function(e,o){var t;return yt.some(function(n){var a=n[he].options.emptyInsertThreshold;if(!(!a||Ht(n))){var r=G(n),l=e>=r.left-a&&e<=r.right+a,s=o>=r.top-a&&o<=r.bottom+a;if(l&&s)return t=n}}),t},Ao=function(e){function o(a,r){return function(l,s,i,d){var f=l.options.group.name&&s.options.group.name&&l.options.group.name===s.options.group.name;if(a==null&&(r||f))return!0;if(a==null||a===!1)return!1;if(r&&a==="clone")return a;if(typeof a=="function")return o(a(l,s,i,d),r)(l,s,i,d);var v=(r?l:s).options.group.name;return a===!0||typeof a=="string"&&a===v||a.join&&a.indexOf(v)>-1}}var t={},n=e.group;(!n||pt(n)!="object")&&(n={name:n}),t.name=n.name,t.checkPull=o(n.pull,!0),t.checkPut=o(n.put),t.revertClone=n.revertClone,e.group=t},Po=function(){!Io&&E&&w(E,"display","none")},Mo=function(){!Io&&E&&w(E,"display","")};Dt&&!Eo&&document.addEventListener("click",function(e){if(bt)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),bt=!1,!1},!0);var Ue=function(e){if(c){e=e.touches?e.touches[0]:e;var o=Va(e.clientX,e.clientY);if(o){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.target=t.rootEl=o,t.preventDefault=void 0,t.stopPropagation=void 0,o[he]._onDragOver(t)}}},Ra=function(e){c&&c.parentNode[he]._isOutsideThisEl(e.target)};function k(e,o){if(!(e&&e.nodeType&&e.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=o=Ee({},o),e[he]=this;var t={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return No(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(r,l){r.setData("Text",l.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:k.supportPointer!==!1&&"PointerEvent"in window&&!Ke,emptyInsertThreshold:5};rt.initializePlugins(this,e,t);for(var n in t)!(n in o)&&(o[n]=t[n]);Ao(o);for(var a in this)a.charAt(0)==="_"&&typeof this[a]=="function"&&(this[a]=this[a].bind(this));this.nativeDraggable=o.forceFallback?!1:Ma,this.nativeDraggable&&(this.options.touchStartThreshold=1),o.supportPointer?I(e,"pointerdown",this._onTapStart):(I(e,"mousedown",this._onTapStart),I(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(I(e,"dragover",this),I(e,"dragenter",this)),yt.push(this.el),o.store&&o.store.get&&this.sort(o.store.get(this)||[]),Ee(this,Oa())}k.prototype={constructor:k,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&($e=null)},_getDirection:function(e,o){return typeof this.options.direction=="function"?this.options.direction.call(this,e,o,c):this.options.direction},_onTapStart:function(e){if(e.cancelable){var o=this,t=this.el,n=this.options,a=n.preventOnFilter,r=e.type,l=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,s=(l||e).target,i=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||s,d=n.filter;if(La(t),!c&&!(/mousedown|pointerdown/.test(r)&&e.button!==0||n.disabled)&&!i.isContentEditable&&!(!this.nativeDraggable&&Ke&&s&&s.tagName.toUpperCase()==="SELECT")&&(s=be(s,n.draggable,t,!1),!(s&&s.animated)&&ft!==s)){if(He=ve(s),tt=ve(s,n.draggable),typeof d=="function"){if(d.call(this,e,s,this)){ae({sortable:o,rootEl:i,name:"filter",targetEl:s,toEl:t,fromEl:t}),le("filter",o,{evt:e}),a&&e.cancelable&&e.preventDefault();return}}else if(d&&(d=d.split(",").some(function(f){if(f=be(i,f.trim(),t,!1),f)return ae({sortable:o,rootEl:f,name:"filter",targetEl:s,fromEl:t,toEl:t}),le("filter",o,{evt:e}),!0}),d)){a&&e.cancelable&&e.preventDefault();return}n.handle&&!be(i,n.handle,t,!1)||this._prepareDragStart(e,l,s)}}},_prepareDragStart:function(e,o,t){var n=this,a=n.el,r=n.options,l=a.ownerDocument,s;if(t&&!c&&t.parentNode===a){var i=G(t);if(U=a,c=t,$=c.parentNode,Ve=c.nextSibling,ft=t,st=r.group,k.dragged=c,Me={target:c,clientX:(o||e).clientX,clientY:(o||e).clientY},uo=Me.clientX-i.left,co=Me.clientY-i.top,this._lastX=(o||e).clientX,this._lastY=(o||e).clientY,c.style["will-change"]="all",s=function(){if(le("delayEnded",n,{evt:e}),k.eventCanceled){n._onDrop();return}n._disableDelayedDragEvents(),!ro&&n.nativeDraggable&&(c.draggable=!0),n._triggerDragStart(e,o),ae({sortable:n,name:"choose",originalEvent:e}),pe(c,r.chosenClass,!0)},r.ignore.split(",").forEach(function(d){xo(c,d.trim(),Pt)}),I(l,"dragover",Ue),I(l,"mousemove",Ue),I(l,"touchmove",Ue),I(l,"mouseup",n._onDrop),I(l,"touchend",n._onDrop),I(l,"touchcancel",n._onDrop),ro&&this.nativeDraggable&&(this.options.touchStartThreshold=4,c.draggable=!0),le("delayStart",this,{evt:e}),r.delay&&(!r.delayOnTouchOnly||o)&&(!this.nativeDraggable||!(at||Se))){if(k.eventCanceled){this._onDrop();return}I(l,"mouseup",n._disableDelayedDrag),I(l,"touchend",n._disableDelayedDrag),I(l,"touchcancel",n._disableDelayedDrag),I(l,"mousemove",n._delayedDragTouchMoveHandler),I(l,"touchmove",n._delayedDragTouchMoveHandler),r.supportPointer&&I(l,"pointermove",n._delayedDragTouchMoveHandler),n._dragStartTimer=setTimeout(s,r.delay)}else s()}},_delayedDragTouchMoveHandler:function(e){var o=e.touches?e.touches[0]:e;Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){c&&Pt(c),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;O(e,"mouseup",this._disableDelayedDrag),O(e,"touchend",this._disableDelayedDrag),O(e,"touchcancel",this._disableDelayedDrag),O(e,"mousemove",this._delayedDragTouchMoveHandler),O(e,"touchmove",this._delayedDragTouchMoveHandler),O(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,o){o=o||e.pointerType=="touch"&&e,!this.nativeDraggable||o?this.options.supportPointer?I(document,"pointermove",this._onTouchMove):o?I(document,"touchmove",this._onTouchMove):I(document,"mousemove",this._onTouchMove):(I(c,"dragend",this),I(U,"dragstart",this._onDragStart));try{document.selection?mt(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,o){if(Ye=!1,U&&c){le("dragStarted",this,{evt:o}),this.nativeDraggable&&I(document,"dragover",Ra);var t=this.options;!e&&pe(c,t.dragClass,!1),pe(c,t.ghostClass,!0),k.active=this,e&&this._appendGhost(),ae({sortable:this,name:"start",originalEvent:o})}else this._nulling()},_emulateDragOver:function(){if(_e){this._lastX=_e.clientX,this._lastY=_e.clientY,Po();for(var e=document.elementFromPoint(_e.clientX,_e.clientY),o=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(_e.clientX,_e.clientY),e!==o);)o=e;if(c.parentNode[he]._isOutsideThisEl(e),o)do{if(o[he]){var t=void 0;if(t=o[he]._onDragOver({clientX:_e.clientX,clientY:_e.clientY,target:e,rootEl:o}),t&&!this.options.dragoverBubble)break}e=o}while(o=o.parentNode);Mo()}},_onTouchMove:function(e){if(Me){var o=this.options,t=o.fallbackTolerance,n=o.fallbackOffset,a=e.touches?e.touches[0]:e,r=E&&Ge(E,!0),l=E&&r&&r.a,s=E&&r&&r.d,i=ct&&oe&&so(oe),d=(a.clientX-Me.clientX+n.x)/(l||1)+(i?i[0]-At[0]:0)/(l||1),f=(a.clientY-Me.clientY+n.y)/(s||1)+(i?i[1]-At[1]:0)/(s||1);if(!k.active&&!Ye){if(t&&Math.max(Math.abs(a.clientX-this._lastX),Math.abs(a.clientY-this._lastY))<t)return;this._onDragStart(e,!0)}if(E){r?(r.e+=d-(It||0),r.f+=f-(Nt||0)):r={a:1,b:0,c:0,d:1,e:d,f};var v="matrix(".concat(r.a,",").concat(r.b,",").concat(r.c,",").concat(r.d,",").concat(r.e,",").concat(r.f,")");w(E,"webkitTransform",v),w(E,"mozTransform",v),w(E,"msTransform",v),w(E,"transform",v),It=d,Nt=f,_e=a}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!E){var e=this.options.fallbackOnBody?document.body:U,o=G(c,!0,ct,!0,e),t=this.options;if(ct){for(oe=e;w(oe,"position")==="static"&&w(oe,"transform")==="none"&&oe!==document;)oe=oe.parentNode;oe!==document.body&&oe!==document.documentElement?(oe===document&&(oe=ye()),o.top+=oe.scrollTop,o.left+=oe.scrollLeft):oe=ye(),At=so(oe)}E=c.cloneNode(!0),pe(E,t.ghostClass,!1),pe(E,t.fallbackClass,!0),pe(E,t.dragClass,!0),w(E,"transition",""),w(E,"transform",""),w(E,"box-sizing","border-box"),w(E,"margin",0),w(E,"top",o.top),w(E,"left",o.left),w(E,"width",o.width),w(E,"height",o.height),w(E,"opacity","0.8"),w(E,"position",ct?"absolute":"fixed"),w(E,"zIndex","100000"),w(E,"pointerEvents","none"),k.ghost=E,e.appendChild(E),w(E,"transform-origin",uo/parseInt(E.style.width)*100+"% "+co/parseInt(E.style.height)*100+"%")}},_onDragStart:function(e,o){var t=this,n=e.dataTransfer,a=t.options;if(le("dragStart",this,{evt:e}),k.eventCanceled){this._onDrop();return}le("setupClone",this),k.eventCanceled||(R=Oo(c),R.removeAttribute("id"),R.draggable=!1,R.style["will-change"]="",this._hideClone(),pe(R,this.options.chosenClass,!1),k.clone=R),t.cloneId=mt(function(){le("clone",t),!k.eventCanceled&&(t.options.removeCloneOnHide||U.insertBefore(R,c),t._hideClone(),ae({sortable:t,name:"clone"}))}),!o&&pe(c,a.dragClass,!0),o?(bt=!0,t._loopId=setInterval(t._emulateDragOver,50)):(O(document,"mouseup",t._onDrop),O(document,"touchend",t._onDrop),O(document,"touchcancel",t._onDrop),n&&(n.effectAllowed="move",a.setData&&a.setData.call(t,n,c)),I(document,"drop",t),w(c,"transform","translateZ(0)")),Ye=!0,t._dragStartId=mt(t._dragStarted.bind(t,o,e)),I(document,"selectstart",t),Je=!0,Ke&&w(document.body,"user-select","none")},_onDragOver:function(e){var o=this.el,t=e.target,n,a,r,l=this.options,s=l.group,i=k.active,d=st===s,f=l.sort,v=J||i,h,m=this,A=!1;if(Ft)return;function S(ce,ke){le(ce,m,we({evt:e,isOwner:d,axis:h?"vertical":"horizontal",revert:r,dragRect:n,targetRect:a,canSort:f,fromSortable:v,target:t,completed:M,onMove:function(Ie,me){return dt(U,o,c,n,Ie,G(Ie),e,me)},changed:X},ke))}function F(){S("dragOverAnimationCapture"),m.captureAnimationState(),m!==v&&v.captureAnimationState()}function M(ce){return S("dragOverCompleted",{insertion:ce}),ce&&(d?i._hideClone():i._showClone(m),m!==v&&(pe(c,J?J.options.ghostClass:i.options.ghostClass,!1),pe(c,l.ghostClass,!0)),J!==m&&m!==k.active?J=m:m===k.active&&J&&(J=null),v===m&&(m._ignoreWhileAnimating=t),m.animateAll(function(){S("dragOverAnimationComplete"),m._ignoreWhileAnimating=null}),m!==v&&(v.animateAll(),v._ignoreWhileAnimating=null)),(t===c&&!c.animated||t===o&&!t.animated)&&($e=null),!l.dragoverBubble&&!e.rootEl&&t!==document&&(c.parentNode[he]._isOutsideThisEl(e.target),!ce&&Ue(e)),!l.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),A=!0}function X(){fe=ve(c),Ce=ve(c,l.draggable),ae({sortable:m,name:"change",toEl:o,newIndex:fe,newDraggableIndex:Ce,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),t=be(t,l.draggable,o,!0),S("dragOver"),k.eventCanceled)return A;if(c.contains(e.target)||t.animated&&t.animatingX&&t.animatingY||m._ignoreWhileAnimating===t)return M(!1);if(bt=!1,i&&!l.disabled&&(d?f||(r=$!==U):J===this||(this.lastPutMode=st.checkPull(this,i,c,e))&&s.checkPut(this,i,c,e))){if(h=this._getDirection(e,t)==="vertical",n=G(c),S("dragOverValid"),k.eventCanceled)return A;if(r)return $=U,F(),this._hideClone(),S("revert"),k.eventCanceled||(Ve?U.insertBefore(c,Ve):U.appendChild(c)),M(!0);var j=Ht(o,l.draggable);if(!j||$a(e,h,this)&&!j.animated){if(j===c)return M(!1);if(j&&o===e.target&&(t=j),t&&(a=G(t)),dt(U,o,c,n,t,a,e,!!t)!==!1)return F(),j&&j.nextSibling?o.insertBefore(c,j.nextSibling):o.appendChild(c),$=o,X(),M(!0)}else if(j&&Ba(e,h,this)){var se=qe(o,0,l,!0);if(se===c)return M(!1);if(t=se,a=G(t),dt(U,o,c,n,t,a,e,!1)!==!1)return F(),o.insertBefore(c,se),$=o,X(),M(!0)}else if(t.parentNode===o){a=G(t);var b=0,T,K=c.parentNode!==o,q=!Ua(c.animated&&c.toRect||n,t.animated&&t.toRect||a,h),V=h?"top":"left",ee=io(t,"top","top")||io(c,"top","top"),xe=ee?ee.scrollTop:void 0;$e!==t&&(T=a[V],nt=!1,ut=!q&&l.invertSwap||K),b=Xa(e,t,a,h,q?1:l.swapThreshold,l.invertedSwapThreshold==null?l.swapThreshold:l.invertedSwapThreshold,ut,$e===t);var N;if(b!==0){var te=ve(c);do te-=b,N=$.children[te];while(N&&(w(N,"display")==="none"||N===E))}if(b===0||N===t)return M(!1);$e=t,ot=b;var ne=t.nextElementSibling,ue=!1;ue=b===1;var ge=dt(U,o,c,n,t,a,e,ue);if(ge!==!1)return(ge===1||ge===-1)&&(ue=ge===1),Ft=!0,setTimeout(ja,30),F(),ue&&!ne?o.appendChild(c):t.parentNode.insertBefore(c,ue?ne:t),ee&&To(ee,0,xe-ee.scrollTop),$=c.parentNode,T!==void 0&&!ut&&(ht=Math.abs(T-G(t)[V])),X(),M(!0)}if(o.contains(c))return M(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){O(document,"mousemove",this._onTouchMove),O(document,"touchmove",this._onTouchMove),O(document,"pointermove",this._onTouchMove),O(document,"dragover",Ue),O(document,"mousemove",Ue),O(document,"touchmove",Ue)},_offUpEvents:function(){var e=this.el.ownerDocument;O(e,"mouseup",this._onDrop),O(e,"touchend",this._onDrop),O(e,"pointerup",this._onDrop),O(e,"touchcancel",this._onDrop),O(document,"selectstart",this)},_onDrop:function(e){var o=this.el,t=this.options;if(fe=ve(c),Ce=ve(c,t.draggable),le("drop",this,{evt:e}),$=c&&c.parentNode,fe=ve(c),Ce=ve(c,t.draggable),k.eventCanceled){this._nulling();return}Ye=!1,ut=!1,nt=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),jt(this.cloneId),jt(this._dragStartId),this.nativeDraggable&&(O(document,"drop",this),O(o,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Ke&&w(document.body,"user-select",""),w(c,"transform",""),e&&(Je&&(e.cancelable&&e.preventDefault(),!t.dropBubble&&e.stopPropagation()),E&&E.parentNode&&E.parentNode.removeChild(E),(U===$||J&&J.lastPutMode!=="clone")&&R&&R.parentNode&&R.parentNode.removeChild(R),c&&(this.nativeDraggable&&O(c,"dragend",this),Pt(c),c.style["will-change"]="",Je&&!Ye&&pe(c,J?J.options.ghostClass:this.options.ghostClass,!1),pe(c,this.options.chosenClass,!1),ae({sortable:this,name:"unchoose",toEl:$,newIndex:null,newDraggableIndex:null,originalEvent:e}),U!==$?(fe>=0&&(ae({rootEl:$,name:"add",toEl:$,fromEl:U,originalEvent:e}),ae({sortable:this,name:"remove",toEl:$,originalEvent:e}),ae({rootEl:$,name:"sort",toEl:$,fromEl:U,originalEvent:e}),ae({sortable:this,name:"sort",toEl:$,originalEvent:e})),J&&J.save()):fe!==He&&fe>=0&&(ae({sortable:this,name:"update",toEl:$,originalEvent:e}),ae({sortable:this,name:"sort",toEl:$,originalEvent:e})),k.active&&((fe==null||fe===-1)&&(fe=He,Ce=tt),ae({sortable:this,name:"end",toEl:$,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){le("nulling",this),U=c=$=E=Ve=R=ft=Te=Me=_e=Je=fe=Ce=He=tt=$e=ot=J=st=k.dragged=k.ghost=k.clone=k.active=null,wt.forEach(function(e){e.checked=!0}),wt.length=It=Nt=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":c&&(this._onDragOver(e),Fa(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],o,t=this.el.children,n=0,a=t.length,r=this.options;n<a;n++)o=t[n],be(o,r.draggable,this.el,!1)&&e.push(o.getAttribute(r.dataIdAttr)||Wa(o));return e},sort:function(e,o){var t={},n=this.el;this.toArray().forEach(function(a,r){var l=n.children[r];be(l,this.options.draggable,n,!1)&&(t[a]=l)},this),o&&this.captureAnimationState(),e.forEach(function(a){t[a]&&(n.removeChild(t[a]),n.appendChild(t[a]))}),o&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,o){return be(e,o||this.options.draggable,this.el,!1)},option:function(e,o){var t=this.options;if(o===void 0)return t[e];var n=rt.modifyOption(this,e,o);typeof n<"u"?t[e]=n:t[e]=o,e==="group"&&Ao(t)},destroy:function(){le("destroy",this);var e=this.el;e[he]=null,O(e,"mousedown",this._onTapStart),O(e,"touchstart",this._onTapStart),O(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(O(e,"dragover",this),O(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(o){o.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),yt.splice(yt.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!Te){if(le("hideClone",this),k.eventCanceled)return;w(R,"display","none"),this.options.removeCloneOnHide&&R.parentNode&&R.parentNode.removeChild(R),Te=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(Te){if(le("showClone",this),k.eventCanceled)return;c.parentNode==U&&!this.options.group.revertClone?U.insertBefore(R,c):Ve?U.insertBefore(R,Ve):U.appendChild(R),this.options.group.revertClone&&this.animate(c,R),w(R,"display",""),Te=!1}}};function Fa(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function dt(e,o,t,n,a,r,l,s){var i,d=e[he],f=d.options.onMove,v;return window.CustomEvent&&!Se&&!at?i=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(i=document.createEvent("Event"),i.initEvent("move",!0,!0)),i.to=o,i.from=e,i.dragged=t,i.draggedRect=n,i.related=a||o,i.relatedRect=r||G(o),i.willInsertAfter=s,i.originalEvent=l,e.dispatchEvent(i),f&&(v=f.call(d,i,l)),v}function Pt(e){e.draggable=!1}function ja(){Ft=!1}function Ba(e,o,t){var n=G(qe(t.el,0,t.options,!0)),a=10;return o?e.clientX<n.left-a||e.clientY<n.top&&e.clientX<n.right:e.clientY<n.top-a||e.clientY<n.bottom&&e.clientX<n.left}function $a(e,o,t){var n=G(Ht(t.el,t.options.draggable)),a=10;return o?e.clientX>n.right+a||e.clientX<=n.right&&e.clientY>n.bottom&&e.clientX>=n.left:e.clientX>n.right&&e.clientY>n.top||e.clientX<=n.right&&e.clientY>n.bottom+a}function Xa(e,o,t,n,a,r,l,s){var i=n?e.clientY:e.clientX,d=n?t.height:t.width,f=n?t.top:t.left,v=n?t.bottom:t.right,h=!1;if(!l){if(s&&ht<d*a){if(!nt&&(ot===1?i>f+d*r/2:i<v-d*r/2)&&(nt=!0),nt)h=!0;else if(ot===1?i<f+ht:i>v-ht)return-ot}else if(i>f+d*(1-a)/2&&i<v-d*(1-a)/2)return Ya(o)}return h=h||l,h&&(i<f+d*r/2||i>v-d*r/2)?i>f+d/2?1:-1:0}function Ya(e){return ve(c)<ve(e)?1:-1}function Wa(e){for(var o=e.tagName+e.className+e.src+e.href+e.textContent,t=o.length,n=0;t--;)n+=o.charCodeAt(t);return n.toString(36)}function La(e){wt.length=0;for(var o=e.getElementsByTagName("input"),t=o.length;t--;){var n=o[t];n.checked&&wt.push(n)}}function mt(e){return setTimeout(e,0)}function jt(e){return clearTimeout(e)}Dt&&I(document,"touchmove",function(e){(k.active||Ye)&&e.cancelable&&e.preventDefault()});k.utils={on:I,off:O,css:w,find:xo,is:function(e,o){return!!be(e,o,e,!1)},extend:Ca,throttle:Co,closest:be,toggleClass:pe,clone:Oo,index:ve,nextTick:mt,cancelNextTick:jt,detectDirection:No,getChild:qe};k.get=function(e){return e[he]};k.mount=function(){for(var e=arguments.length,o=new Array(e),t=0;t<e;t++)o[t]=arguments[t];o[0].constructor===Array&&(o=o[0]),o.forEach(function(n){if(!n.prototype||!n.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(n));n.utils&&(k.utils=we(we({},k.utils),n.utils)),rt.mount(n)})};k.create=function(e,o){return new k(e,o)};k.version=Ea;var H=[],Ze,Bt,$t=!1,Mt,Ut,kt,Qe;function Ha(){function e(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var o in this)o.charAt(0)==="_"&&typeof this[o]=="function"&&(this[o]=this[o].bind(this))}return e.prototype={dragStarted:function(o){var t=o.originalEvent;this.sortable.nativeDraggable?I(document,"dragover",this._handleAutoScroll):this.options.supportPointer?I(document,"pointermove",this._handleFallbackAutoScroll):t.touches?I(document,"touchmove",this._handleFallbackAutoScroll):I(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(o){var t=o.originalEvent;!this.options.dragOverBubble&&!t.rootEl&&this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?O(document,"dragover",this._handleAutoScroll):(O(document,"pointermove",this._handleFallbackAutoScroll),O(document,"touchmove",this._handleFallbackAutoScroll),O(document,"mousemove",this._handleFallbackAutoScroll)),fo(),vt(),Ta()},nulling:function(){kt=Bt=Ze=$t=Qe=Mt=Ut=null,H.length=0},_handleFallbackAutoScroll:function(o){this._handleAutoScroll(o,!0)},_handleAutoScroll:function(o,t){var n=this,a=(o.touches?o.touches[0]:o).clientX,r=(o.touches?o.touches[0]:o).clientY,l=document.elementFromPoint(a,r);if(kt=o,t||this.options.forceAutoScrollFallback||at||Se||Ke){Vt(o,this.options,l,t);var s=Oe(l,!0);$t&&(!Qe||a!==Mt||r!==Ut)&&(Qe&&fo(),Qe=setInterval(function(){var i=Oe(document.elementFromPoint(a,r),!0);i!==s&&(s=i,vt()),Vt(o,n.options,i,t)},10),Mt=a,Ut=r)}else{if(!this.options.bubbleScroll||Oe(l,!0)===ye()){vt();return}Vt(o,this.options,Oe(l,!1),!1)}}},Ee(e,{pluginName:"scroll",initializeByDefault:!0})}function vt(){H.forEach(function(e){clearInterval(e.pid)}),H=[]}function fo(){clearInterval(Qe)}var Vt=Co(function(e,o,t,n){if(o.scroll){var a=(e.touches?e.touches[0]:e).clientX,r=(e.touches?e.touches[0]:e).clientY,l=o.scrollSensitivity,s=o.scrollSpeed,i=ye(),d=!1,f;Bt!==t&&(Bt=t,vt(),Ze=o.scroll,f=o.scrollFn,Ze===!0&&(Ze=Oe(t,!0)));var v=0,h=Ze;do{var m=h,A=G(m),S=A.top,F=A.bottom,M=A.left,X=A.right,j=A.width,se=A.height,b=void 0,T=void 0,K=m.scrollWidth,q=m.scrollHeight,V=w(m),ee=m.scrollLeft,xe=m.scrollTop;m===i?(b=j<K&&(V.overflowX==="auto"||V.overflowX==="scroll"||V.overflowX==="visible"),T=se<q&&(V.overflowY==="auto"||V.overflowY==="scroll"||V.overflowY==="visible")):(b=j<K&&(V.overflowX==="auto"||V.overflowX==="scroll"),T=se<q&&(V.overflowY==="auto"||V.overflowY==="scroll"));var N=b&&(Math.abs(X-a)<=l&&ee+j<K)-(Math.abs(M-a)<=l&&!!ee),te=T&&(Math.abs(F-r)<=l&&xe+se<q)-(Math.abs(S-r)<=l&&!!xe);if(!H[v])for(var ne=0;ne<=v;ne++)H[ne]||(H[ne]={});(H[v].vx!=N||H[v].vy!=te||H[v].el!==m)&&(H[v].el=m,H[v].vx=N,H[v].vy=te,clearInterval(H[v].pid),(N!=0||te!=0)&&(d=!0,H[v].pid=setInterval((function(){n&&this.layer===0&&k.active._onTouchMove(kt);var ue=H[this.layer].vy?H[this.layer].vy*s:0,ge=H[this.layer].vx?H[this.layer].vx*s:0;typeof f=="function"&&f.call(k.dragged.parentNode[he],ge,ue,e,kt,H[this.layer].el)!=="continue"||To(H[this.layer].el,ge,ue)}).bind({layer:v}),24))),v++}while(o.bubbleScroll&&h!==i&&(h=Oe(h,!1)));$t=d}},30),Uo=function(e){var o=e.originalEvent,t=e.putSortable,n=e.dragEl,a=e.activeSortable,r=e.dispatchSortableEvent,l=e.hideGhostForTarget,s=e.unhideGhostForTarget;if(o){var i=t||a;l();var d=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:o,f=document.elementFromPoint(d.clientX,d.clientY);s(),i&&!i.el.contains(f)&&(r("spill"),this.onSpill({dragEl:n,putSortable:t}))}};function zt(){}zt.prototype={startIndex:null,dragStart:function(e){var o=e.oldDraggableIndex;this.startIndex=o},onSpill:function(e){var o=e.dragEl,t=e.putSortable;this.sortable.captureAnimationState(),t&&t.captureAnimationState();var n=qe(this.sortable.el,this.startIndex,this.options);n?this.sortable.el.insertBefore(o,n):this.sortable.el.appendChild(o),this.sortable.animateAll(),t&&t.animateAll()},drop:Uo};Ee(zt,{pluginName:"revertOnSpill"});function Gt(){}Gt.prototype={onSpill:function(e){var o=e.dragEl,t=e.putSortable,n=t||this.sortable;n.captureAnimationState(),o.parentNode&&o.parentNode.removeChild(o),n.animateAll()},drop:Uo};Ee(Gt,{pluginName:"removeOnSpill"});k.mount(new Ha);k.mount(Gt,zt);function za(e){return e==null?e:JSON.parse(JSON.stringify(e))}function Ga(e){Wt()&&In(e)}function qa(e){Wt()?Nn(e):e()}const ho="__CLONE__DRAGGABLE__ELEMENT__NODE__";function Xt(...e){var o,t;const n=(o=Wt())==null?void 0:o.proxy,a=e[0];let[,r,l]=e;Array.isArray(D(r))||(l=r,r=null);let s=null;const{immediate:i=!0,clone:d=za}=(t=D(l))!=null?t:{};function f(b){var T;b.item[ho]=d(D((T=D(r))==null?void 0:T[b.oldIndex]))}function v(b){const T=b.item[ho];ha(T)||(Ct(b.item),fa(D(r),b.newIndex,T))}function h(b){const{from:T,item:K,oldIndex:q,pullMode:V,clone:ee}=b;if(V==="clone"){no(T,K,q),Ct(ee);return}pa(D(r),q)}function m(b){const{from:T,item:K,oldIndex:q,newIndex:V}=b;Ct(K),no(T,K,q),ua(D(r),q,V)}const A={onUpdate:m,onStart:f,onAdd:v,onRemove:h};function S(b){const T=D(a);return b||(b=ma(T)?va(T,n==null?void 0:n.$el):T),b&&!ba(b)&&(b=b.$el),b||sa("Root element not found"),b}function F(){var b;const T=(b=D(l))!=null?b:{},K=wo(T,["immediate","clone"]);return _a(r===null?{}:A,K)}const M=b=>{b=S(b),s&&X.destroy(),s=new k(b,F())};xn(l,()=>{s&&ya(F(),(b,T)=>{s==null||s.option(b,T)})},{deep:!0});const X={option:(b,T)=>s==null?void 0:s.option(b,T),destroy:()=>{s==null||s.destroy(),s=null},save:()=>s==null?void 0:s.save(),toArray:()=>s==null?void 0:s.toArray(),closest:(...b)=>s==null?void 0:s.closest(...b)},j=()=>X==null?void 0:X.option("disabled",!0),se=()=>X==null?void 0:X.option("disabled",!1);return qa(()=>{i&&M()}),Ga(X.destroy),Le({start:M,pause:j,resume:se},X)}const Yt=["update","start","add","remove","choose","unchoose","end","sort","filter","clone","move","change"],Ja=["onUpdate","onStart","onAdd","onRemove","animation","ghostClass","group","sort","disabled","store","handle","draggable","swapThreshold","invertSwap","invertedSwapThreshold","removeCloneOnHide","direction","chosenClass","dragClass","ignore","filter","preventOnFilter","easing","setData","dropBubble","dragoverBubble","dataIdAttr","delay","delayOnTouchOnly","touchStartThreshold","forceFallback","fallbackClass","fallbackOnBody","fallbackTolerance","fallbackOffset","supportPointer","emptyInsertThreshold","scroll","forceAutoScrollFallback","scrollSensitivity","scrollSpeed","bubbleScroll","modelValue","tag","target",...Yt.map(e=>`on${e.replace(/^\S/,o=>o.toUpperCase())}`)],Za=Cn({name:"VueDraggable",model:{prop:"modelValue",event:"update:modelValue"},props:Ja,emits:["update:modelValue",...Yt],setup(e,{slots:o,emit:t,expose:n}){const a=Tn(),r=Yt.reduce((f,v)=>{const h=`on${v.replace(/^\S/,m=>m.toUpperCase())}`;return f[h]=m=>t(v,m),f},{}),l=Jt(()=>{const f=On(e),v=wo(f,["modelValue"]),h=Object.entries(v).reduce((m,[A,S])=>{const F=D(S);return F!==void 0&&(m[A]=F),m},{});return Le(Le({},r),da(Le(Le({},a),h)))}),s=Jt({get:()=>e.modelValue,set:f=>t("update:modelValue",f)}),i=ie(),d=ze(Xt(e.target||i,s,l));return n(d),()=>{if(o.default)return mo(e.tag||"div",{ref:i},o.default(d))}}});const Qa={class:"draggable-item-content"},Ka={key:0},er={key:1},tr={key:2},or={key:3},nr={key:4},ar={key:5},rr={key:0,class:"ui-special-item-container"},lr={__name:"UIDesign",props:{modelValue:{}},emits:["update:modelValue"],setup(e){const o=An(e,"modelValue"),{t}=vo(),n=Pn(o.value),a=ze(n),r=ie(a.inputFields),l=ie(a.outputNodes),s=ie(a.triggerNodes),i=ie([{id:"typography-paragraph",required:!0,placeholder:t("components.workspace.uiDesign.typography-paragraph.placeholder"),show:!1,multiline:!0,value:"",password:!1,name:"typography-paragraph",display_name:"typography-paragraph",type:"str",clear_after_run:!0,list:!1,field_type:"typography-paragraph"}]),d=()=>{o.value.data.ui={inputFields:r.value,outputNodes:l.value}},f=ie(!1),v=ie(),h=ze({animation:150,ghostClass:"ghost",handle:".handle",group:{name:"fields",pull:!1},onStart:()=>{f.value=!0},onAdd:()=>{d()},onEnd:()=>{d(),Zt(()=>{f.value=!1})}});Xt(v,r,h);const m=ie(),A=ze({animation:150,ghostClass:"ghost",handle:".handle",group:{name:"fields",pull:!1},onStart:()=>{f.value=!0},onAdd:()=>{d()},onEnd:()=>{d(),Zt(()=>{f.value=!1})}});Xt(m,l,A);const S=(F,M)=>{F.splice(M,1),d()};return(F,M)=>{const X=x("a-menu-item"),j=x("a-tooltip"),se=x("a-menu"),b=x("a-layout-sider"),T=x("a-typography-title"),K=x("a-select"),q=x("a-textarea"),V=x("a-input"),ee=x("a-input-number"),xe=x("a-checkbox"),N=x("a-form-item"),te=x("a-col"),ne=x("a-row"),ue=x("a-form"),ge=x("a-divider"),ce=x("a-button"),ke=x("a-popconfirm"),Ie=x("a-space"),me=x("cron-ant"),y=x("a-card"),g=x("a-typography-paragraph"),W=x("a-layout-content"),B=x("a-layout"),z=Mn("highlight");return C(),L(B,{class:"ui-design-layout","has-sider":"",style:{height:"100%","min-height":"calc(100vh - 40px - 40px)"}},{default:_(()=>[p(b,{style:{overflow:"auto",backgroundColor:"#fff"},class:"custom-scrollbar"},{default:_(()=>[p(se,{theme:"light",mode:"inline",ref:"siderMenu"},{default:_(()=>[p(D(Za),{modelValue:i.value,"onUpdate:modelValue":M[0]||(M[0]=u=>i.value=u),animation:"150",group:{name:"fields",pull:"clone",put:!1},sort:!1},{default:_(()=>[(C(!0),Z(Re,null,We(i.value,(u,de)=>(C(),L(j,{key:`node-${de}`,title:D(t)(`components.workspace.uiDesign.${u.name}.tip`),placement:"right"},{default:_(()=>[p(X,{class:"draggable-menu-item",id:u.id},{default:_(()=>[p(D(xt)),Fe("span",null,Q(D(t)(`components.workspace.uiDesign.${u.name}.title`)),1)]),_:2},1032,["id"])]),_:2},1032,["title"]))),128))]),_:1},8,["modelValue"])]),_:1},512)]),_:1}),p(B,{style:{"background-color":"#fff"}},{default:_(()=>[p(W,{style:{margin:"24px 16px 0",overflow:"initial"}},{default:_(()=>[p(ne,{gutter:[16,16]},{default:_(()=>[p(te,{xxl:6,xl:8,lg:10,md:24},{default:_(()=>[p(ne,{gutter:[16,16]},{default:_(()=>[p(T,{level:3},{default:_(()=>[p(D(Gn),{class:"text-primary"}),re(" "+Q(D(t)("workspace.workflowSpace.inputs")),1)]),_:1}),p(te,{span:24},{default:_(()=>[p(ue,{layout:"vertical",ref_key:"inputFieldsEl",ref:v},{default:_(()=>[(C(!0),Z(Re,null,We(r.value,(u,de)=>(C(),Z("div",{class:"draggable-item",key:`field-${u}-${de}`},[p(D(xt),{class:"handle"}),D(Un).includes(u.field_type)?Xe("",!0):(C(),L(N,{key:0,class:"draggable-item-content"},{label:_(()=>[re(Q(u.display_name),1)]),default:_(()=>[u.category=="llms"&&u=="temperature"?(C(),L(ta,{key:0,modelValue:u.value,"onUpdate:modelValue":P=>u.value=P},null,8,["modelValue","onUpdate:modelValue"])):u.field_type=="select"?(C(),L(K,{key:1,value:u.value,"onUpdate:value":P=>u.value=P,options:u.options},null,8,["value","onUpdate:value","options"])):u.field_type=="textarea"?(C(),L(q,{key:2,value:u.value,"onUpdate:value":P=>u.value=P,autoSize:!0,showCount:!0,placeholder:u.placeholder},null,8,["value","onUpdate:value","placeholder"])):u.field_type=="input"?(C(),L(V,{key:3,value:u.value,"onUpdate:value":P=>u.value=P,placeholder:u.placeholder},null,8,["value","onUpdate:value","placeholder"])):u.field_type=="number"?(C(),L(ee,{key:4,value:u.value,"onUpdate:value":P=>u.value=P,placeholder:u.placeholder},null,8,["value","onUpdate:value","placeholder"])):u.field_type=="checkbox"?(C(),L(xe,{key:5,checked:u.value,"onUpdate:checked":P=>u.value=P},null,8,["checked","onUpdate:checked"])):u.field_type=="file"?(C(),L(go,{key:6,modelValue:u.value,"onUpdate:modelValue":P=>u.value=P},null,8,["modelValue","onUpdate:modelValue"])):u.field_type=="list"?(C(),L(Jn,{key:7,modelValue:u.value,"onUpdate:modelValue":P=>u.value=P},null,8,["modelValue","onUpdate:modelValue"])):Xe("",!0)]),_:2},1024)),u.field_type=="typography-paragraph"?(C(),L(ne,{key:1,class:"draggable-item-content"},{default:_(()=>[p(te,{span:24,class:"ui-special-item-container"},{default:_(()=>[p(q,{class:"ui-special-item",value:u.value,"onUpdate:value":P=>u.value=P,placeholder:u.placeholder,"auto-size":"",onChange:d},null,8,["value","onUpdate:value","placeholder"]),p(D(Qt),{class:"ui-special-item-delete",onClick:P=>S(r.value,de)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)):Xe("",!0)]))),128))]),_:1},512)]),_:1}),p(ge),p(te,{span:24},{default:_(()=>[p(ne,{gutter:[16,16]},{default:_(()=>[(C(!0),Z(Re,null,We(s.value,u=>(C(),L(te,{key:`node-${u.id}`,span:24},{default:_(()=>[u.type=="ButtonTrigger"?(C(),L(ce,{key:0,type:"primary",block:""},{default:_(()=>[re(Q(u.data.template.button_text.value),1)]),_:2},1024)):u.type=="ScheduleTrigger"?(C(),L(y,{key:1,title:D(t)("components.nodes.triggers.ScheduleTrigger.schedule_settings")},{extra:_(()=>[p(Ie,null,{default:_(()=>[p(ce,{type:"primary"},{default:_(()=>[re(Q(D(t)("components.nodes.triggers.ScheduleTrigger.save_schedule_settings")),1)]),_:1}),p(ke,{title:D(t)("workspace.workflowSpace.delete_schedule_trigger_confirm")},{default:_(()=>[p(ce,{type:"primary",danger:""},{default:_(()=>[re(Q(D(t)("workspace.workflowSpace.delete")),1)]),_:1})]),_:1},8,["title"])]),_:1})]),default:_(()=>[p(me,{modelValue:u.data.template.schedule.value,"onUpdate:modelValue":de=>u.data.template.schedule.value=de,"button-props":{type:"primary",shape:"round"},locale:F.language},null,8,["modelValue","onUpdate:modelValue","locale"])]),_:2},1032,["title"])):Xe("",!0)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1}),p(te,{xxl:18,xl:16,lg:14,md:24},{default:_(()=>[p(T,{level:3,style:{display:"flex","justify-content":"space-between"}},{default:_(()=>[Fe("span",null,[p(D(qn),{class:"text-primary"}),re(" "+Q(D(t)("workspace.workflowSpace.outputs")),1)])]),_:1}),p(ne,{gutter:[16,16],ref_key:"outputNodesEl",ref:m},{default:_(()=>[(C(!0),Z(Re,null,We(l.value,(u,de)=>(C(),L(te,{span:24,class:"draggable-item",key:`node-${u.id}-${de}`},{default:_(()=>{var P;return[p(D(xt),{class:"handle"}),Fe("div",Qa,[u.type=="Text"?(C(),Z("div",Ka,[p(T,{level:5},{default:_(()=>[re(Q(u.data.template.output_title.value),1)]),_:2},1024),u.data.template.render_markdown.value?(C(),Z(Re,{key:0},[Rt(p(D(Vn),{source:u.data.template.text.value,class:"markdown-body custom-hljs"},null,8,["source"]),[[z]]),p(g,{copyable:{text:u.data.template.text.value}},null,8,["copyable"])],64)):(C(),L(g,{key:1,copyable:{text:u.data.template.text.value}},{default:_(()=>[re(Q(u.data.template.text.value),1)]),_:2},1032,["copyable"]))])):u.type=="Audio"?(C(),Z("div",er,[p(Zn,{audios:[(P=u.data.template.audio_url)==null?void 0:P.value]},null,8,["audios"])])):u.type=="Mindmap"?(C(),Z("div",tr,[p(Qn,{content:u.data.template.content.value,style:{width:"100%","min-height":"50vh"}},null,8,["content"])])):u.type=="Mermaid"?(C(),Z("div",or,[p(Kn,{content:u.data.template.content.value,style:{width:"100%","min-height":"50vh"}},null,8,["content"])])):u.type=="Echarts"?(C(),Z("div",nr,[p(ea,{option:u.data.template.option.value,style:{width:"100%","min-height":"50vh"}},null,8,["option"])])):(C(),Z("div",ar,[u.field_type=="typography-paragraph"?(C(),Z("div",rr,[p(q,{class:"ui-special-item",value:u.value,"onUpdate:value":Ne=>u.value=Ne,placeholder:u.placeholder,"auto-size":"",onChange:d},null,8,["value","onUpdate:value","placeholder"]),p(D(Qt),{class:"ui-special-item-delete",onClick:Ne=>S(l.value,de)},null,8,["onClick"])])):Xe("",!0)]))])]}),_:2},1024))),128))]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}},ir=_o(lr,[["__scopeId","data-v-01ce6c33"]]);const sr={key:0,class:"loading-container"},ur={key:1,class:"editor-container"},cr={class:"title-container"},dr=["data-node-type"],pr={__name:"WorkflowEditor",setup(e){const{t:o}=vo(),t=ie(!0),n=Rn(),a=Fn(),r=n.params.workflowId,l=ie(o("workspace.workflowEditor.workflow_canvas")),s=ze([o("workspace.workflowEditor.workflow_info"),o("workspace.workflowEditor.workflow_canvas"),o("workspace.workflowEditor.workflow_ui_design")]),i=Hn(),{userDatabases:d}=jn(i),f=Bn(),v=ie(""),h=ie({}),m=ie([]);$n(async()=>{const y=Kt("get",{wid:r}),g=oa("list",{}),W=await y,B=await g;if(B.status==200&&i.setUserDatabases(B.data),W.status!=200){St.error(o("workspace.workflowSpace.get_workflow_failed")),a.push({name:"WorkflowSpaceMain"});return}h.value=W.data,h.value.data.nodes.forEach(z=>{z.category=="vectorDb"&&(z.data.template.database.options=d.value.filter(u=>u.status=="VALID").map(u=>({value:u.vid,label:u.name})))}),h.value.tags=h.value.tags.map(z=>z.tid),m.value=[...h.value.data.nodes,...h.value.data.edges],m.value.forEach(z=>{z.events={change:u=>V(),delete:u=>ee(u)}}),v.value=it(h.value),t.value=!1});const A=()=>{const y=b();h.value.data={...y,ui:h.value.data.ui||{}}},S=ie(!1),F=async()=>{S.value=!0;const y=h.value.data.ui||{},g=b();h.value.data={...g,ui:y},(await Kt("update",{wid:r,...h.value})).status==200?(St.success(o("workspace.workflowSpace.save_success")),v.value=it(h.value)):St.error(o("workspace.workflowSpace.save_failed")),f.updateUserWorkflow(h.value),S.value=!1},M=()=>{const y=h.value.data.ui||{},g=b();h.value.data={...g,ui:y},v.value!=it(h.value)?Wn.confirm({title:o("common.back"),icon:mo(Ln),content:o("workspace.workflowEditor.exit_not_saved_confirm"),okText:o("workspace.workflowEditor.save_and_exit"),cancelText:o("workspace.workflowEditor.exit_without_save"),onOk(){F().then(()=>{a.push({name:"WorkflowUse",params:{workflowId:r}})})},onCancel(){a.push({name:"WorkflowUse",params:{workflowId:r}})}}):a.push({name:"WorkflowUse",params:{workflowId:r}})},{addEdges:X,updateEdge:j,onConnect:se,toObject:b,viewport:T,vueFlowRef:K}=$o();se(y=>{y.animated=!0,y.style={strokeWidth:3,stroke:"#565656"},X([y])});const q=({edge:y,connection:g})=>{j(y,g)},V=y=>{},ee=y=>{m.value=m.value.filter(g=>g.id!==y.id),m.value=m.value.filter(g=>!(g.source&&g.source===y.id||g.target&&g.target===y.id))},xe=y=>{m.value=m.value.filter(g=>!(g.source===y.edge.source&&g.target===y.edge.target&&g.sourceHandle===y.edge.sourceHandle&&g.targetHandle===y.edge.targetHandle))};let N;const te=y=>{N&&document.body.removeChild(N);let g=y.target.getBoundingClientRect();N=y.target.cloneNode(!0),N.style.position="absolute",N.style.top=g.top+"px",N.style.left=g.left+"px",N.style.width=g.width+"px",N.style.height=g.height+"px",N.style.opacity="0.5",N.style.zIndex="1000",document.body.appendChild(N)},ne=y=>{N&&(N.style.left=y.touches[0].clientX+"px",N.style.top=y.touches[0].clientY+"px")},ue=y=>{N&&(document.body.removeChild(N),N=null);let g=y.srcElement.dataset.nodeType;g||(g=y.srcElement.children[0].dataset.nodeType);const W=Ie[g],B=En(),z=JSON.parse(JSON.stringify(ce[g].props.templateData));z.description=o(`components.nodes.${W}.${g}.description`),Object.keys(z.template).forEach(Pe=>{z.template[Pe].display_name=o(`components.nodes.${W}.${g}.${Pe}`)});const u=K.value.getBoundingClientRect(),{x:de,y:P,zoom:Ne}=T.value;let je=0,Ae=0;y.type=="touchend"?(je=y.changedTouches[0].clientX-u.left,Ae=y.changedTouches[0].clientY-u.top):(je=y.clientX-u.left,Ae=y.clientY-u.top);const Et={id:B,type:g,category:W,position:{x:(je-de)/Ne,y:(Ae-P)/Ne},data:z,events:{change:Pe=>V(),delete:Pe=>ee(Pe)}};m.value.push(Et)},ge=Object.assign({"/src/components/nodes/controlFlows/Conditional.vue":Xo,"/src/components/nodes/controlFlows/Empty.vue":Yo,"/src/components/nodes/controlFlows/RandomChoice.vue":Wo,"/src/components/nodes/fileProcessing/FileLoader.vue":Lo,"/src/components/nodes/imageGeneration/StableDiffusion.vue":Ho,"/src/components/nodes/llms/ChatGLM.vue":zo,"/src/components/nodes/llms/OpenAI.vue":Go,"/src/components/nodes/outputs/Document.vue":qo,"/src/components/nodes/outputs/Echarts.vue":Jo,"/src/components/nodes/outputs/Email.vue":Zo,"/src/components/nodes/outputs/Mermaid.vue":Qo,"/src/components/nodes/outputs/Mindmap.vue":Ko,"/src/components/nodes/outputs/Text.vue":en,"/src/components/nodes/textProcessing/ListRender.vue":tn,"/src/components/nodes/textProcessing/MarkdownToHtml.vue":on,"/src/components/nodes/textProcessing/TemplateCompose.vue":nn,"/src/components/nodes/textProcessing/TextInOut.vue":an,"/src/components/nodes/textProcessing/TextSplitters.vue":rn,"/src/components/nodes/textProcessing/TextTruncation.vue":ln,"/src/components/nodes/tools/ImageSearch.vue":sn,"/src/components/nodes/tools/ProgrammingFunction.vue":un,"/src/components/nodes/triggers/ButtonTrigger.vue":cn,"/src/components/nodes/vectorDb/AddData.vue":dn,"/src/components/nodes/vectorDb/DeleteData.vue":pn,"/src/components/nodes/vectorDb/Search.vue":fn,"/src/components/nodes/webCrawlers/BilibiliCrawler.vue":hn,"/src/components/nodes/webCrawlers/TextCrawler.vue":mn,"/src/components/nodes/webCrawlers/YoutubeCrawler.vue":vn}),ce={},ke={},Ie={};Object.entries(ge).forEach(([y,g])=>{const W=y.match(/\/([^/]+)\.vue$/)[1];ce[W]=Xn(g.default);const B=y.match(/\/([^/]+)\/[^/]+\.vue$/)[1];ke[B]||(ke[B]=[]),ke[B].push(W),Ie[W]=B});const me=ze({open:!1,code:"",openEditor:async()=>{let y=b();y.ui=h.value.data.ui||{},me.code=JSON.stringify(y,null,2),me.open=!0},updateCode:y=>{const g=JSON.parse(y);h.value.data.ui=g.ui||{},m.value=[...g.nodes,...g.edges],m.value.forEach(W=>{W.events={change:B=>V(),delete:B=>ee(B)}}),h.value.data.nodes=g.nodes,h.value.data.edges=g.edges,h.value.data.nodes.forEach(W=>{W.category=="vectorDb"&&(W.data.template.database.options=d.value.filter(B=>B.status=="VALID").map(B=>({value:B.vid,label:B.name})))}),v.value=it(h.value)}});return(y,g)=>{const W=x("a-spin"),B=x("a-typography-link"),z=x("a-col"),u=x("a-typography-text"),de=x("a-segmented"),P=x("a-button"),Ne=x("a-space"),je=x("a-row"),Ae=x("a-divider"),Et=x("a-menu-item"),Pe=x("a-sub-menu"),Vo=x("a-menu"),Ro=x("a-layout-sider"),Fo=x("a-layout-content"),qt=x("a-layout");return t.value?(C(),Z("div",sr,[p(W,{size:"large"})])):(C(),Z("div",ur,[Fe("div",cr,[p(je,{type:"flex",align:"middle",justify:"space-between",gutter:[16,16],style:{width:"100%"}},{default:_(()=>[p(z,{flex:"0 0"},{default:_(()=>[p(B,{onClick:M,style:{"text-wrap":"nowrap"}},{default:_(()=>[p(D(Yn)),re(" "+Q(D(o)("common.back")),1)]),_:1})]),_:1}),p(z,{flex:"0 0"},{default:_(()=>[p(u,{class:"title",editable:{triggerType:["text","icon"]},content:h.value.title,"onUpdate:content":g[0]||(g[0]=Y=>h.value.title=Y)},null,8,["content"])]),_:1}),p(z,{flex:"1 0",style:{display:"flex","justify-content":"center"}},{default:_(()=>[p(de,{value:l.value,"onUpdate:value":g[1]||(g[1]=Y=>l.value=Y),options:s,onChange:A},null,8,["value","options"])]),_:1}),p(z,{flex:"0 0",style:{display:"flex","justify-content":"end"}},{default:_(()=>[p(Ne,null,{default:_(()=>[p(P,{onClick:me.openEditor},{default:_(()=>[re(Q(D(o)("workspace.workflowEditor.edit_code"))+" ",1),p(gn,{language:"json",open:me.open,"onUpdate:open":g[2]||(g[2]=Y=>me.open=Y),code:me.code,"onUpdate:code":g[3]||(g[3]=Y=>me.code=Y),onSave:me.updateCode},null,8,["open","code","onSave"])]),_:1},8,["onClick"]),p(P,{type:"primary",onClick:F,"confirm-loading":S.value},{default:_(()=>[re(Q(D(o)("common.save")),1)]),_:1},8,["confirm-loading"])]),_:1})]),_:1})]),_:1})]),Rt(Fe("div",null,[p(je,{justify:"center"},{default:_(()=>[p(z,{lg:10,md:12,sm:18,xs:24},{default:_(()=>[p(Ae,null,{default:_(()=>[re(Q(D(o)("workspace.workflowEditor.tags")),1)]),_:1}),p(_n,{modelValue:h.value.tags,"onUpdate:modelValue":g[4]||(g[4]=Y=>h.value.tags=Y)},null,8,["modelValue"]),p(Ae,null,{default:_(()=>[re(Q(D(o)("workspace.workflowEditor.brief_info")),1)]),_:1}),p(zn,{markdown:h.value.brief,"onUpdate:markdown":g[5]||(g[5]=Y=>h.value.brief=Y)},null,8,["markdown"]),p(Ae,null,{default:_(()=>[re(Q(D(o)("workspace.workflowEditor.brief_images")),1)]),_:1}),Fe("div",null,[p(go,{modelValue:h.value.images,"onUpdate:modelValue":g[6]||(g[6]=Y=>h.value.images=Y),multiple:!0},null,8,["modelValue"])])]),_:1})]),_:1})],512),[[eo,l.value==D(o)("workspace.workflowEditor.workflow_info")]]),Rt(p(qt,{"has-sider":"",style:{height:"100%"}},{default:_(()=>[p(Ro,{style:{overflow:"auto",backgroundColor:"#fff"},class:"custom-scrollbar"},{default:_(()=>[p(Vo,{theme:"light",mode:"inline"},{default:_(()=>[(C(!0),Z(Re,null,We(Object.keys(ke),(Y,jo)=>(C(),L(Pe,{key:`category-${jo}`},{title:_(()=>[re(Q(D(o)(`components.nodes.${Y}.title`)),1)]),default:_(()=>[(C(!0),Z(Re,null,We(ke[Y],(lt,Bo)=>(C(),L(Et,{"data-node-type":lt,id:lt,draggable:"true",onTouchstart:te,onTouchmove:ne,onDragend:ue,onTouchend:ue,key:`node-${Bo}`},{default:_(()=>[Fe("span",{"data-node-type":lt},Q(D(o)(`components.nodes.${Y}.${lt}.title`)),9,dr)]),_:2},1032,["data-node-type","id"]))),128))]),_:2},1024))),128))]),_:1})]),_:1}),p(qt,null,{default:_(()=>[p(Fo,{style:{margin:"24px 16px 0",overflow:"initial"}},{default:_(()=>[p(D(bn),{modelValue:m.value,"onUpdate:modelValue":g[7]||(g[7]=Y=>m.value=Y),"default-edge-options":{type:"smoothstep"},"node-types":ce,edgesUpdatable:!0,onEdgeUpdate:q,onEdgeDoubleClick:xe,"snap-to-grid":!0,"snap-grid":[20,20]},{default:_(()=>[p(D(yn)),p(D(wn)),p(D(kn),{variant:D(Dn).Dots},null,8,["variant"])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},512),[[eo,l.value==D(o)("workspace.workflowEditor.workflow_canvas")]]),l.value==D(o)("workspace.workflowEditor.workflow_ui_design")?(C(),L(ir,{key:0,modelValue:h.value,"onUpdate:modelValue":g[8]||(g[8]=Y=>h.value=Y)},null,8,["modelValue"])):Xe("",!0)]))}}},Sr=_o(pr,[["__scopeId","data-v-6e3384ce"]]);export{Sr as default};
