import{u as tn,v as on,_ as nn,a as an,b as ln,c as rn,d as sn,e as un,f as cn,g as dn,h as pn,i as fn,j as mn,k as vn,l as hn,m as gn,n as _n,o as yn,p as bn,q as wn,r as kn,s as Sn,t as En,w as Dn,x as xn,y as Cn,z as Tn,A as On,B as In,C as Nn,D as An,E as Pn,F as Mn,G as Vn,H as Fn,I as Un,J as Rn,K as jn,L as $n,M as Bn,N as uo}from"./style-b9dca4a2.js";import{c as u,A as Xn,g as to,u as g,w as Oo,d as Yn,a as Ln,b as co,t as Wn,r as ne,e as He,h as Hn,o as zn,f as Gn,i as Io,j as oo,k as qn,n as po,l as E,m as Jn,p as T,q as G,s as p,v as Z,x as Ye,F as Oe,y as j,z as U,B as Fe,C as Zn,D as Be,E as fo,G as Gt,V as Qn,H as Kn,I as ea,J as ta,K as Ft,L as oa,M as na,N as aa,O as mo,P as vt,Q as ht,R as la,S as vo,T as ra,U as ia,W as sa}from"./index-3411169e.js";import{u as ua}from"./userDatabase-71a77a8c.js";import{_ as ca}from"./MarkdownEditor-58992759.js";import{_ as No}from"./UploaderFieldUse-5c982463.js";import{F as da,T as pa,_ as fa,a as ma,b as va,c as ha,d as ga}from"./EchartsRenderer-b539a70e.js";import{_ as _a}from"./TemperatureInput-16c9500b.js";import{_ as no}from"./_plugin-vue_export-helper-c27b6911.js";import{d as ya}from"./database-307146de.js";import"./AddOne-92ce1b86.js";import"./QuestionPopover-b73d95e6.js";import"./stringify-ec884b6d.js";var ba={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.3 506.3L781.7 405.6a7.23 7.23 0 00-11.7 5.7V476H548V254h64.8c6 0 9.4-7 5.7-11.7L517.7 114.7a7.14 7.14 0 00-11.3 0L405.6 242.3a7.23 7.23 0 005.7 11.7H476v222H254v-64.8c0-6-7-9.4-11.7-5.7L114.7 506.3a7.14 7.14 0 000 11.3l127.5 100.8c4.7 3.7 11.7.4 11.7-5.7V548h222v222h-64.8c-6 0-9.4 7-5.7 11.7l100.8 127.5c2.9 3.7 8.5 3.7 11.3 0l100.8-127.5c3.7-4.7.4-11.7-5.7-11.7H548V548h222v64.8c0 6 7 9.4 11.7 5.7l127.5-100.8a7.3 7.3 0 00.1-11.4z"}}]},name:"drag",theme:"outlined"};const wa=ba;function ho(e){for(var o=1;o<arguments.length;o++){var t=arguments[o]!=null?Object(arguments[o]):{},n=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable}))),n.forEach(function(a){ka(e,a,t[a])})}return e}function ka(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}var ao=function(o,t){var n=ho({},o,t.attrs);return u(Xn,ho({},n,{icon:wa}),null)};ao.displayName="DragOutlined";ao.inheritAttrs=!1;const Ut=ao;var Sa=Object.defineProperty,xt=Object.getOwnPropertySymbols,Ao=Object.prototype.hasOwnProperty,Po=Object.prototype.propertyIsEnumerable,go=(e,o,t)=>o in e?Sa(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t,Le=(e,o)=>{for(var t in o||(o={}))Ao.call(o,t)&&go(e,t,o[t]);if(xt)for(var t of xt(o))Po.call(o,t)&&go(e,t,o[t]);return e},Mo=(e,o)=>{var t={};for(var n in e)Ao.call(e,n)&&o.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&xt)for(var n of xt(e))o.indexOf(n)<0&&Po.call(e,n)&&(t[n]=e[n]);return t};const Vo="[vue-draggable-plus]: ";function Ea(e){console.warn(Vo+e)}function Da(e){console.error(Vo+e)}function xa(e,o,t){Array.isArray(e)&&t>=0&&t<e.length&&e.splice(t,0,e.splice(o,1)[0])}function Ca(e){return e.replace(/-(\w)/g,(o,t)=>t?t.toUpperCase():"")}function Ta(e){return Object.keys(e).reduce((o,t)=>(typeof e[t]<"u"&&(o[Ca(t)]=e[t]),o),{})}function Oa(e,o){if(Array.isArray(e))return e.splice(o,1)}function Ia(e,o,t){if(Array.isArray(e))return e.splice(o,0,t)}function Na(e){return typeof e>"u"}function Aa(e){return typeof e=="string"}function _o(e,o,t){const n=e.children[t];e.insertBefore(o,n)}function Rt(e){e.parentNode&&e.parentNode.removeChild(e)}function Pa(e,o=document){var t;let n=null;return typeof(o==null?void 0:o.querySelector)=="function"?n=(t=o==null?void 0:o.querySelector)==null?void 0:t.call(o,e):n=document.querySelector(e),n||Ea(`Element not found: ${e}`),n}function Ma(e,o,t=null){return function(...n){return e.apply(t,n),o.apply(t,n)}}function Va(e,o){const t=Le({},e);return Object.keys(o).forEach(n=>{t[n]?t[n]=Ma(e[n],o[n]):t[n]=o[n]}),t}function Fa(e){return e instanceof HTMLElement}function Ua(e,o){Object.keys(e).forEach(t=>{o(t,e[t])})}/**!
 * Sortable 1.15.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function yo(e,o){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);o&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function ke(e){for(var o=1;o<arguments.length;o++){var t=arguments[o]!=null?arguments[o]:{};o%2?yo(Object(t),!0).forEach(function(n){Ra(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):yo(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function wt(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?wt=function(o){return typeof o}:wt=function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},wt(e)}function Ra(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}function Ee(){return Ee=Object.assign||function(e){for(var o=1;o<arguments.length;o++){var t=arguments[o];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Ee.apply(this,arguments)}function ja(e,o){if(e==null)return{};var t={},n=Object.keys(e),a,l;for(l=0;l<n.length;l++)a=n[l],!(o.indexOf(a)>=0)&&(t[a]=e[a]);return t}function $a(e,o){if(e==null)return{};var t=ja(e,o),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(o.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(t[n]=e[n])}return t}var Ba="1.15.0";function Se(e){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(e)}var De=Se(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),st=Se(/Edge/i),bo=Se(/firefox/i),nt=Se(/safari/i)&&!Se(/chrome/i)&&!Se(/android/i),Fo=Se(/iP(ad|od|hone)/i),Uo=Se(/chrome/i)&&Se(/android/i),Ro={capture:!1,passive:!1};function A(e,o,t){e.addEventListener(o,t,!De&&Ro)}function N(e,o,t){e.removeEventListener(o,t,!De&&Ro)}function Ct(e,o){if(o){if(o[0]===">"&&(o=o.substring(1)),e)try{if(e.matches)return e.matches(o);if(e.msMatchesSelector)return e.msMatchesSelector(o);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(o)}catch{return!1}return!1}}function Xa(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function be(e,o,t,n){if(e){t=t||document;do{if(o!=null&&(o[0]===">"?e.parentNode===t&&Ct(e,o):Ct(e,o))||n&&e===t)return e;if(e===t)break}while(e=Xa(e))}return null}var wo=/\s+/g;function pe(e,o,t){if(e&&o)if(e.classList)e.classList[t?"add":"remove"](o);else{var n=(" "+e.className+" ").replace(wo," ").replace(" "+o+" "," ");e.className=(n+(t?" "+o:"")).replace(wo," ")}}function w(e,o,t){var n=e&&e.style;if(n){if(t===void 0)return document.defaultView&&document.defaultView.getComputedStyle?t=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(t=e.currentStyle),o===void 0?t:t[o];!(o in n)&&o.indexOf("webkit")===-1&&(o="-webkit-"+o),n[o]=t+(typeof t=="string"?"":"px")}}function ze(e,o){var t="";if(typeof e=="string")t=e;else do{var n=w(e,"transform");n&&n!=="none"&&(t=n+" "+t)}while(!o&&(e=e.parentNode));var a=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return a&&new a(t)}function jo(e,o,t){if(e){var n=e.getElementsByTagName(o),a=0,l=n.length;if(t)for(;a<l;a++)t(n[a],a);return n}return[]}function we(){var e=document.scrollingElement;return e||document.documentElement}function J(e,o,t,n,a){if(!(!e.getBoundingClientRect&&e!==window)){var l,r,s,i,d,f,h;if(e!==window&&e.parentNode&&e!==we()?(l=e.getBoundingClientRect(),r=l.top,s=l.left,i=l.bottom,d=l.right,f=l.height,h=l.width):(r=0,s=0,i=window.innerHeight,d=window.innerWidth,f=window.innerHeight,h=window.innerWidth),(o||t)&&e!==window&&(a=a||e.parentNode,!De))do if(a&&a.getBoundingClientRect&&(w(a,"transform")!=="none"||t&&w(a,"position")!=="static")){var D=a.getBoundingClientRect();r-=D.top+parseInt(w(a,"border-top-width")),s-=D.left+parseInt(w(a,"border-left-width")),i=r+l.height,d=s+l.width;break}while(a=a.parentNode);if(n&&e!==window){var _=ze(a||e),M=_&&_.a,x=_&&_.d;_&&(r/=x,s/=M,h/=M,f/=x,i=r+f,d=s+h)}return{top:r,left:s,bottom:i,right:d,width:h,height:f}}}function ko(e,o,t){for(var n=Ne(e,!0),a=J(e)[o];n;){var l=J(n)[t],r=void 0;if(t==="top"||t==="left"?r=a>=l:r=a<=l,!r)return n;if(n===we())break;n=Ne(n,!1)}return!1}function Ge(e,o,t,n){for(var a=0,l=0,r=e.children;l<r.length;){if(r[l].style.display!=="none"&&r[l]!==k.ghost&&(n||r[l]!==k.dragged)&&be(r[l],t.draggable,e,!1)){if(a===o)return r[l];a++}l++}return null}function lo(e,o){for(var t=e.lastElementChild;t&&(t===k.ghost||w(t,"display")==="none"||o&&!Ct(t,o));)t=t.previousElementSibling;return t||null}function he(e,o){var t=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)e.nodeName.toUpperCase()!=="TEMPLATE"&&e!==k.clone&&(!o||Ct(e,o))&&t++;return t}function So(e){var o=0,t=0,n=we();if(e)do{var a=ze(e),l=a.a,r=a.d;o+=e.scrollLeft*l,t+=e.scrollTop*r}while(e!==n&&(e=e.parentNode));return[o,t]}function Ya(e,o){for(var t in e)if(e.hasOwnProperty(t)){for(var n in o)if(o.hasOwnProperty(n)&&o[n]===e[t][n])return Number(t)}return-1}function Ne(e,o){if(!e||!e.getBoundingClientRect)return we();var t=e,n=!1;do if(t.clientWidth<t.scrollWidth||t.clientHeight<t.scrollHeight){var a=w(t);if(t.clientWidth<t.scrollWidth&&(a.overflowX=="auto"||a.overflowX=="scroll")||t.clientHeight<t.scrollHeight&&(a.overflowY=="auto"||a.overflowY=="scroll")){if(!t.getBoundingClientRect||t===document.body)return we();if(n||o)return t;n=!0}}while(t=t.parentNode);return we()}function La(e,o){if(e&&o)for(var t in o)o.hasOwnProperty(t)&&(e[t]=o[t]);return e}function jt(e,o){return Math.round(e.top)===Math.round(o.top)&&Math.round(e.left)===Math.round(o.left)&&Math.round(e.height)===Math.round(o.height)&&Math.round(e.width)===Math.round(o.width)}var at;function $o(e,o){return function(){if(!at){var t=arguments,n=this;t.length===1?e.call(n,t[0]):e.apply(n,t),at=setTimeout(function(){at=void 0},o)}}}function Wa(){clearTimeout(at),at=void 0}function Bo(e,o,t){e.scrollLeft+=o,e.scrollTop+=t}function Xo(e){var o=window.Polymer,t=window.jQuery||window.Zepto;return o&&o.dom?o.dom(e).cloneNode(!0):t?t(e).clone(!0)[0]:e.cloneNode(!0)}var me="Sortable"+new Date().getTime();function Ha(){var e=[],o;return{captureAnimationState:function(){if(e=[],!!this.options.animation){var t=[].slice.call(this.el.children);t.forEach(function(n){if(!(w(n,"display")==="none"||n===k.ghost)){e.push({target:n,rect:J(n)});var a=ke({},e[e.length-1].rect);if(n.thisAnimationDuration){var l=ze(n,!0);l&&(a.top-=l.f,a.left-=l.e)}n.fromRect=a}})}},addAnimationState:function(t){e.push(t)},removeAnimationState:function(t){e.splice(Ya(e,{target:t}),1)},animateAll:function(t){var n=this;if(!this.options.animation){clearTimeout(o),typeof t=="function"&&t();return}var a=!1,l=0;e.forEach(function(r){var s=0,i=r.target,d=i.fromRect,f=J(i),h=i.prevFromRect,D=i.prevToRect,_=r.rect,M=ze(i,!0);M&&(f.top-=M.f,f.left-=M.e),i.toRect=f,i.thisAnimationDuration&&jt(h,f)&&!jt(d,f)&&(_.top-f.top)/(_.left-f.left)===(d.top-f.top)/(d.left-f.left)&&(s=Ga(_,h,D,n.options)),jt(f,d)||(i.prevFromRect=d,i.prevToRect=f,s||(s=n.options.animation),n.animate(i,_,f,s)),s&&(a=!0,l=Math.max(l,s),clearTimeout(i.animationResetTimer),i.animationResetTimer=setTimeout(function(){i.animationTime=0,i.prevFromRect=null,i.fromRect=null,i.prevToRect=null,i.thisAnimationDuration=null},s),i.thisAnimationDuration=s)}),clearTimeout(o),a?o=setTimeout(function(){typeof t=="function"&&t()},l):typeof t=="function"&&t(),e=[]},animate:function(t,n,a,l){if(l){w(t,"transition",""),w(t,"transform","");var r=ze(this.el),s=r&&r.a,i=r&&r.d,d=(n.left-a.left)/(s||1),f=(n.top-a.top)/(i||1);t.animatingX=!!d,t.animatingY=!!f,w(t,"transform","translate3d("+d+"px,"+f+"px,0)"),this.forRepaintDummy=za(t),w(t,"transition","transform "+l+"ms"+(this.options.easing?" "+this.options.easing:"")),w(t,"transform","translate3d(0,0,0)"),typeof t.animated=="number"&&clearTimeout(t.animated),t.animated=setTimeout(function(){w(t,"transition",""),w(t,"transform",""),t.animated=!1,t.animatingX=!1,t.animatingY=!1},l)}}}}function za(e){return e.offsetWidth}function Ga(e,o,t,n){return Math.sqrt(Math.pow(o.top-e.top,2)+Math.pow(o.left-e.left,2))/Math.sqrt(Math.pow(o.top-t.top,2)+Math.pow(o.left-t.left,2))*n.animation}var je=[],$t={initializeByDefault:!0},ut={mount:function(e){for(var o in $t)$t.hasOwnProperty(o)&&!(o in e)&&(e[o]=$t[o]);je.forEach(function(t){if(t.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),je.push(e)},pluginEvent:function(e,o,t){var n=this;this.eventCanceled=!1,t.cancel=function(){n.eventCanceled=!0};var a=e+"Global";je.forEach(function(l){o[l.pluginName]&&(o[l.pluginName][a]&&o[l.pluginName][a](ke({sortable:o},t)),o.options[l.pluginName]&&o[l.pluginName][e]&&o[l.pluginName][e](ke({sortable:o},t)))})},initializePlugins:function(e,o,t,n){je.forEach(function(r){var s=r.pluginName;if(!(!e.options[s]&&!r.initializeByDefault)){var i=new r(e,o,e.options);i.sortable=e,i.options=e.options,e[s]=i,Ee(t,i.defaults)}});for(var a in e.options)if(e.options.hasOwnProperty(a)){var l=this.modifyOption(e,a,e.options[a]);typeof l<"u"&&(e.options[a]=l)}},getEventProperties:function(e,o){var t={};return je.forEach(function(n){typeof n.eventProperties=="function"&&Ee(t,n.eventProperties.call(o[n.pluginName],e))}),t},modifyOption:function(e,o,t){var n;return je.forEach(function(a){e[a.pluginName]&&a.optionListeners&&typeof a.optionListeners[o]=="function"&&(n=a.optionListeners[o].call(e[a.pluginName],t))}),n}};function qa(e){var o=e.sortable,t=e.rootEl,n=e.name,a=e.targetEl,l=e.cloneEl,r=e.toEl,s=e.fromEl,i=e.oldIndex,d=e.newIndex,f=e.oldDraggableIndex,h=e.newDraggableIndex,D=e.originalEvent,_=e.putSortable,M=e.extraEventProperties;if(o=o||t&&t[me],!!o){var x,W=o.options,V="on"+n.charAt(0).toUpperCase()+n.substr(1);window.CustomEvent&&!De&&!st?x=new CustomEvent(n,{bubbles:!0,cancelable:!0}):(x=document.createEvent("Event"),x.initEvent(n,!0,!0)),x.to=r||t,x.from=s||t,x.item=a||t,x.clone=l,x.oldIndex=i,x.newIndex=d,x.oldDraggableIndex=f,x.newDraggableIndex=h,x.originalEvent=D,x.pullMode=_?_.lastPutMode:void 0;var y=ke(ke({},M),ut.getEventProperties(n,o));for(var I in y)x[I]=y[I];t&&t.dispatchEvent(x),W[V]&&W[V].call(o,x)}}var Ja=["evt"],se=function(e,o){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=t.evt,a=$a(t,Ja);ut.pluginEvent.bind(k)(e,o,ke({dragEl:c,parentEl:L,ghostEl:C,rootEl:$,nextEl:Ve,lastDownEl:kt,cloneEl:Y,cloneHidden:Ie,dragStarted:et,putSortable:K,activeSortable:k.active,originalEvent:n,oldIndex:We,oldDraggableIndex:lt,newIndex:fe,newDraggableIndex:Te,hideGhostForTarget:Ho,unhideGhostForTarget:zo,cloneNowHidden:function(){Ie=!0},cloneNowShown:function(){Ie=!1},dispatchSortableEvent:function(l){le({sortable:o,name:l,originalEvent:n})}},a))};function le(e){qa(ke({putSortable:K,cloneEl:Y,targetEl:c,rootEl:$,oldIndex:We,oldDraggableIndex:lt,newIndex:fe,newDraggableIndex:Te},e))}var c,L,C,$,Ve,kt,Y,Ie,We,fe,lt,Te,gt,K,Xe=!1,Tt=!1,Ot=[],Pe,ye,Bt,Xt,Eo,Do,et,$e,rt,it=!1,_t=!1,St,oe,Yt=[],qt=!1,It=[],At=typeof document<"u",yt=Fo,xo=st||De?"cssFloat":"float",Za=At&&!Uo&&!Fo&&"draggable"in document.createElement("div"),Yo=function(){if(At){if(De)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto",e.style.pointerEvents==="auto"}}(),Lo=function(e,o){var t=w(e),n=parseInt(t.width)-parseInt(t.paddingLeft)-parseInt(t.paddingRight)-parseInt(t.borderLeftWidth)-parseInt(t.borderRightWidth),a=Ge(e,0,o),l=Ge(e,1,o),r=a&&w(a),s=l&&w(l),i=r&&parseInt(r.marginLeft)+parseInt(r.marginRight)+J(a).width,d=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+J(l).width;if(t.display==="flex")return t.flexDirection==="column"||t.flexDirection==="column-reverse"?"vertical":"horizontal";if(t.display==="grid")return t.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(a&&r.float&&r.float!=="none"){var f=r.float==="left"?"left":"right";return l&&(s.clear==="both"||s.clear===f)?"vertical":"horizontal"}return a&&(r.display==="block"||r.display==="flex"||r.display==="table"||r.display==="grid"||i>=n&&t[xo]==="none"||l&&t[xo]==="none"&&i+d>n)?"vertical":"horizontal"},Qa=function(e,o,t){var n=t?e.left:e.top,a=t?e.right:e.bottom,l=t?e.width:e.height,r=t?o.left:o.top,s=t?o.right:o.bottom,i=t?o.width:o.height;return n===r||a===s||n+l/2===r+i/2},Ka=function(e,o){var t;return Ot.some(function(n){var a=n[me].options.emptyInsertThreshold;if(!(!a||lo(n))){var l=J(n),r=e>=l.left-a&&e<=l.right+a,s=o>=l.top-a&&o<=l.bottom+a;if(r&&s)return t=n}}),t},Wo=function(e){function o(a,l){return function(r,s,i,d){var f=r.options.group.name&&s.options.group.name&&r.options.group.name===s.options.group.name;if(a==null&&(l||f))return!0;if(a==null||a===!1)return!1;if(l&&a==="clone")return a;if(typeof a=="function")return o(a(r,s,i,d),l)(r,s,i,d);var h=(l?r:s).options.group.name;return a===!0||typeof a=="string"&&a===h||a.join&&a.indexOf(h)>-1}}var t={},n=e.group;(!n||wt(n)!="object")&&(n={name:n}),t.name=n.name,t.checkPull=o(n.pull,!0),t.checkPut=o(n.put),t.revertClone=n.revertClone,e.group=t},Ho=function(){!Yo&&C&&w(C,"display","none")},zo=function(){!Yo&&C&&w(C,"display","")};At&&!Uo&&document.addEventListener("click",function(e){if(Tt)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),Tt=!1,!1},!0);var Me=function(e){if(c){e=e.touches?e.touches[0]:e;var o=Ka(e.clientX,e.clientY);if(o){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.target=t.rootEl=o,t.preventDefault=void 0,t.stopPropagation=void 0,o[me]._onDragOver(t)}}},el=function(e){c&&c.parentNode[me]._isOutsideThisEl(e.target)};function k(e,o){if(!(e&&e.nodeType&&e.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=o=Ee({},o),e[me]=this;var t={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Lo(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(l,r){l.setData("Text",r.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:k.supportPointer!==!1&&"PointerEvent"in window&&!nt,emptyInsertThreshold:5};ut.initializePlugins(this,e,t);for(var n in t)!(n in o)&&(o[n]=t[n]);Wo(o);for(var a in this)a.charAt(0)==="_"&&typeof this[a]=="function"&&(this[a]=this[a].bind(this));this.nativeDraggable=o.forceFallback?!1:Za,this.nativeDraggable&&(this.options.touchStartThreshold=1),o.supportPointer?A(e,"pointerdown",this._onTapStart):(A(e,"mousedown",this._onTapStart),A(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(A(e,"dragover",this),A(e,"dragenter",this)),Ot.push(this.el),o.store&&o.store.get&&this.sort(o.store.get(this)||[]),Ee(this,Ha())}k.prototype={constructor:k,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&($e=null)},_getDirection:function(e,o){return typeof this.options.direction=="function"?this.options.direction.call(this,e,o,c):this.options.direction},_onTapStart:function(e){if(e.cancelable){var o=this,t=this.el,n=this.options,a=n.preventOnFilter,l=e.type,r=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,s=(r||e).target,i=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||s,d=n.filter;if(sl(t),!c&&!(/mousedown|pointerdown/.test(l)&&e.button!==0||n.disabled)&&!i.isContentEditable&&!(!this.nativeDraggable&&nt&&s&&s.tagName.toUpperCase()==="SELECT")&&(s=be(s,n.draggable,t,!1),!(s&&s.animated)&&kt!==s)){if(We=he(s),lt=he(s,n.draggable),typeof d=="function"){if(d.call(this,e,s,this)){le({sortable:o,rootEl:i,name:"filter",targetEl:s,toEl:t,fromEl:t}),se("filter",o,{evt:e}),a&&e.cancelable&&e.preventDefault();return}}else if(d&&(d=d.split(",").some(function(f){if(f=be(i,f.trim(),t,!1),f)return le({sortable:o,rootEl:f,name:"filter",targetEl:s,fromEl:t,toEl:t}),se("filter",o,{evt:e}),!0}),d)){a&&e.cancelable&&e.preventDefault();return}n.handle&&!be(i,n.handle,t,!1)||this._prepareDragStart(e,r,s)}}},_prepareDragStart:function(e,o,t){var n=this,a=n.el,l=n.options,r=a.ownerDocument,s;if(t&&!c&&t.parentNode===a){var i=J(t);if($=a,c=t,L=c.parentNode,Ve=c.nextSibling,kt=t,gt=l.group,k.dragged=c,Pe={target:c,clientX:(o||e).clientX,clientY:(o||e).clientY},Eo=Pe.clientX-i.left,Do=Pe.clientY-i.top,this._lastX=(o||e).clientX,this._lastY=(o||e).clientY,c.style["will-change"]="all",s=function(){if(se("delayEnded",n,{evt:e}),k.eventCanceled){n._onDrop();return}n._disableDelayedDragEvents(),!bo&&n.nativeDraggable&&(c.draggable=!0),n._triggerDragStart(e,o),le({sortable:n,name:"choose",originalEvent:e}),pe(c,l.chosenClass,!0)},l.ignore.split(",").forEach(function(d){jo(c,d.trim(),Lt)}),A(r,"dragover",Me),A(r,"mousemove",Me),A(r,"touchmove",Me),A(r,"mouseup",n._onDrop),A(r,"touchend",n._onDrop),A(r,"touchcancel",n._onDrop),bo&&this.nativeDraggable&&(this.options.touchStartThreshold=4,c.draggable=!0),se("delayStart",this,{evt:e}),l.delay&&(!l.delayOnTouchOnly||o)&&(!this.nativeDraggable||!(st||De))){if(k.eventCanceled){this._onDrop();return}A(r,"mouseup",n._disableDelayedDrag),A(r,"touchend",n._disableDelayedDrag),A(r,"touchcancel",n._disableDelayedDrag),A(r,"mousemove",n._delayedDragTouchMoveHandler),A(r,"touchmove",n._delayedDragTouchMoveHandler),l.supportPointer&&A(r,"pointermove",n._delayedDragTouchMoveHandler),n._dragStartTimer=setTimeout(s,l.delay)}else s()}},_delayedDragTouchMoveHandler:function(e){var o=e.touches?e.touches[0]:e;Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){c&&Lt(c),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;N(e,"mouseup",this._disableDelayedDrag),N(e,"touchend",this._disableDelayedDrag),N(e,"touchcancel",this._disableDelayedDrag),N(e,"mousemove",this._delayedDragTouchMoveHandler),N(e,"touchmove",this._delayedDragTouchMoveHandler),N(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,o){o=o||e.pointerType=="touch"&&e,!this.nativeDraggable||o?this.options.supportPointer?A(document,"pointermove",this._onTouchMove):o?A(document,"touchmove",this._onTouchMove):A(document,"mousemove",this._onTouchMove):(A(c,"dragend",this),A($,"dragstart",this._onDragStart));try{document.selection?Et(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,o){if(Xe=!1,$&&c){se("dragStarted",this,{evt:o}),this.nativeDraggable&&A(document,"dragover",el);var t=this.options;!e&&pe(c,t.dragClass,!1),pe(c,t.ghostClass,!0),k.active=this,e&&this._appendGhost(),le({sortable:this,name:"start",originalEvent:o})}else this._nulling()},_emulateDragOver:function(){if(ye){this._lastX=ye.clientX,this._lastY=ye.clientY,Ho();for(var e=document.elementFromPoint(ye.clientX,ye.clientY),o=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(ye.clientX,ye.clientY),e!==o);)o=e;if(c.parentNode[me]._isOutsideThisEl(e),o)do{if(o[me]){var t=void 0;if(t=o[me]._onDragOver({clientX:ye.clientX,clientY:ye.clientY,target:e,rootEl:o}),t&&!this.options.dragoverBubble)break}e=o}while(o=o.parentNode);zo()}},_onTouchMove:function(e){if(Pe){var o=this.options,t=o.fallbackTolerance,n=o.fallbackOffset,a=e.touches?e.touches[0]:e,l=C&&ze(C,!0),r=C&&l&&l.a,s=C&&l&&l.d,i=yt&&oe&&So(oe),d=(a.clientX-Pe.clientX+n.x)/(r||1)+(i?i[0]-Yt[0]:0)/(r||1),f=(a.clientY-Pe.clientY+n.y)/(s||1)+(i?i[1]-Yt[1]:0)/(s||1);if(!k.active&&!Xe){if(t&&Math.max(Math.abs(a.clientX-this._lastX),Math.abs(a.clientY-this._lastY))<t)return;this._onDragStart(e,!0)}if(C){l?(l.e+=d-(Bt||0),l.f+=f-(Xt||0)):l={a:1,b:0,c:0,d:1,e:d,f};var h="matrix(".concat(l.a,",").concat(l.b,",").concat(l.c,",").concat(l.d,",").concat(l.e,",").concat(l.f,")");w(C,"webkitTransform",h),w(C,"mozTransform",h),w(C,"msTransform",h),w(C,"transform",h),Bt=d,Xt=f,ye=a}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!C){var e=this.options.fallbackOnBody?document.body:$,o=J(c,!0,yt,!0,e),t=this.options;if(yt){for(oe=e;w(oe,"position")==="static"&&w(oe,"transform")==="none"&&oe!==document;)oe=oe.parentNode;oe!==document.body&&oe!==document.documentElement?(oe===document&&(oe=we()),o.top+=oe.scrollTop,o.left+=oe.scrollLeft):oe=we(),Yt=So(oe)}C=c.cloneNode(!0),pe(C,t.ghostClass,!1),pe(C,t.fallbackClass,!0),pe(C,t.dragClass,!0),w(C,"transition",""),w(C,"transform",""),w(C,"box-sizing","border-box"),w(C,"margin",0),w(C,"top",o.top),w(C,"left",o.left),w(C,"width",o.width),w(C,"height",o.height),w(C,"opacity","0.8"),w(C,"position",yt?"absolute":"fixed"),w(C,"zIndex","100000"),w(C,"pointerEvents","none"),k.ghost=C,e.appendChild(C),w(C,"transform-origin",Eo/parseInt(C.style.width)*100+"% "+Do/parseInt(C.style.height)*100+"%")}},_onDragStart:function(e,o){var t=this,n=e.dataTransfer,a=t.options;if(se("dragStart",this,{evt:e}),k.eventCanceled){this._onDrop();return}se("setupClone",this),k.eventCanceled||(Y=Xo(c),Y.removeAttribute("id"),Y.draggable=!1,Y.style["will-change"]="",this._hideClone(),pe(Y,this.options.chosenClass,!1),k.clone=Y),t.cloneId=Et(function(){se("clone",t),!k.eventCanceled&&(t.options.removeCloneOnHide||$.insertBefore(Y,c),t._hideClone(),le({sortable:t,name:"clone"}))}),!o&&pe(c,a.dragClass,!0),o?(Tt=!0,t._loopId=setInterval(t._emulateDragOver,50)):(N(document,"mouseup",t._onDrop),N(document,"touchend",t._onDrop),N(document,"touchcancel",t._onDrop),n&&(n.effectAllowed="move",a.setData&&a.setData.call(t,n,c)),A(document,"drop",t),w(c,"transform","translateZ(0)")),Xe=!0,t._dragStartId=Et(t._dragStarted.bind(t,o,e)),A(document,"selectstart",t),et=!0,nt&&w(document.body,"user-select","none")},_onDragOver:function(e){var o=this.el,t=e.target,n,a,l,r=this.options,s=r.group,i=k.active,d=gt===s,f=r.sort,h=K||i,D,_=this,M=!1;if(qt)return;function x(ge,qe){se(ge,_,ke({evt:e,isOwner:d,axis:D?"vertical":"horizontal",revert:l,dragRect:n,targetRect:a,canSort:f,fromSortable:h,target:t,completed:V,onMove:function(Ue,Je){return bt($,o,c,n,Ue,J(Ue),e,Je)},changed:y},qe))}function W(){x("dragOverAnimationCapture"),_.captureAnimationState(),_!==h&&h.captureAnimationState()}function V(ge){return x("dragOverCompleted",{insertion:ge}),ge&&(d?i._hideClone():i._showClone(_),_!==h&&(pe(c,K?K.options.ghostClass:i.options.ghostClass,!1),pe(c,r.ghostClass,!0)),K!==_&&_!==k.active?K=_:_===k.active&&K&&(K=null),h===_&&(_._ignoreWhileAnimating=t),_.animateAll(function(){x("dragOverAnimationComplete"),_._ignoreWhileAnimating=null}),_!==h&&(h.animateAll(),h._ignoreWhileAnimating=null)),(t===c&&!c.animated||t===o&&!t.animated)&&($e=null),!r.dragoverBubble&&!e.rootEl&&t!==document&&(c.parentNode[me]._isOutsideThisEl(e.target),!ge&&Me(e)),!r.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),M=!0}function y(){fe=he(c),Te=he(c,r.draggable),le({sortable:_,name:"change",toEl:o,newIndex:fe,newDraggableIndex:Te,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),t=be(t,r.draggable,o,!0),x("dragOver"),k.eventCanceled)return M;if(c.contains(e.target)||t.animated&&t.animatingX&&t.animatingY||_._ignoreWhileAnimating===t)return V(!1);if(Tt=!1,i&&!r.disabled&&(d?f||(l=L!==$):K===this||(this.lastPutMode=gt.checkPull(this,i,c,e))&&s.checkPut(this,i,c,e))){if(D=this._getDirection(e,t)==="vertical",n=J(c),x("dragOverValid"),k.eventCanceled)return M;if(l)return L=$,W(),this._hideClone(),x("revert"),k.eventCanceled||(Ve?$.insertBefore(c,Ve):$.appendChild(c)),V(!0);var I=lo(o,r.draggable);if(!I||al(e,D,this)&&!I.animated){if(I===c)return V(!1);if(I&&o===e.target&&(t=I),t&&(a=J(t)),bt($,o,c,n,t,a,e,!!t)!==!1)return W(),I&&I.nextSibling?o.insertBefore(c,I.nextSibling):o.appendChild(c),L=o,y(),V(!0)}else if(I&&nl(e,D,this)){var ue=Ge(o,0,r,!0);if(ue===c)return V(!1);if(t=ue,a=J(t),bt($,o,c,n,t,a,e,!1)!==!1)return W(),o.insertBefore(c,ue),L=o,y(),V(!0)}else if(t.parentNode===o){a=J(t);var S=0,O,Q=c.parentNode!==o,H=!Qa(c.animated&&c.toRect||n,t.animated&&t.toRect||a,D),B=D?"top":"left",re=ko(t,"top","top")||ko(c,"top","top"),xe=re?re.scrollTop:void 0;$e!==t&&(O=a[B],it=!1,_t=!H&&r.invertSwap||Q),S=ll(e,t,a,D,H?1:r.swapThreshold,r.invertedSwapThreshold==null?r.swapThreshold:r.invertedSwapThreshold,_t,$e===t);var ce;if(S!==0){var ee=he(c);do ee-=S,ce=L.children[ee];while(ce&&(w(ce,"display")==="none"||ce===C))}if(S===0||ce===t)return V(!1);$e=t,rt=S;var ae=t.nextElementSibling,ve=!1;ve=S===1;var ie=bt($,o,c,n,t,a,e,ve);if(ie!==!1)return(ie===1||ie===-1)&&(ve=ie===1),qt=!0,setTimeout(ol,30),W(),ve&&!ae?o.appendChild(c):t.parentNode.insertBefore(c,ve?ae:t),re&&Bo(re,0,xe-re.scrollTop),L=c.parentNode,O!==void 0&&!_t&&(St=Math.abs(O-J(t)[B])),y(),V(!0)}if(o.contains(c))return V(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){N(document,"mousemove",this._onTouchMove),N(document,"touchmove",this._onTouchMove),N(document,"pointermove",this._onTouchMove),N(document,"dragover",Me),N(document,"mousemove",Me),N(document,"touchmove",Me)},_offUpEvents:function(){var e=this.el.ownerDocument;N(e,"mouseup",this._onDrop),N(e,"touchend",this._onDrop),N(e,"pointerup",this._onDrop),N(e,"touchcancel",this._onDrop),N(document,"selectstart",this)},_onDrop:function(e){var o=this.el,t=this.options;if(fe=he(c),Te=he(c,t.draggable),se("drop",this,{evt:e}),L=c&&c.parentNode,fe=he(c),Te=he(c,t.draggable),k.eventCanceled){this._nulling();return}Xe=!1,_t=!1,it=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Jt(this.cloneId),Jt(this._dragStartId),this.nativeDraggable&&(N(document,"drop",this),N(o,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),nt&&w(document.body,"user-select",""),w(c,"transform",""),e&&(et&&(e.cancelable&&e.preventDefault(),!t.dropBubble&&e.stopPropagation()),C&&C.parentNode&&C.parentNode.removeChild(C),($===L||K&&K.lastPutMode!=="clone")&&Y&&Y.parentNode&&Y.parentNode.removeChild(Y),c&&(this.nativeDraggable&&N(c,"dragend",this),Lt(c),c.style["will-change"]="",et&&!Xe&&pe(c,K?K.options.ghostClass:this.options.ghostClass,!1),pe(c,this.options.chosenClass,!1),le({sortable:this,name:"unchoose",toEl:L,newIndex:null,newDraggableIndex:null,originalEvent:e}),$!==L?(fe>=0&&(le({rootEl:L,name:"add",toEl:L,fromEl:$,originalEvent:e}),le({sortable:this,name:"remove",toEl:L,originalEvent:e}),le({rootEl:L,name:"sort",toEl:L,fromEl:$,originalEvent:e}),le({sortable:this,name:"sort",toEl:L,originalEvent:e})),K&&K.save()):fe!==We&&fe>=0&&(le({sortable:this,name:"update",toEl:L,originalEvent:e}),le({sortable:this,name:"sort",toEl:L,originalEvent:e})),k.active&&((fe==null||fe===-1)&&(fe=We,Te=lt),le({sortable:this,name:"end",toEl:L,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){se("nulling",this),$=c=L=C=Ve=Y=kt=Ie=Pe=ye=et=fe=Te=We=lt=$e=rt=K=gt=k.dragged=k.ghost=k.clone=k.active=null,It.forEach(function(e){e.checked=!0}),It.length=Bt=Xt=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":c&&(this._onDragOver(e),tl(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],o,t=this.el.children,n=0,a=t.length,l=this.options;n<a;n++)o=t[n],be(o,l.draggable,this.el,!1)&&e.push(o.getAttribute(l.dataIdAttr)||il(o));return e},sort:function(e,o){var t={},n=this.el;this.toArray().forEach(function(a,l){var r=n.children[l];be(r,this.options.draggable,n,!1)&&(t[a]=r)},this),o&&this.captureAnimationState(),e.forEach(function(a){t[a]&&(n.removeChild(t[a]),n.appendChild(t[a]))}),o&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,o){return be(e,o||this.options.draggable,this.el,!1)},option:function(e,o){var t=this.options;if(o===void 0)return t[e];var n=ut.modifyOption(this,e,o);typeof n<"u"?t[e]=n:t[e]=o,e==="group"&&Wo(t)},destroy:function(){se("destroy",this);var e=this.el;e[me]=null,N(e,"mousedown",this._onTapStart),N(e,"touchstart",this._onTapStart),N(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(N(e,"dragover",this),N(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(o){o.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Ot.splice(Ot.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!Ie){if(se("hideClone",this),k.eventCanceled)return;w(Y,"display","none"),this.options.removeCloneOnHide&&Y.parentNode&&Y.parentNode.removeChild(Y),Ie=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(Ie){if(se("showClone",this),k.eventCanceled)return;c.parentNode==$&&!this.options.group.revertClone?$.insertBefore(Y,c):Ve?$.insertBefore(Y,Ve):$.appendChild(Y),this.options.group.revertClone&&this.animate(c,Y),w(Y,"display",""),Ie=!1}}};function tl(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function bt(e,o,t,n,a,l,r,s){var i,d=e[me],f=d.options.onMove,h;return window.CustomEvent&&!De&&!st?i=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(i=document.createEvent("Event"),i.initEvent("move",!0,!0)),i.to=o,i.from=e,i.dragged=t,i.draggedRect=n,i.related=a||o,i.relatedRect=l||J(o),i.willInsertAfter=s,i.originalEvent=r,e.dispatchEvent(i),f&&(h=f.call(d,i,r)),h}function Lt(e){e.draggable=!1}function ol(){qt=!1}function nl(e,o,t){var n=J(Ge(t.el,0,t.options,!0)),a=10;return o?e.clientX<n.left-a||e.clientY<n.top&&e.clientX<n.right:e.clientY<n.top-a||e.clientY<n.bottom&&e.clientX<n.left}function al(e,o,t){var n=J(lo(t.el,t.options.draggable)),a=10;return o?e.clientX>n.right+a||e.clientX<=n.right&&e.clientY>n.bottom&&e.clientX>=n.left:e.clientX>n.right&&e.clientY>n.top||e.clientX<=n.right&&e.clientY>n.bottom+a}function ll(e,o,t,n,a,l,r,s){var i=n?e.clientY:e.clientX,d=n?t.height:t.width,f=n?t.top:t.left,h=n?t.bottom:t.right,D=!1;if(!r){if(s&&St<d*a){if(!it&&(rt===1?i>f+d*l/2:i<h-d*l/2)&&(it=!0),it)D=!0;else if(rt===1?i<f+St:i>h-St)return-rt}else if(i>f+d*(1-a)/2&&i<h-d*(1-a)/2)return rl(o)}return D=D||r,D&&(i<f+d*l/2||i>h-d*l/2)?i>f+d/2?1:-1:0}function rl(e){return he(c)<he(e)?1:-1}function il(e){for(var o=e.tagName+e.className+e.src+e.href+e.textContent,t=o.length,n=0;t--;)n+=o.charCodeAt(t);return n.toString(36)}function sl(e){It.length=0;for(var o=e.getElementsByTagName("input"),t=o.length;t--;){var n=o[t];n.checked&&It.push(n)}}function Et(e){return setTimeout(e,0)}function Jt(e){return clearTimeout(e)}At&&A(document,"touchmove",function(e){(k.active||Xe)&&e.cancelable&&e.preventDefault()});k.utils={on:A,off:N,css:w,find:jo,is:function(e,o){return!!be(e,o,e,!1)},extend:La,throttle:$o,closest:be,toggleClass:pe,clone:Xo,index:he,nextTick:Et,cancelNextTick:Jt,detectDirection:Lo,getChild:Ge};k.get=function(e){return e[me]};k.mount=function(){for(var e=arguments.length,o=new Array(e),t=0;t<e;t++)o[t]=arguments[t];o[0].constructor===Array&&(o=o[0]),o.forEach(function(n){if(!n.prototype||!n.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(n));n.utils&&(k.utils=ke(ke({},k.utils),n.utils)),ut.mount(n)})};k.create=function(e,o){return new k(e,o)};k.version=Ba;var q=[],tt,Zt,Qt=!1,Wt,Ht,Nt,ot;function ul(){function e(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var o in this)o.charAt(0)==="_"&&typeof this[o]=="function"&&(this[o]=this[o].bind(this))}return e.prototype={dragStarted:function(o){var t=o.originalEvent;this.sortable.nativeDraggable?A(document,"dragover",this._handleAutoScroll):this.options.supportPointer?A(document,"pointermove",this._handleFallbackAutoScroll):t.touches?A(document,"touchmove",this._handleFallbackAutoScroll):A(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(o){var t=o.originalEvent;!this.options.dragOverBubble&&!t.rootEl&&this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?N(document,"dragover",this._handleAutoScroll):(N(document,"pointermove",this._handleFallbackAutoScroll),N(document,"touchmove",this._handleFallbackAutoScroll),N(document,"mousemove",this._handleFallbackAutoScroll)),Co(),Dt(),Wa()},nulling:function(){Nt=Zt=tt=Qt=ot=Wt=Ht=null,q.length=0},_handleFallbackAutoScroll:function(o){this._handleAutoScroll(o,!0)},_handleAutoScroll:function(o,t){var n=this,a=(o.touches?o.touches[0]:o).clientX,l=(o.touches?o.touches[0]:o).clientY,r=document.elementFromPoint(a,l);if(Nt=o,t||this.options.forceAutoScrollFallback||st||De||nt){zt(o,this.options,r,t);var s=Ne(r,!0);Qt&&(!ot||a!==Wt||l!==Ht)&&(ot&&Co(),ot=setInterval(function(){var i=Ne(document.elementFromPoint(a,l),!0);i!==s&&(s=i,Dt()),zt(o,n.options,i,t)},10),Wt=a,Ht=l)}else{if(!this.options.bubbleScroll||Ne(r,!0)===we()){Dt();return}zt(o,this.options,Ne(r,!1),!1)}}},Ee(e,{pluginName:"scroll",initializeByDefault:!0})}function Dt(){q.forEach(function(e){clearInterval(e.pid)}),q=[]}function Co(){clearInterval(ot)}var zt=$o(function(e,o,t,n){if(o.scroll){var a=(e.touches?e.touches[0]:e).clientX,l=(e.touches?e.touches[0]:e).clientY,r=o.scrollSensitivity,s=o.scrollSpeed,i=we(),d=!1,f;Zt!==t&&(Zt=t,Dt(),tt=o.scroll,f=o.scrollFn,tt===!0&&(tt=Ne(t,!0)));var h=0,D=tt;do{var _=D,M=J(_),x=M.top,W=M.bottom,V=M.left,y=M.right,I=M.width,ue=M.height,S=void 0,O=void 0,Q=_.scrollWidth,H=_.scrollHeight,B=w(_),re=_.scrollLeft,xe=_.scrollTop;_===i?(S=I<Q&&(B.overflowX==="auto"||B.overflowX==="scroll"||B.overflowX==="visible"),O=ue<H&&(B.overflowY==="auto"||B.overflowY==="scroll"||B.overflowY==="visible")):(S=I<Q&&(B.overflowX==="auto"||B.overflowX==="scroll"),O=ue<H&&(B.overflowY==="auto"||B.overflowY==="scroll"));var ce=S&&(Math.abs(y-a)<=r&&re+I<Q)-(Math.abs(V-a)<=r&&!!re),ee=O&&(Math.abs(W-l)<=r&&xe+ue<H)-(Math.abs(x-l)<=r&&!!xe);if(!q[h])for(var ae=0;ae<=h;ae++)q[ae]||(q[ae]={});(q[h].vx!=ce||q[h].vy!=ee||q[h].el!==_)&&(q[h].el=_,q[h].vx=ce,q[h].vy=ee,clearInterval(q[h].pid),(ce!=0||ee!=0)&&(d=!0,q[h].pid=setInterval((function(){n&&this.layer===0&&k.active._onTouchMove(Nt);var ve=q[this.layer].vy?q[this.layer].vy*s:0,ie=q[this.layer].vx?q[this.layer].vx*s:0;typeof f=="function"&&f.call(k.dragged.parentNode[me],ie,ve,e,Nt,q[this.layer].el)!=="continue"||Bo(q[this.layer].el,ie,ve)}).bind({layer:h}),24))),h++}while(o.bubbleScroll&&D!==i&&(D=Ne(D,!1)));Qt=d}},30),Go=function(e){var o=e.originalEvent,t=e.putSortable,n=e.dragEl,a=e.activeSortable,l=e.dispatchSortableEvent,r=e.hideGhostForTarget,s=e.unhideGhostForTarget;if(o){var i=t||a;r();var d=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:o,f=document.elementFromPoint(d.clientX,d.clientY);s(),i&&!i.el.contains(f)&&(l("spill"),this.onSpill({dragEl:n,putSortable:t}))}};function ro(){}ro.prototype={startIndex:null,dragStart:function(e){var o=e.oldDraggableIndex;this.startIndex=o},onSpill:function(e){var o=e.dragEl,t=e.putSortable;this.sortable.captureAnimationState(),t&&t.captureAnimationState();var n=Ge(this.sortable.el,this.startIndex,this.options);n?this.sortable.el.insertBefore(o,n):this.sortable.el.appendChild(o),this.sortable.animateAll(),t&&t.animateAll()},drop:Go};Ee(ro,{pluginName:"revertOnSpill"});function io(){}io.prototype={onSpill:function(e){var o=e.dragEl,t=e.putSortable,n=t||this.sortable;n.captureAnimationState(),o.parentNode&&o.parentNode.removeChild(o),n.animateAll()},drop:Go};Ee(io,{pluginName:"removeOnSpill"});k.mount(new ul);k.mount(io,ro);function cl(e){return e==null?e:JSON.parse(JSON.stringify(e))}function dl(e){to()&&zn(e)}function pl(e){to()?Gn(e):e()}const To="__CLONE__DRAGGABLE__ELEMENT__NODE__";function Kt(...e){var o,t;const n=(o=to())==null?void 0:o.proxy,a=e[0];let[,l,r]=e;Array.isArray(g(l))||(r=l,l=null);let s=null;const{immediate:i=!0,clone:d=cl}=(t=g(r))!=null?t:{};function f(S){var O;S.item[To]=d(g((O=g(l))==null?void 0:O[S.oldIndex]))}function h(S){const O=S.item[To];Na(O)||(Rt(S.item),Ia(g(l),S.newIndex,O))}function D(S){const{from:O,item:Q,oldIndex:H,pullMode:B,clone:re}=S;if(B==="clone"){_o(O,Q,H),Rt(re);return}Oa(g(l),H)}function _(S){const{from:O,item:Q,oldIndex:H,newIndex:B}=S;Rt(Q),_o(O,Q,H),xa(g(l),H,B)}const M={onUpdate:_,onStart:f,onAdd:h,onRemove:D};function x(S){const O=g(a);return S||(S=Aa(O)?Pa(O,n==null?void 0:n.$el):O),S&&!Fa(S)&&(S=S.$el),S||Da("Root element not found"),S}function W(){var S;const O=(S=g(r))!=null?S:{},Q=Mo(O,["immediate","clone"]);return Va(l===null?{}:M,Q)}const V=S=>{S=x(S),s&&y.destroy(),s=new k(S,W())};Oo(r,()=>{s&&Ua(W(),(S,O)=>{s==null||s.option(S,O)})},{deep:!0});const y={option:(S,O)=>s==null?void 0:s.option(S,O),destroy:()=>{s==null||s.destroy(),s=null},save:()=>s==null?void 0:s.save(),toArray:()=>s==null?void 0:s.toArray(),closest:(...S)=>s==null?void 0:s.closest(...S)},I=()=>y==null?void 0:y.option("disabled",!0),ue=()=>y==null?void 0:y.option("disabled",!1);return pl(()=>{i&&V()}),dl(y.destroy),Le({start:V,pause:I,resume:ue},y)}const eo=["update","start","add","remove","choose","unchoose","end","sort","filter","clone","move","change"],fl=["onUpdate","onStart","onAdd","onRemove","animation","ghostClass","group","sort","disabled","store","handle","draggable","swapThreshold","invertSwap","invertedSwapThreshold","removeCloneOnHide","direction","chosenClass","dragClass","ignore","filter","preventOnFilter","easing","setData","dropBubble","dragoverBubble","dataIdAttr","delay","delayOnTouchOnly","touchStartThreshold","forceFallback","fallbackClass","fallbackOnBody","fallbackTolerance","fallbackOffset","supportPointer","emptyInsertThreshold","scroll","forceAutoScrollFallback","scrollSensitivity","scrollSpeed","bubbleScroll","modelValue","tag","target",...eo.map(e=>`on${e.replace(/^\S/,o=>o.toUpperCase())}`)],ml=Yn({name:"VueDraggable",model:{prop:"modelValue",event:"update:modelValue"},props:fl,emits:["update:modelValue",...eo],setup(e,{slots:o,emit:t,expose:n}){const a=Ln(),l=eo.reduce((f,h)=>{const D=`on${h.replace(/^\S/,_=>_.toUpperCase())}`;return f[D]=_=>t(h,_),f},{}),r=co(()=>{const f=Wn(e),h=Mo(f,["modelValue"]),D=Object.entries(h).reduce((_,[M,x])=>{const W=g(x);return W!==void 0&&(_[M]=W),_},{});return Le(Le({},l),Ta(Le(Le({},a),D)))}),s=co({get:()=>e.modelValue,set:f=>t("update:modelValue",f)}),i=ne(),d=He(Kt(e.target||i,s,r));return n(d),()=>{if(o.default)return Hn(e.tag||"div",{ref:i},o.default(d))}}});const vl={class:"draggable-item-content"},hl={key:0},gl={key:1},_l={key:2},yl={key:3},bl={key:4},wl={key:5},kl={key:0,class:"ui-special-item-container"},Sl={__name:"UIDesign",props:{modelValue:{}},emits:["update:modelValue"],setup(e){const o=Io(e,"modelValue"),{t}=oo(),n=qn(o.value),a=He(n),l=ne(a.inputFields),r=ne(a.outputNodes),s=ne(a.triggerNodes),i=ne([{id:"typography-paragraph",required:!0,placeholder:t("components.workspace.uiDesign.typography-paragraph.placeholder"),show:!1,multiline:!0,value:"",password:!1,name:"typography-paragraph",display_name:"typography-paragraph",type:"str",clear_after_run:!0,list:!1,field_type:"typography-paragraph"}]),d=()=>{o.value.data.ui={inputFields:l.value,outputNodes:r.value}},f=ne(!1),h=ne(),D=He({animation:150,ghostClass:"ghost",handle:".handle",group:{name:"fields",pull:!1},onStart:()=>{f.value=!0},onAdd:()=>{d()},onEnd:()=>{d(),po(()=>{f.value=!1})}});Kt(h,l,D);const _=ne(),M=He({animation:150,ghostClass:"ghost",handle:".handle",group:{name:"fields",pull:!1},onStart:()=>{f.value=!0},onAdd:()=>{d()},onEnd:()=>{d(),po(()=>{f.value=!1})}});Kt(_,r,M);const x=(W,V)=>{W.splice(V,1),d()};return(W,V)=>{const y=E("a-menu-item"),I=E("a-tooltip"),ue=E("a-menu"),S=E("a-layout-sider"),O=E("a-typography-title"),Q=E("a-select"),H=E("a-textarea"),B=E("a-input"),re=E("a-input-number"),xe=E("a-checkbox"),ce=E("a-form-item"),ee=E("a-col"),ae=E("a-row"),ve=E("a-form"),ie=E("a-divider"),ge=E("a-button"),qe=E("a-popconfirm"),Ue=E("a-space"),Je=E("cron-ant"),Pt=E("a-card"),z=E("a-typography-paragraph"),Mt=E("a-layout-content"),ct=E("a-layout"),dt=Jn("highlight");return T(),G(ct,{class:"ui-design-layout","has-sider":"",style:{height:"100%","min-height":"calc(100vh - 40px - 40px)"}},{default:p(()=>[u(S,{style:{overflow:"auto",backgroundColor:"#fff"},class:"custom-scrollbar"},{default:p(()=>[u(ue,{theme:"light",mode:"inline",ref:"siderMenu"},{default:p(()=>[u(g(ml),{modelValue:i.value,"onUpdate:modelValue":V[0]||(V[0]=m=>i.value=m),animation:"150",group:{name:"fields",pull:"clone",put:!1},sort:!1},{default:p(()=>[(T(!0),Z(Oe,null,Ye(i.value,(m,de)=>(T(),G(I,{key:`node-${de}`,title:g(t)(`components.workspace.uiDesign.${m.name}.tip`),placement:"right"},{default:p(()=>[u(y,{class:"draggable-menu-item",id:m.id},{default:p(()=>[u(g(Ut)),Fe("span",null,U(g(t)(`components.workspace.uiDesign.${m.name}.title`)),1)]),_:2},1032,["id"])]),_:2},1032,["title"]))),128))]),_:1},8,["modelValue"])]),_:1},512)]),_:1}),u(ct,{style:{"background-color":"#fff"}},{default:p(()=>[u(Mt,{style:{margin:"24px 16px 0",overflow:"initial"}},{default:p(()=>[u(ae,{gutter:[16,16]},{default:p(()=>[u(ee,{xxl:6,xl:8,lg:10,md:24},{default:p(()=>[u(ae,{gutter:[16,16]},{default:p(()=>[u(O,{level:3},{default:p(()=>[u(g(da),{class:"text-primary"}),j(" "+U(g(t)("workspace.workflowSpace.inputs")),1)]),_:1}),u(ee,{span:24},{default:p(()=>[u(ve,{layout:"vertical",ref_key:"inputFieldsEl",ref:h},{default:p(()=>[(T(!0),Z(Oe,null,Ye(l.value,(m,de)=>(T(),Z("div",{class:"draggable-item",key:`field-${m}-${de}`},[u(g(Ut),{class:"handle"}),g(Zn).includes(m.field_type)?Be("",!0):(T(),G(ce,{key:0,class:"draggable-item-content"},{label:p(()=>[j(U(m.display_name),1)]),default:p(()=>[m.category=="llms"&&m=="temperature"?(T(),G(_a,{key:0,modelValue:m.value,"onUpdate:modelValue":F=>m.value=F},null,8,["modelValue","onUpdate:modelValue"])):m.field_type=="select"?(T(),G(Q,{key:1,value:m.value,"onUpdate:value":F=>m.value=F,options:m.options},null,8,["value","onUpdate:value","options"])):m.field_type=="textarea"?(T(),G(H,{key:2,value:m.value,"onUpdate:value":F=>m.value=F,autoSize:!0,showCount:!0,placeholder:m.placeholder},null,8,["value","onUpdate:value","placeholder"])):m.field_type=="input"?(T(),G(B,{key:3,value:m.value,"onUpdate:value":F=>m.value=F,placeholder:m.placeholder},null,8,["value","onUpdate:value","placeholder"])):m.field_type=="number"?(T(),G(re,{key:4,value:m.value,"onUpdate:value":F=>m.value=F,placeholder:m.placeholder},null,8,["value","onUpdate:value","placeholder"])):m.field_type=="checkbox"?(T(),G(xe,{key:5,checked:m.value,"onUpdate:checked":F=>m.value=F},null,8,["checked","onUpdate:checked"])):m.field_type=="file"?(T(),G(No,{key:6,modelValue:m.value,"onUpdate:modelValue":F=>m.value=F},null,8,["modelValue","onUpdate:modelValue"])):m.field_type=="list"?(T(),G(fa,{key:7,modelValue:m.value,"onUpdate:modelValue":F=>m.value=F},null,8,["modelValue","onUpdate:modelValue"])):Be("",!0)]),_:2},1024)),m.field_type=="typography-paragraph"?(T(),G(ae,{key:1,class:"draggable-item-content"},{default:p(()=>[u(ee,{span:24,class:"ui-special-item-container"},{default:p(()=>[u(H,{class:"ui-special-item",value:m.value,"onUpdate:value":F=>m.value=F,placeholder:m.placeholder,"auto-size":"",onChange:d},null,8,["value","onUpdate:value","placeholder"]),u(g(fo),{class:"ui-special-item-delete",onClick:F=>x(l.value,de)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)):Be("",!0)]))),128))]),_:1},512)]),_:1}),u(ie),u(ee,{span:24},{default:p(()=>[u(ae,{gutter:[16,16]},{default:p(()=>[(T(!0),Z(Oe,null,Ye(s.value,m=>(T(),G(ee,{key:`node-${m.id}`,span:24},{default:p(()=>[m.type=="ButtonTrigger"?(T(),G(ge,{key:0,type:"primary",block:""},{default:p(()=>[j(U(m.data.template.button_text.value),1)]),_:2},1024)):m.type=="ScheduleTrigger"?(T(),G(Pt,{key:1,title:g(t)("components.nodes.triggers.ScheduleTrigger.schedule_settings")},{extra:p(()=>[u(Ue,null,{default:p(()=>[u(ge,{type:"primary"},{default:p(()=>[j(U(g(t)("components.nodes.triggers.ScheduleTrigger.save_schedule_settings")),1)]),_:1}),u(qe,{title:g(t)("workspace.workflowSpace.delete_schedule_trigger_confirm")},{default:p(()=>[u(ge,{type:"primary",danger:""},{default:p(()=>[j(U(g(t)("workspace.workflowSpace.delete")),1)]),_:1})]),_:1},8,["title"])]),_:1})]),default:p(()=>[u(Je,{modelValue:m.data.template.schedule.value,"onUpdate:modelValue":de=>m.data.template.schedule.value=de,"button-props":{type:"primary",shape:"round"},locale:W.language},null,8,["modelValue","onUpdate:modelValue","locale"])]),_:2},1032,["title"])):Be("",!0)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1}),u(ee,{xxl:18,xl:16,lg:14,md:24},{default:p(()=>[u(O,{level:3,style:{display:"flex","justify-content":"space-between"}},{default:p(()=>[Fe("span",null,[u(g(pa),{class:"text-primary"}),j(" "+U(g(t)("workspace.workflowSpace.outputs")),1)])]),_:1}),u(ae,{gutter:[16,16],ref_key:"outputNodesEl",ref:_},{default:p(()=>[(T(!0),Z(Oe,null,Ye(r.value,(m,de)=>(T(),G(ee,{span:24,class:"draggable-item",key:`node-${m.id}-${de}`},{default:p(()=>{var F;return[u(g(Ut),{class:"handle"}),Fe("div",vl,[m.type=="Text"?(T(),Z("div",hl,[u(O,{level:5},{default:p(()=>[j(U(m.data.template.output_title.value),1)]),_:2},1024),m.data.template.render_markdown.value?(T(),Z(Oe,{key:0},[Gt(u(g(Qn),{source:m.data.template.text.value,class:"markdown-body custom-hljs"},null,8,["source"]),[[dt]]),u(z,{copyable:{text:m.data.template.text.value}},null,8,["copyable"])],64)):(T(),G(z,{key:1,copyable:{text:m.data.template.text.value}},{default:p(()=>[j(U(m.data.template.text.value),1)]),_:2},1032,["copyable"]))])):m.type=="Audio"?(T(),Z("div",gl,[u(ma,{audios:[(F=m.data.template.audio_url)==null?void 0:F.value]},null,8,["audios"])])):m.type=="Mindmap"?(T(),Z("div",_l,[u(va,{content:m.data.template.content.value,style:{width:"100%","min-height":"50vh"}},null,8,["content"])])):m.type=="Mermaid"?(T(),Z("div",yl,[u(ha,{content:m.data.template.content.value,style:{width:"100%","min-height":"50vh"}},null,8,["content"])])):m.type=="Echarts"?(T(),Z("div",bl,[u(ga,{option:m.data.template.option.value,style:{width:"100%","min-height":"50vh"}},null,8,["option"])])):(T(),Z("div",wl,[m.field_type=="typography-paragraph"?(T(),Z("div",kl,[u(H,{class:"ui-special-item",value:m.value,"onUpdate:value":Ze=>m.value=Ze,placeholder:m.placeholder,"auto-size":"",onChange:d},null,8,["value","onUpdate:value","placeholder"]),u(g(fo),{class:"ui-special-item-delete",onClick:Ze=>x(r.value,de)},null,8,["onClick"])])):Be("",!0)]))])]}),_:2},1024))),128))]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}},El=no(Sl,[["__scopeId","data-v-01ce6c33"]]);const Dl={__name:"VueFlowStyleSettings",props:{modelValue:{}},emits:Kn(["save"],["update:modelValue"]),setup(e,{emit:o}){const t=Io(e,"modelValue"),{t:n}=oo(),a=ne(!1),l=()=>{o("save",t),a.value=!1};return(r,s)=>{const i=E("a-button"),d=E("a-select-option"),f=E("a-select"),h=E("a-form-item"),D=E("a-switch"),_=E("a-form"),M=E("a-drawer");return T(),Z(Oe,null,[u(i,{onClick:s[0]||(s[0]=x=>a.value=!0),class:"settings-button"},{default:p(()=>[j(U(g(n)("components.workspace.vueFlowStyleSettings.title")),1)]),_:1}),u(M,{open:a.value,"onUpdate:open":s[3]||(s[3]=x=>a.value=x),class:"custom-class",title:g(n)("components.workspace.vueFlowStyleSettings.title"),placement:"right"},{extra:p(()=>[u(i,{type:"primary",onClick:l},{default:p(()=>[j(U(g(n)("common.save")),1)]),_:1})]),default:p(()=>[u(_,{model:t.value,"label-col":{span:8},"wrapper-col":{span:16},autocomplete:"off"},{default:p(()=>[u(h,{label:g(n)("components.workspace.vueFlowStyleSettings.edge_type"),name:"edge_type"},{default:p(()=>[u(f,{value:t.value.edge.type,"onUpdate:value":s[1]||(s[1]=x=>t.value.edge.type=x)},{default:p(()=>[u(d,{value:"bezier"},{default:p(()=>[j(U(g(n)("components.workspace.vueFlowStyleSettings.edge_type_bezier")),1)]),_:1}),u(d,{value:"step"},{default:p(()=>[j(U(g(n)("components.workspace.vueFlowStyleSettings.edge_type_step")),1)]),_:1}),u(d,{value:"smoothstep"},{default:p(()=>[j(U(g(n)("components.workspace.vueFlowStyleSettings.edge_type_smoothstep")),1)]),_:1}),u(d,{value:"straight"},{default:p(()=>[j(U(g(n)("components.workspace.vueFlowStyleSettings.edge_type_straight")),1)]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),u(h,{label:g(n)("components.workspace.vueFlowStyleSettings.edge_animated"),name:"edge_animated"},{default:p(()=>[u(D,{checked:t.value.edge.animated,"onUpdate:checked":s[2]||(s[2]=x=>t.value.edge.animated=x)},null,8,["checked"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["open","title"])],64)}}},xl=no(Dl,[["__scopeId","data-v-33ef65ae"]]);const Cl={key:0,class:"loading-container"},Tl={key:1,class:"editor-container"},Ol={class:"title-container"},Il=["data-node-type"],Nl={__name:"WorkflowEditor",setup(e){const{t:o}=oo(),t=ne(!0),n=ea(),a=ta(),l=n.params.workflowId,r=ne(o("workspace.workflowEditor.workflow_canvas")),s=He([o("workspace.workflowEditor.workflow_info"),o("workspace.workflowEditor.workflow_canvas"),o("workspace.workflowEditor.workflow_ui_design")]),i=ua(),{userDatabases:d}=Ft(i),f=oa(),h=na(),{vueFlowStyleSettings:D}=Ft(h),_=tn(),{nodeMessagesCount:M,nodeMessages:x}=Ft(_),W={change:(b,v)=>{},delete:(b,v)=>{I.value=I.value.filter(P=>P.id!==v),I.value=I.value.filter(P=>!(P.source&&P.source===v||P.target&&P.target===v))},clone:(b,v)=>{const P=I.value.find(te=>te.id===v);P.selected=!1;const X=JSON.parse(JSON.stringify(P));X.id=uo(),X.selected=!0,X.position.x+=50,X.position.y+=50,I.value.push(X)}};Oo(()=>M.value,()=>{for(;x.value.length>0;){const{action:b,data:v,nodeId:P}=_.pop();W[b](v,P)}});const V=ne(""),y=ne({}),I=ne([]),ue=()=>{Ue.value.forEach(b=>{b.type=D.value.edge.type,b.animated=D.value.edge.animated,b.style=D.value.edge.style}),h.setVueFlowStyleSettings(D.value)};aa(async()=>{const b=mo("get",{wid:l}),v=ya("list",{}),P=await b,X=await v;if(X.status==200&&i.setUserDatabases(X.data),P.status!=200){vt.error(o("workspace.workflowSpace.get_workflow_failed")),a.push({name:"WorkflowSpaceMain"});return}y.value=P.data,y.value.data.nodes.forEach(te=>{te.category=="vectorDb"&&(te.data.template.database.options=d.value.filter(_e=>_e.status=="VALID").map(_e=>({value:_e.vid,label:_e.name})))}),y.value.tags=y.value.tags.map(te=>te.tid),I.value=[...y.value.data.nodes,...y.value.data.edges],V.value=ht(y.value),t.value=!1});const S=()=>{const b=ie();y.value.data={...b,ui:y.value.data.ui||{}}},O=ne(!1),Q=async()=>{O.value=!0;const b=y.value.data.ui||{},v=ie();y.value.data={...v,ui:b};const P=await mo("update",{wid:l,...y.value});P.status==200?(vt.success(o("workspace.workflowSpace.save_success")),V.value=ht(y.value)):P.data.status==400?vt.error(o("workspace.workflowSpace.workflow_cant_invoke_itself")):vt.error(o("workspace.workflowSpace.save_failed")),f.updateUserWorkflow(y.value),O.value=!1},H=async()=>{await a.push({name:"WorkflowUse",params:{workflowId:l}})},B=ne(!1),re=async()=>{await Q(),await H()},xe=async()=>{await H()},ce=()=>{const b=y.value.data.ui||{},v=ie();y.value.data={...v,ui:b},V.value!=ht(y.value)?B.value=!0:H()},{addEdges:ee,updateEdge:ae,onConnect:ve,toObject:ie,viewport:ge,vueFlowRef:qe,edges:Ue}=on();ve(b=>{b.type=D.value.edge.type,b.animated=D.value.edge.animated,b.style=D.value.edge.style,ee([b])});const Je=({edge:b,connection:v})=>{ae(b,v)},Pt=b=>{I.value=I.value.filter(v=>!(v.source===b.edge.source&&v.target===b.edge.target&&v.sourceHandle===b.edge.sourceHandle&&v.targetHandle===b.edge.targetHandle))};let z;const Mt=b=>{z&&document.body.removeChild(z);let v=b.target.getBoundingClientRect();z=b.target.cloneNode(!0),z.style.position="absolute",z.style.top=v.top+"px",z.style.left=v.left+"px",z.style.width=v.width+"px",z.style.height=v.height+"px",z.style.opacity="0.5",z.style.zIndex="1000",document.body.appendChild(z)},ct=b=>{z&&(z.style.left=b.touches[0].clientX+"px",z.style.top=b.touches[0].clientY+"px")},dt=b=>{z&&(document.body.removeChild(z),z=null);let v=b.srcElement.dataset.nodeType;v||(v=b.srcElement.children[0].dataset.nodeType);const P=Ze[v],X=uo(),te=JSON.parse(JSON.stringify(de[v].props.templateData));te.description=o(`components.nodes.${P}.${v}.description`),Object.keys(te.template).forEach(ft=>{te.template[ft].display_name=o(`components.nodes.${P}.${v}.${ft}`)});const _e=qe.value.getBoundingClientRect(),{x:Vt,y:Ae,zoom:pt}=ge.value;let Qe=0,Re=0;b.type=="touchend"?(Qe=b.changedTouches[0].clientX-_e.left,Re=b.changedTouches[0].clientY-_e.top):(Qe=b.clientX-_e.left,Re=b.clientY-_e.top);const Ke={id:X,type:v,category:P,position:{x:(Qe-Vt)/pt,y:(Re-Ae)/pt},data:te};I.value.push(Ke)},m=Object.assign({"/src/components/nodes/assistedNodes/CommentNode.vue":nn,"/src/components/nodes/controlFlows/Conditional.vue":an,"/src/components/nodes/controlFlows/Empty.vue":ln,"/src/components/nodes/controlFlows/JsonProcess.vue":rn,"/src/components/nodes/controlFlows/RandomChoice.vue":sn,"/src/components/nodes/fileProcessing/FileLoader.vue":un,"/src/components/nodes/imageGeneration/StableDiffusion.vue":cn,"/src/components/nodes/llms/ChatGLM.vue":dn,"/src/components/nodes/llms/OpenAI.vue":pn,"/src/components/nodes/outputs/Document.vue":fn,"/src/components/nodes/outputs/Echarts.vue":mn,"/src/components/nodes/outputs/Email.vue":vn,"/src/components/nodes/outputs/Mermaid.vue":hn,"/src/components/nodes/outputs/Mindmap.vue":gn,"/src/components/nodes/outputs/Text.vue":_n,"/src/components/nodes/textProcessing/ListRender.vue":yn,"/src/components/nodes/textProcessing/MarkdownToHtml.vue":bn,"/src/components/nodes/textProcessing/TemplateCompose.vue":wn,"/src/components/nodes/textProcessing/TextInOut.vue":kn,"/src/components/nodes/textProcessing/TextSplitters.vue":Sn,"/src/components/nodes/textProcessing/TextTruncation.vue":En,"/src/components/nodes/tools/ImageSearch.vue":Dn,"/src/components/nodes/tools/ProgrammingFunction.vue":xn,"/src/components/nodes/tools/WorkflowInvoke.vue":Cn,"/src/components/nodes/triggers/ButtonTrigger.vue":Tn,"/src/components/nodes/vectorDb/AddData.vue":On,"/src/components/nodes/vectorDb/DeleteData.vue":In,"/src/components/nodes/vectorDb/Search.vue":Nn,"/src/components/nodes/webCrawlers/BilibiliCrawler.vue":An,"/src/components/nodes/webCrawlers/TextCrawler.vue":Pn,"/src/components/nodes/webCrawlers/YoutubeCrawler.vue":Mn}),de={},F={},Ze={};Object.entries(m).forEach(([b,v])=>{const P=b.match(/\/([^/]+)\.vue$/)[1];de[P]=la(v.default);const X=b.match(/\/([^/]+)\/[^/]+\.vue$/)[1];F[X]||(F[X]=[]),F[X].push(P),Ze[P]=X});const Ce=He({open:!1,code:"",openEditor:async()=>{let b=ie();b.ui=y.value.data.ui||{},Ce.code=JSON.stringify(b,null,2),Ce.open=!0},updateCode:b=>{const v=JSON.parse(b);y.value.data.ui=v.ui||{},I.value=[...v.nodes,...v.edges],y.value.data.nodes=v.nodes,y.value.data.edges=v.edges,y.value.data.nodes.forEach(P=>{P.category=="vectorDb"&&(P.data.template.database.options=d.value.filter(X=>X.status=="VALID").map(X=>({value:X.vid,label:X.name})))}),V.value=ht(y.value)}});return(b,v)=>{const P=E("a-spin"),X=E("a-typography-text"),te=E("a-button"),_e=E("a-modal"),Vt=E("a-typography-link"),Ae=E("a-col"),pt=E("a-segmented"),Qe=E("a-space"),Re=E("a-row"),Ke=E("a-divider"),ft=E("a-menu-item"),qo=E("a-sub-menu"),Jo=E("a-menu"),Zo=E("a-layout-sider"),Qo=E("a-layout-content"),so=E("a-layout");return t.value?(T(),Z("div",Cl,[u(P,{size:"large"})])):(T(),Z("div",Tl,[Fe("div",Ol,[u(Re,{type:"flex",align:"middle",justify:"space-between",gutter:[16,16],style:{width:"100%"}},{default:p(()=>[u(Ae,{flex:"0 0"},{default:p(()=>[u(Vt,{onClick:ce,style:{"text-wrap":"nowrap"}},{default:p(()=>[u(g(ra)),j(" "+U(g(o)("common.back"))+" ",1),u(_e,{open:B.value,"onUpdate:open":v[0]||(v[0]=R=>B.value=R)},{title:p(()=>[u(X,{type:"warning"},{default:p(()=>[u(g(ia)),j(" "+U(g(o)("common.back")),1)]),_:1})]),footer:p(()=>[u(te,{onClick:xe},{default:p(()=>[j(U(g(o)("workspace.workflowEditor.exit_without_save")),1)]),_:1}),u(te,{type:"primary",onClick:re},{default:p(()=>[j(U(g(o)("workspace.workflowEditor.save_and_exit")),1)]),_:1})]),default:p(()=>[j(" "+U(g(o)("workspace.workflowEditor.exit_not_saved_confirm"))+" ",1)]),_:1},8,["open"])]),_:1})]),_:1}),u(Ae,{flex:"0 0"},{default:p(()=>[u(X,{class:"title",editable:{triggerType:["text","icon"]},content:y.value.title,"onUpdate:content":v[1]||(v[1]=R=>y.value.title=R)},null,8,["content"])]),_:1}),u(Ae,{flex:"1 0",style:{display:"flex","justify-content":"center"}},{default:p(()=>[u(pt,{value:r.value,"onUpdate:value":v[2]||(v[2]=R=>r.value=R),options:s,onChange:S},null,8,["value","options"])]),_:1}),u(Ae,{flex:"0 0",style:{display:"flex","justify-content":"end"}},{default:p(()=>[u(Qe,null,{default:p(()=>[u(te,{onClick:Ce.openEditor},{default:p(()=>[j(U(g(o)("workspace.workflowEditor.edit_code"))+" ",1),u(Vn,{language:"json",open:Ce.open,"onUpdate:open":v[3]||(v[3]=R=>Ce.open=R),code:Ce.code,"onUpdate:code":v[4]||(v[4]=R=>Ce.code=R),onSave:Ce.updateCode},null,8,["open","code","onSave"])]),_:1},8,["onClick"]),u(te,{type:"primary",onClick:Q,loading:O.value},{default:p(()=>[j(U(g(o)("common.save")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),Gt(Fe("div",null,[u(Re,{justify:"center"},{default:p(()=>[u(Ae,{lg:10,md:12,sm:18,xs:24},{default:p(()=>[u(Ke,null,{default:p(()=>[j(U(g(o)("workspace.workflowEditor.tags")),1)]),_:1}),u(Fn,{modelValue:y.value.tags,"onUpdate:modelValue":v[5]||(v[5]=R=>y.value.tags=R)},null,8,["modelValue"]),u(Ke,null,{default:p(()=>[j(U(g(o)("workspace.workflowEditor.brief_info")),1)]),_:1}),u(ca,{markdown:y.value.brief,"onUpdate:markdown":v[6]||(v[6]=R=>y.value.brief=R)},null,8,["markdown"]),u(Ke,null,{default:p(()=>[j(U(g(o)("workspace.workflowEditor.brief_images")),1)]),_:1}),Fe("div",null,[u(No,{modelValue:y.value.images,"onUpdate:modelValue":v[7]||(v[7]=R=>y.value.images=R),multiple:!0},null,8,["modelValue"])])]),_:1})]),_:1})],512),[[vo,r.value==g(o)("workspace.workflowEditor.workflow_info")]]),Gt(u(so,{"has-sider":"",style:{height:"100%"}},{default:p(()=>[u(Zo,{style:{overflow:"auto",backgroundColor:"#fff"},class:"custom-scrollbar"},{default:p(()=>[u(Jo,{theme:"light",mode:"inline"},{default:p(()=>[(T(!0),Z(Oe,null,Ye(Object.keys(F),(R,Ko)=>(T(),G(qo,{key:`category-${Ko}`},{title:p(()=>[j(U(g(o)(`components.nodes.${R}.title`)),1)]),default:p(()=>[(T(!0),Z(Oe,null,Ye(F[R],(mt,en)=>(T(),G(ft,{"data-node-type":mt,id:mt,draggable:"true",onTouchstart:Mt,onTouchmove:ct,onDragend:dt,onTouchend:dt,key:`node-${en}`},{default:p(()=>[Fe("span",{"data-node-type":mt},U(g(o)(`components.nodes.${R}.${mt}.title`)),9,Il)]),_:2},1032,["data-node-type","id"]))),128))]),_:2},1024))),128))]),_:1})]),_:1}),u(so,null,{default:p(()=>[u(Qo,{style:{margin:"24px 16px 0",overflow:"initial"}},{default:p(()=>[u(g(Un),{modelValue:I.value,"onUpdate:modelValue":v[9]||(v[9]=R=>I.value=R),"node-types":de,edgesUpdatable:!0,onEdgeUpdate:Je,onEdgeDoubleClick:Pt,"snap-to-grid":!0,"snap-grid":[20,20]},{default:p(()=>[u(g(Rn)),u(g(jn)),u(g($n),{variant:g(Bn).Dots},null,8,["variant"]),u(xl,{modelValue:g(D),"onUpdate:modelValue":v[8]||(v[8]=R=>sa(D)?D.value=R:null),onSave:ue},null,8,["modelValue"])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},512),[[vo,r.value==g(o)("workspace.workflowEditor.workflow_canvas")]]),r.value==g(o)("workspace.workflowEditor.workflow_ui_design")?(T(),G(El,{key:0,modelValue:y.value,"onUpdate:modelValue":v[10]||(v[10]=R=>y.value=R)},null,8,["modelValue"])):Be("",!0)]))}}},Ll=no(Nl,[["__scopeId","data-v-5c4ba5f2"]]);export{Ll as default};
