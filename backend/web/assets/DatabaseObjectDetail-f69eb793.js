import{U as J,r as k,a5 as Q,D as W,q as K,b as Y,P as o,ai as Z,e as d,f as y,c as e,x as a,X as M,u as t,R as r,H as c,F as P,K as m,I as g,V as ee,aj as ae}from"./index-52f19034.js";import{d as te,a as oe}from"./database-0a67dc78.js";import{_ as se}from"./_plugin-vue_export-helper-c27b6911.js";import{C as ne,D as le}from"./DatabaseOutlined-3e0f1365.js";import{F as re}from"./FileOutlined-4973362b.js";import{C as ce}from"./CheckOutlined-29035a12.js";import{C as ie}from"./CloseOutlined-ea05eb73.js";const de={key:0,class:"loading-container"},ue={key:1,class:"dataspace-container"},_e={__name:"DatabaseObjectDetail",setup(pe){const{t:s}=J(),v=k(!0),j=Q(),S=j.params.databaseId,V=j.params.objectId,w=k({}),n=k({}),$=async()=>{const l=await te("get",{vid:S});l.status==200?w.value=l.data:M.error(l.msg)},B=async()=>{const l=await oe("get",{oid:V});l.status==200?n.value=l.data:M.error(l.msg)};W(async()=>{v.value=!0,await Promise.all([$(),B()]),u.data=n.value.raw_data.segments,v.value=!1});const D=k("segments"),u=K({columns:[{title:"#",key:"index",dataIndex:"index",width:"50px"},{title:s("workspace.databaseObjectDetail.segment_text"),key:"text",dataIndex:"text",ellipsis:!0},{title:s("workspace.databaseObjectDetail.segment_word_counts"),key:"word_counts",dataIndex:"word_counts",width:"50px"}],data:[],loading:!1,current:1,pageSize:10,total:0,pagination:Y(()=>({total:u.total,current:u.current,pageSize:u.pageSize})),hoverRowOid:null,customRow:l=>({style:{cursor:"pointer"},onClick:async i=>{(i.target.classList.contains("ant-table-cell")||i.target.classList.contains("object-title"))&&(p.segmentIndex=l.index,p.text=l.text,p.keywords=l.keywords,p.open=!0)},onMouseenter:i=>{u.hoverRowOid=l.vid},onMouseleave:i=>{u.hoverRowOid=null}})}),p=K({open:!1,segmentIndex:0,text:"",keywords:[]});return(l,i)=>{const F=o("a-spin"),C=o("router-link"),h=o("a-breadcrumb-item"),z=o("a-breadcrumb"),I=o("a-col"),R=o("a-typography-link"),N=o("a-popconfirm"),U=o("a-table"),O=o("a-tab-pane"),A=o("a-divider"),b=o("a-descriptions-item"),H=o("a-descriptions"),L=o("a-tabs"),T=o("a-typography-paragraph"),q=o("a-modal"),E=o("a-card"),X=o("a-row"),G=Z("highlight");return v.value?(d(),y("div",de,[e(F)])):(d(),y("div",ue,[e(X,{align:"center",gutter:[16,16]},{default:a(()=>[e(I,{xl:16,lg:18,md:20,sm:22,xs:24},{default:a(()=>[e(z,null,{default:a(()=>[e(h,null,{default:a(()=>[e(C,{to:"/data"},{default:a(()=>[e(t(ne)),r(" "+c(t(s)("components.layout.basicHeader.data_space")),1)]),_:1})]),_:1}),e(h,null,{default:a(()=>[e(C,{to:`/data/${w.value.vid}`},{default:a(()=>[e(t(le)),r(" "+c(w.value.name),1)]),_:1},8,["to"])]),_:1}),e(h,null,{default:a(()=>[r(c(n.value.title),1)]),_:1})]),_:1})]),_:1}),e(I,{xl:16,lg:18,md:20,sm:22,xs:24},{default:a(()=>[e(E,{loading:v.value},{title:a(()=>[e(t(re)),r(" "+c(n.value.title),1)]),default:a(()=>[e(L,{activeKey:D.value,"onUpdate:activeKey":i[0]||(i[0]=_=>D.value=_),"tab-position":"left"},{default:a(()=>[e(O,{key:"segments",tab:t(s)("workspace.databaseObjectDetail.segments")},{default:a(()=>[e(U,{customRow:u.customRow,columns:u.columns,"data-source":u.data,pagination:u.pagination},{bodyCell:a(({column:_,record:f})=>[_.key==="keywords"?(d(),y(P,{key:0},[r(c(f.keywords.join(", ")),1)],64)):_.key==="action"?(d(),y(P,{key:1},[f.status!="PR"?(d(),m(N,{key:0,placement:"leftTop",title:t(s)("workspace.databaseDetail.delete_confirm"),onConfirm:x=>l.deleteObject(f.oid)},{default:a(()=>[e(R,{type:"danger"},{default:a(()=>[r(c(t(s)("workspace.databaseDetail.delete")),1)]),_:1})]),_:2},1032,["title","onConfirm"])):g("",!0)],64)):g("",!0)]),_:1},8,["customRow","columns","data-source","pagination"])]),_:1},8,["tab"]),e(O,{key:"full-document",tab:t(s)("workspace.databaseObjectDetail.full_document")},{default:a(()=>{var _,f,x;return[((_=n.value.source_url)==null?void 0:_.length)>0?(d(),m(R,{key:0,href:n.value.source_url,target:"_blank"},{default:a(()=>[r(c(t(s)("workspace.databaseObjectDetail.source_url")),1)]),_:1},8,["href"])):g("",!0),((f=n.value.source_url)==null?void 0:f.length)>0?(d(),m(A,{key:1})):g("",!0),ee(e(t(ae),{source:((x=n.value.raw_data)==null?void 0:x.text)||"",class:"custom-scrollbar markdown-body custom-hljs"},null,8,["source"]),[[G]])]}),_:1},8,["tab"]),e(O,{key:"params_info",tab:t(s)("workspace.databaseObjectDetail.params_info")},{default:a(()=>[e(H,{bordered:""},{default:a(()=>[e(b,{label:t(s)("workspace.databaseObjectCreate.split_method")},{default:a(()=>[r(c(t(s)(`workspace.databaseObjectCreate.split_method_${n.value.info.process_rules.split_method}`)),1)]),_:1},8,["label"]),n.value.info.process_rules.split_method!="delimeter"?(d(),m(b,{key:0,label:t(s)("workspace.databaseObjectCreate.chunk_length")},{default:a(()=>[r(c(n.value.info.process_rules.chunk_length),1)]),_:1},8,["label"])):g("",!0),n.value.info.process_rules.split_method=="delimeter"?(d(),m(b,{key:1,label:t(s)("workspace.databaseObjectCreate.delimiter")},{default:a(()=>[r(c(n.value.info.process_rules.delimiter),1)]),_:1},8,["label"])):g("",!0),e(b,{label:t(s)("workspace.databaseObjectCreate.remove_url_and_email")},{default:a(()=>[n.value.info.process_rules.remove_url_and_email?(d(),m(t(ce),{key:0})):(d(),m(t(ie),{key:1}))]),_:1},8,["label"]),e(b,{label:t(s)("workspace.databaseObjectDetail.paragraph_counts")},{default:a(()=>[r(c(n.value.info.paragraph_counts),1)]),_:1},8,["label"]),e(b,{label:t(s)("workspace.databaseObjectDetail.word_counts")},{default:a(()=>[r(c(n.value.info.word_counts),1)]),_:1},8,["label"])]),_:1})]),_:1},8,["tab"])]),_:1},8,["activeKey"]),e(q,{open:p.open,"onUpdate:open":i[1]||(i[1]=_=>p.open=_),title:`# ${p.segmentIndex}`,onCancel:i[2]||(i[2]=_=>p.open=!1),footer:null},{default:a(()=>[e(T,{content:p.text},null,8,["content"])]),_:1},8,["open","title"])]),_:1},8,["loading"])]),_:1})]),_:1})]))}}},we=se(_e,[["__scopeId","data-v-89abffdc"]]);export{we as default};
