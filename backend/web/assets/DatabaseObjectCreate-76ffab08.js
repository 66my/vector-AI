import{j as ee,r as j,I as te,J as ae,e as q,b as le,N as oe,l as d,p as u,v as h,c as t,s as e,P as C,u as l,y as c,z as n,aH as se,q as i,F,D as b,B as re,aI as de,E as ne}from"./index-a9d65eeb.js";import{_ as ue}from"./UploaderFieldUse-fdfd962f.js";import{_ as ce}from"./QuestionPopover-a537b360.js";import{d as _e,a as ie}from"./database-d115207f.js";import{_ as be}from"./_plugin-vue_export-helper-c27b6911.js";import{C as me,D as pe}from"./DatabaseOutlined-3b2f1e0a.js";const fe={key:0,class:"loading-container"},ke={key:1,class:"dataspace-container"},ve={href:"objectInfo.source_url",target:"_blank"},je={__name:"DatabaseObjectCreate",setup(we){const{t:a}=ee(),w=j(!0),R=te(),P=ae(),O=R.params.databaseId,g=j({}),o=q({add_method:"url",use_oversea_crawler:!1,source_url:"",files:[],title:"",content:""}),_=q({split_method:"general",chunk_length:1e3,delimiter:"\\n",remove_url_and_email:!1}),m=j(0),z=j([{title:a("workspace.databaseObjectCreate.add_object"),content:"First-content"},{title:a("workspace.databaseObjectCreate.process_rules"),content:"Second-content"},{title:a("workspace.databaseObjectCreate.finish"),content:"Last-content"}]),A=le(()=>{if(m.value==0)return o.add_method=="url"?o.source_url=="":o.add_method=="files"?o.files.length==0:o.title==""||o.content=="";m.value==1}),E=async()=>{const v=await _e("get",{vid:O});v.status==200?g.value=v.data:C.error(v.msg)};oe(async()=>{w.value=!0,await E(),w.value=!1});const y=j(!1),H=async()=>{if(o.add_method=="text"&&o.content.length==0){C.error(a("workspace.databaseObjectCreate.content_empty"));return}y.value=!0,(await ie("create",{vid:O,...o,process_rules:_})).status===200?C.success(a("workspace.databaseObjectCreate.create_success")):C.error(a("workspace.databaseObjectCreate.create_failed")),y.value=!1,await P.push(`/data/${O}`)};return(v,s)=>{const J=d("a-spin"),$=d("router-link"),x=d("a-breadcrumb-item"),L=d("a-breadcrumb"),I=d("a-col"),M=d("a-steps"),k=d("a-radio-button"),V=d("a-radio-group"),p=d("a-form-item"),B=d("a-checkbox"),D=d("a-input"),T=d("a-textarea"),S=d("a-form"),G=d("a-input-number"),f=d("a-descriptions-item"),K=d("a-list-item-meta"),Q=d("a-list-item"),W=d("a-list"),X=d("a-descriptions"),N=d("a-row"),U=d("a-button"),Y=d("a-space"),Z=d("a-card");return w.value?(u(),h("div",fe,[t(J)])):(u(),h("div",ke,[t(N,{justify:"center",gutter:[16,16]},{default:e(()=>[t(I,{xl:16,lg:18,md:20,sm:22,xs:24},{default:e(()=>[t(L,null,{default:e(()=>[t(x,null,{default:e(()=>[t($,{to:"/data"},{default:e(()=>[t(l(me)),c(" "+n(l(a)("components.layout.basicHeader.data_space")),1)]),_:1})]),_:1}),t(x,null,{default:e(()=>[t($,{to:`/data/${g.value.vid}`},{default:e(()=>[t(l(pe)),c(" "+n(g.value.name),1)]),_:1},8,["to"])]),_:1}),t(x,null,{default:e(()=>[c(n(l(a)("workspace.databaseObjectCreate.add_object")),1)]),_:1})]),_:1})]),_:1}),t(I,{xl:16,lg:18,md:20,sm:22,xs:24},{default:e(()=>[t(Z,{loading:w.value},{title:e(()=>[t(l(se)),c(" "+n(l(a)("workspace.databaseObjectCreate.add_object")),1)]),default:e(()=>[t(M,{current:m.value,items:z.value,style:{"margin-bottom":"30px"}},null,8,["current","items"]),m.value==0?(u(),i(S,{key:0,"label-col":{span:6}},{default:e(()=>[t(p,{label:l(a)("workspace.databaseObjectCreate.add_method")},{default:e(()=>[t(V,{value:o.add_method,"onUpdate:value":s[0]||(s[0]=r=>o.add_method=r)},{default:e(()=>[t(k,{value:"url"},{default:e(()=>[c(n(l(a)("workspace.databaseObjectCreate.add_method_url")),1)]),_:1}),t(k,{value:"files"},{default:e(()=>[c(n(l(a)("workspace.databaseObjectCreate.add_method_files")),1)]),_:1}),t(k,{value:"text"},{default:e(()=>[c(n(l(a)("workspace.databaseObjectCreate.add_method_text")),1)]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),o.add_method=="url"?(u(),h(F,{key:0},[o.add_method=="url"?(u(),i(p,{key:0,label:l(a)("workspace.databaseObjectCreate.use_oversea_crawler")},{default:e(()=>[t(B,{checked:o.use_oversea_crawler,"onUpdate:checked":s[1]||(s[1]=r=>o.use_oversea_crawler=r)},null,8,["checked"])]),_:1},8,["label"])):b("",!0),t(p,{label:l(a)("workspace.databaseObjectCreate.object_source_url")},{default:e(()=>[t(D,{value:o.source_url,"onUpdate:value":s[2]||(s[2]=r=>o.source_url=r)},null,8,["value"])]),_:1},8,["label"])],64)):b("",!0),o.add_method=="files"?(u(),i(ue,{key:1,modelValue:o.files,"onUpdate:modelValue":s[3]||(s[3]=r=>o.files=r),multiple:!0,style:{"margin-bottom":"30px"}},null,8,["modelValue"])):b("",!0),o.add_method=="text"?(u(),h(F,{key:2},[t(p,{label:l(a)("workspace.databaseObjectCreate.object_title")},{default:e(()=>[t(D,{value:o.title,"onUpdate:value":s[4]||(s[4]=r=>o.title=r)},null,8,["value"])]),_:1},8,["label"]),t(p,{label:l(a)("workspace.databaseObjectCreate.object_content")},{default:e(()=>[t(T,{value:o.content,"onUpdate:value":s[5]||(s[5]=r=>o.content=r),"auto-size":!0,"show-count":!0},null,8,["value"])]),_:1},8,["label"])],64)):b("",!0)]),_:1})):b("",!0),m.value==1?(u(),i(S,{key:1,"label-col":{span:6}},{default:e(()=>[t(p,{label:l(a)("workspace.databaseObjectCreate.split_method")},{default:e(()=>[t(V,{value:_.split_method,"onUpdate:value":s[6]||(s[6]=r=>_.split_method=r)},{default:e(()=>[t(k,{value:"general"},{default:e(()=>[c(n(l(a)("workspace.databaseObjectCreate.split_method_general")),1)]),_:1}),t(k,{value:"delimeter"},{default:e(()=>[c(n(l(a)("workspace.databaseObjectCreate.split_method_delimeter")),1)]),_:1}),t(k,{value:"markdown"},{default:e(()=>[c(n(l(a)("workspace.databaseObjectCreate.split_method_markdown")),1)]),_:1}),t(k,{value:"table"},{default:e(()=>[c(n(l(a)("workspace.databaseObjectCreate.split_method_table")),1)]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),["delimeter","table"].includes(_.split_method)?b("",!0):(u(),i(p,{key:0},{label:e(()=>[c(n(l(a)("workspace.databaseObjectCreate.chunk_length"))+" ",1),t(ce,{contents:[l(a)("workspace.databaseObjectCreate.question.chunk_length.1"),l(a)("workspace.databaseObjectCreate.question.chunk_length.2"),l(a)("workspace.databaseObjectCreate.question.chunk_length.3")]},null,8,["contents"])]),default:e(()=>[t(G,{value:_.chunk_length,"onUpdate:value":s[7]||(s[7]=r=>_.chunk_length=r)},null,8,["value"])]),_:1})),_.split_method=="delimeter"?(u(),i(p,{key:1,label:l(a)("workspace.databaseObjectCreate.delimiter")},{default:e(()=>[t(D,{value:_.delimiter,"onUpdate:value":s[8]||(s[8]=r=>_.delimiter=r),style:{width:"200px"}},null,8,["value"])]),_:1},8,["label"])):b("",!0),t(p,{label:l(a)("workspace.databaseObjectCreate.remove_url_and_email")},{default:e(()=>[t(B,{checked:_.remove_url_and_email,"onUpdate:checked":s[9]||(s[9]=r=>_.remove_url_and_email=r)},null,8,["checked"])]),_:1},8,["label"])]),_:1})):b("",!0),t(N,{align:"center",gutter:[16,16]},{default:e(()=>[t(I,{xl:16,md:24},{default:e(()=>[m.value==2?(u(),i(X,{key:0,bordered:""},{default:e(()=>[t(f,{label:l(a)("workspace.databaseObjectCreate.add_method"),span:3},{default:e(()=>[c(n(l(a)(`workspace.databaseObjectCreate.add_method_${o.add_method}`)),1)]),_:1},8,["label"]),o.add_method=="url"?(u(),i(f,{key:0,label:l(a)("workspace.databaseObjectCreate.object_source_url"),span:3},{default:e(()=>[re("a",ve,n(o.source_url),1)]),_:1},8,["label"])):b("",!0),o.add_method=="files"?(u(),i(f,{key:1,label:l(a)("workspace.databaseObjectCreate.object_files"),span:3},{default:e(()=>[t(W,{dataSource:o.files},{renderItem:e(({item:r})=>[t(Q,null,{default:e(()=>[t(K,{title:r},null,8,["title"])]),_:2},1024)]),_:1},8,["dataSource"])]),_:1},8,["label"])):b("",!0),o.add_method=="text"?(u(),i(f,{key:2,label:l(a)("workspace.databaseObjectCreate.object_title"),span:1},{default:e(()=>[c(n(o.title),1)]),_:1},8,["label"])):b("",!0),o.add_method=="text"?(u(),i(f,{key:3,label:l(a)("workspace.databaseObjectCreate.object_content"),span:2},{default:e(()=>[c(n(o.content),1)]),_:1},8,["label"])):b("",!0),t(f,{label:l(a)("workspace.databaseObjectCreate.split_method")},{default:e(()=>[c(n(l(a)(`workspace.databaseObjectCreate.split_method_${_.split_method}`)),1)]),_:1},8,["label"]),_.split_method!="delimeter"?(u(),i(f,{key:4,label:l(a)("workspace.databaseObjectCreate.chunk_length")},{default:e(()=>[c(n(_.chunk_length),1)]),_:1},8,["label"])):b("",!0),_.split_method=="delimeter"?(u(),i(f,{key:5,label:l(a)("workspace.databaseObjectCreate.delimiter")},{default:e(()=>[c(n(_.delimiter),1)]),_:1},8,["label"])):b("",!0),t(f,{label:l(a)("workspace.databaseObjectCreate.remove_url_and_email")},{default:e(()=>[_.remove_url_and_email?(u(),i(l(de),{key:0})):(u(),i(l(ne),{key:1}))]),_:1},8,["label"])]),_:1})):b("",!0)]),_:1})]),_:1}),t(Y,{style:{float:"right"}},{default:e(()=>[t(U,{disabled:m.value==0,onClick:s[10]||(s[10]=r=>m.value-=1)},{default:e(()=>[c(n(l(a)("common.previous_step")),1)]),_:1},8,["disabled"]),m.value<2?(u(),i(U,{key:0,type:"primary",disabled:A.value,onClick:s[11]||(s[11]=r=>m.value+=1)},{default:e(()=>[c(n(l(a)("common.next_step")),1)]),_:1},8,["disabled"])):b("",!0),m.value==2?(u(),i(U,{key:1,type:"primary",loading:y.value,onClick:H},{default:e(()=>[c(n(l(a)("workspace.databaseObjectCreate.finish")),1)]),_:1},8,["loading"])):b("",!0)]),_:1})]),_:1},8,["loading"])]),_:1})]),_:1})]))}}},Ie=be(je,[["__scopeId","data-v-6623fed1"]]);export{Ie as default};
