import{I as L,c as t,W as z,M as k,f as l,K as R,j as i,T as u,D as f,B as s,s as x,r as U,a as A,$ as H,h as _,F as h,E as C,ae as G}from"./index-DwTab_5X.js";import{f as M}from"./util-CDdHKGWf.js";import{b as I}from"./userWorkflows-Bs4ZbHGJ.js";import{T as S}from"./Time-DvTUddU7.js";const $=L("control",!0,function(e){return t("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[t("rect",{x:"9",y:"4",width:"30",height:"40",rx:"2",stroke:e.colors[0],"stroke-width":e.strokeWidth},null),t("circle",{cx:"24",cy:"31",r:"6",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth},null),t("path",{d:"M18 12H21",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M18 18H21",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M27 18H30",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])}),Z=L("hourglass-full",!1,function(e){return t("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[t("path",{d:"M7 4H41",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M7 44H41",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M11 44C13.6667 30.6611 18 23.9944 24 24C30 24.0056 34.3333 30.6722 37 44H11Z",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M37 4C34.3333 17.3389 30 24.0056 24 24C18 23.9944 13.6667 17.3278 11 4H37Z",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M21 15H27",stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M19 38H29",stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])}),Q=L("list-numbers",!0,function(e){return t("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[t("path",{d:"M20 9H42",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M20 19H42",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M20 29H42",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M20 39H42",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M6 29H12V32L6 38V39H12",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M7 11L9 9V19M9 19H7M9 19H11",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])}),K=L("login",!0,function(e){return t("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[t("path",{d:"M23.9917 6H6V42H24",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M25 33L16 24L25 15",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M42 23.9917H16",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])}),J=L("tag",!1,function(e){return t("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[t("path",{d:"M8 44L8 6C8 4.89543 8.89543 4 10 4H38C39.1046 4 40 4.89543 40 6V44L24 35.7273L8 44Z",fill:e.colors[1],stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linejoin":e.strokeLinejoin},null),t("path",{d:"M16 18H32",stroke:e.colors[2],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])}),X={__name:"WorkflowRecordStatusTag",props:{status:{type:String,required:!0}},setup(e){const{t:j}=z(),r={NOT_STARTED:"purple",QUEUED:"orange",RUNNING:"blue",FINISHED:"green",FAILED:"red",STOPPING:"orange",STOPPED:"pink"};return(m,d)=>{const D=k("a-tag");return l(),R(D,{color:r[e.status],bordered:!1},{default:i(()=>[u(f(s(j)(`components.workspace.workflowRunRecordsDrawer.status_${e.status.toLowerCase()}`)),1)]),_:1},8,["color"])}}},re={__name:"WorkflowRunRecordsDrawer",props:{workflowId:{type:String,required:!1,default:""},buttonType:{type:String,required:!1,default:"primary"},showWorkflowTitle:{type:Boolean,required:!1,default:!1},openType:{type:String,required:!1,default:"detail"}},emits:["open-record"],setup(e,{emit:j}){const{t:r}=z(),m=x(!0),d=e,D=d.showWorkflowTitle?"80vw":"70vw",g=x(!1),N=()=>{g.value=!1},W=j,b=[{text:r("components.workspace.workflowRunRecordsDrawer.status_not_started"),value:"NOT_STARTED"},{text:r("components.workspace.workflowRunRecordsDrawer.status_queued"),value:"QUEUED"},{text:r("components.workspace.workflowRunRecordsDrawer.status_running"),value:"RUNNING"},{text:r("components.workspace.workflowRunRecordsDrawer.status_finished"),value:"FINISHED"},{text:r("components.workspace.workflowRunRecordsDrawer.status_failed"),value:"FAILED"},{text:r("components.workspace.workflowRunRecordsDrawer.status_stopping"),value:"STOPPING"},{text:r("components.workspace.workflowRunRecordsDrawer.status_stopped"),value:"STOPPED"}],T=x([{title:r("components.workspace.workflowRunRecordsDrawer.start_time"),key:"start_time",dataIndex:"start_time",sorter:!0,sortDirections:["descend","ascend"],width:"156px"},{title:r("components.workspace.workflowRunRecordsDrawer.end_time"),key:"end_time",dataIndex:"end_time",sorter:!0,sortDirections:["descend","ascend"],width:"156px"},{title:r("components.workspace.workflowRunRecordsDrawer.run_time"),key:"run_time",dataIndex:"run_time",width:"100px"},{title:r("components.workspace.workflowRunRecordsDrawer.status"),key:"status",dataIndex:"status",filters:b,width:"100px"},{title:r("common.action"),key:"action",width:"100px"}]);d.showWorkflowTitle&&T.value.splice(0,0,{title:r("components.workspace.workflowRunRecordsDrawer.workflow_title"),key:"workflow_title",dataIndex:"workflow_title",ellipsis:!0});const o=U({data:[],loading:!1,current:1,pageSize:10,total:0,sort_field:"start_time",sort_order:"descend",filters:{status:[]},pagination:A(()=>({total:o.total,current:o.current,pageSize:o.pageSize})),handleTableChange:(w,a,n)=>{o.sort_field=n.field,o.sort_order=n.order,o.filters.status=a.status,o.filters.shared=a.shared,o.load({page_size:w.pageSize,page:w.current,sort_field:n.field,sort_order:n.order,status:a.status,need_workflow:d.showWorkflowTitle})},load:async w=>{o.loading=!0;const a=await I("list",{wid:d.workflowId,...w});a.status==200?o.data=a.data.records.map(n=>(n.start_time&&n.end_time?n.run_time=((parseInt(n.end_time)-parseInt(n.start_time))/1e3).toFixed(2)+"s":n.run_time="-",n.start_time=n.start_time?M(n.start_time):"-",n.end_time=n.end_time?M(n.end_time):"-",n)):H.error(a.msg),o.total=a.data.total,o.pageSize=a.data.page_size,o.current=a.data.page,o.loading=!1}}),E=async()=>{g.value=!0,await o.load({page_size:o.pageSize,page:o.current,sort_field:o.sort_field,sort_order:o.sort_order,status:o.filters.status,shared:o.filters.shared,need_workflow:d.showWorkflowTitle}),m.value=!1},B=async(w,a)=>{if(m.value=!0,d.openType=="detail"){const n=await I("get",{rid:w});n.status==200?(W("open-record",n.data),g.value=!1):H.error(n.msg)}else W("open-record",{rid:w,wid:a.wid}),g.value=!1;m.value=!1};return(w,a)=>{const n=k("a-button"),v=k("a-tooltip"),P=k("a-flex"),F=k("a-table"),V=k("a-col"),O=k("a-row"),p=k("a-spin"),q=k("a-drawer");return l(),_(h,null,[t(n,{type:d.buttonType,onClick:E},{default:i(()=>[u(f(s(r)("components.workspace.workflowRunRecordsDrawer.workflows_run_records")),1)]),_:1},8,["type"]),t(q,{title:s(r)("components.workspace.workflowRunRecordsDrawer.my_workflows_run_records"),width:s(D),open:g.value,onClose:N},{default:i(()=>[t(p,{spinning:m.value},{default:i(()=>[t(O,{justify:"space-between",align:"middle"},{default:i(()=>[t(V,{span:24},{default:i(()=>[t(F,{loading:o.loading,columns:T.value,customRow:o.customRow,"data-source":o.data,pagination:o.pagination,onChange:o.handleTableChange},{headerCell:i(({column:c})=>[c.key==="workflow_title"?(l(),_(h,{key:0},[t(s(Q)),u(" "+f(s(r)("components.workspace.workflowRunRecordsDrawer.workflow_title")),1)],64)):c.key==="start_time"?(l(),_(h,{key:1},[t(s(S)),u(" "+f(s(r)("components.workspace.workflowRunRecordsDrawer.start_time")),1)],64)):c.key==="end_time"?(l(),_(h,{key:2},[t(s(S)),u(" "+f(s(r)("components.workspace.workflowRunRecordsDrawer.end_time")),1)],64)):c.key==="run_time"?(l(),R(v,{key:3,title:s(r)("components.workspace.workflowRunRecordsDrawer.run_time")},{default:i(()=>[t(s(Z))]),_:1},8,["title"])):c.key==="status"?(l(),R(v,{key:4,title:s(r)("components.workspace.workflowRunRecordsDrawer.status")},{default:i(()=>[t(s(J))]),_:1},8,["title"])):c.key==="action"?(l(),_(h,{key:5},[t(s($)),u(" "+f(s(r)("common.action")),1)],64)):C("",!0)]),bodyCell:i(({column:c,record:y})=>[c.key==="workflow_title"?(l(),_(h,{key:0},[u(f(y.workflow.title),1)],64)):c.key==="status"?(l(),R(X,{key:1,status:y.status},null,8,["status"])):c.key==="action"?(l(),R(P,{key:2,gap:"small",align:"center",justify:"center"},{default:i(()=>[t(v,{title:s(r)("components.workspace.workflowRunRecordsDrawer.check_record")},{default:i(()=>[t(n,{type:"text",onClick:G(Y=>B(y.rid,y.workflow),["prevent"])},{icon:i(()=>[t(s(K))]),_:2},1032,["onClick"])]),_:2},1032,["title"])]),_:2},1024)):C("",!0)]),_:1},8,["loading","columns","customRow","data-source","pagination","onChange"])]),_:1})]),_:1})]),_:1},8,["spinning"])]),_:1},8,["title","width","open"])],64)}}};export{$ as C,re as _};
