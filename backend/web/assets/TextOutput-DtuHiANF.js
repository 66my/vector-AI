import{I as C,c as h,W as E,a5 as F,r as L,s as T,x as B,M as k,f as v,h as O,a1 as J,K as b,j as x,F as M,G as z,B as N,T as V,D as W,a as A,a9 as H,$ as P,aa as U}from"./index-CEGDekEr.js";const $=C("add-one",!1,function(s){return h("svg",{width:s.size,height:s.size,viewBox:"0 0 48 48",fill:"none"},[h("path",{d:"M24 44C35.0457 44 44 35.0457 44 24C44 12.9543 35.0457 4 24 4C12.9543 4 4 12.9543 4 24C4 35.0457 12.9543 44 24 44Z",fill:s.colors[1],stroke:s.colors[0],"stroke-width":s.strokeWidth,"stroke-linejoin":s.strokeLinejoin},null),h("path",{d:"M24 16V32",stroke:s.colors[2],"stroke-width":s.strokeWidth,"stroke-linecap":s.strokeLinecap,"stroke-linejoin":s.strokeLinejoin},null),h("path",{d:"M16 24L32 24",stroke:s.colors[2],"stroke-width":s.strokeWidth,"stroke-linecap":s.strokeLinecap,"stroke-linejoin":s.strokeLinejoin},null)])}),D=C("lightning",!0,function(s){return h("svg",{width:s.size,height:s.size,viewBox:"0 0 48 48",fill:"none"},[h("path",{d:"M19 4H37L26 18H41L17 44L22 25H8L19 4Z",fill:s.colors[1],stroke:s.colors[0],"stroke-width":s.strokeWidth,"stroke-linejoin":s.strokeLinejoin},null)])}),G=C("reduce-one",!1,function(s){return h("svg",{width:s.size,height:s.size,viewBox:"0 0 48 48",fill:"none"},[h("path",{d:"M24 44C35.0457 44 44 35.0457 44 24C44 12.9543 35.0457 4 24 4C12.9543 4 4 12.9543 4 24C4 35.0457 12.9543 44 24 44Z",fill:s.colors[1],stroke:s.colors[0],"stroke-width":s.strokeWidth,"stroke-linejoin":s.strokeLinejoin},null),h("path",{d:"M16 24L32 24",stroke:s.colors[2],"stroke-width":s.strokeWidth,"stroke-linecap":s.strokeLinecap,"stroke-linejoin":s.strokeLinejoin},null)])}),K={__name:"TemperatureInput",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(s){const{t:e}=E(),n=F(s,"modelValue"),i=L([e("components.nodes.llms.common.creative"),e("components.nodes.llms.common.balanced"),e("components.nodes.llms.common.precise")]),r=T(e("components.nodes.llms.common.balanced")),l=L([.8,.5,.2]),c=u=>{r.value=u,i.forEach((p,o)=>{p===u&&(n.value=l[o])})},m=u=>{u>=0&&u<=.3?r.value=e("components.nodes.llms.common.precise"):u>.3&&u<=.7?r.value=e("components.nodes.llms.common.balanced"):u>.7&&u<=1&&(r.value=e("components.nodes.llms.common.creative"))};return B(()=>{m(n.value)}),(u,p)=>{const o=k("a-segmented"),y=k("a-input-number");return v(),O("div",null,[h(o,{value:r.value,"onUpdate:value":p[0]||(p[0]=g=>r.value=g),options:i,block:"",onChange:c},null,8,["value","options"]),h(y,{style:{width:"100%"},value:n.value,"onUpdate:value":p[1]||(p[1]=g=>n.value=g),step:.1,max:1,min:0,controls:!1,keyboard:!1,onChange:m},null,8,["value"])])}}};function Z(s){let e=!1;return Object.keys(s.data.template).forEach(n=>{s.data.template[n].show&&(e=!0)}),e}class q{constructor(){this.nodes=new Set,this.edges={}}add_node(e){this.nodes.add(e),e in this.edges||(this.edges[e]=new Set)}add_edge(e,n){this.nodes.has(e)||this.add_node(e),this.nodes.has(n)||this.add_node(n),this.edges[e].add(n)}get_parents(e){let n=[];for(const[i,r]of Object.entries(this.edges))r.has(e)&&n.push(i);return n}get_children(e){return Array.from(this.edges[e])}get_all_nodes(){return Array.from(this.nodes)}topological_sort(){let e={};for(const r of this.nodes)e[r]=0;for(const[r,l]of Object.entries(this.edges))for(const c of l)e[c]+=1;let n=Object.keys(e).filter(r=>e[r]==0),i=[];for(;n.length>0;){let r=n.shift();i.push(r);for(const l of this.edges[r])e[l]-=1,e[l]==0&&n.push(l)}if(i.length!=this.nodes.size)throw new Error("The graph contains cycles");return i}}const Q=s=>{const e={noCycle:!0,noIsolatedNodes:!0};let n=new q;const i=[];s.data.nodes.forEach(o=>{o.category!="triggers"&&o.category!="assistedNodes"?n.add_node(o.id):o.category=="triggers"&&i.push(o.id)}),s.data.edges.filter(o=>i.includes(o.source)&&i.includes(o.target)).forEach(o=>{n.add_edge(o.source,o.target)});try{n.topological_sort(),e.noCycle=!0}catch{e.noCycle=!1}const r=s.data.nodes.filter(o=>o.category!="triggers"&&o.category!="assistedNodes").map(o=>o.id),l=s.data.edges.filter(o=>!(i.includes(o.source)&&i.includes(o.target))),c={};r.forEach(o=>c[o]=[]),l.forEach(o=>{c[o.source].push(o.target),c[o.target].push(o.source)});const m=new Set,u=o=>{m.add(o),c[o].forEach(y=>{m.has(y)||u(y)})};let p=0;return r.forEach(o=>{m.has(o)||(p+=1,u(o))}),p>1?e.noIsolatedNodes=!1:e.noIsolatedNodes=!0,e},S=["typography-paragraph"],X=s=>{var u,p,o,y,g,I;let e=((p=(u=s.data)==null?void 0:u.ui)==null?void 0:p.inputFields)||[],n=JSON.parse(JSON.stringify(e)),i=((y=(o=s.data)==null?void 0:o.ui)==null?void 0:y.outputNodes)||[],r=JSON.parse(JSON.stringify(i)),l=((I=(g=s.data)==null?void 0:g.ui)==null?void 0:I.triggerNodes)||[],c=JSON.parse(JSON.stringify(l)),m=[];return s.data.nodes.forEach(a=>{if(a.category=="triggers"){l.push(a);const f=c.findIndex(d=>d.id==a.id);c.splice(f,1)}else if(a.category=="outputs"){if(a.type=="Text"){if(!a.data.template.text.show)return}else if(a.type=="Audio"){if(!a.data.template.show_player.value)return}else if(a.type=="Mindmap"){if(!a.data.template.show_mind_map.value)return}else if(a.type=="Mermaid"){if(!a.data.template.show_mermaid.value)return}else if(a.type=="Echarts"){if(!a.data.template.show_echarts.value)return}else if(a.field_type!="typography-paragraph"){if(a.type=="WorkflowInvokeOutput"){m.push(a);return}else if(a.type!="Html")return}const f=i.findIndex(d=>d.id==a.id);if(f>=0){i.splice(f,1,a);const d=r.findIndex(w=>w.id==a.id);r.splice(d,1)}else i.push(a)}else{if(!a.data.has_inputs&&Z(a))return;Object.keys(a.data.template).forEach(f=>{if(a.data.template[f].show){const d=JSON.parse(JSON.stringify(a.data.template[f]));d.category=a.category,d.nodeId=a.id,d.nodeType=a.type,d.fieldName=f,Object.defineProperty(d,"value",{get(){return a.data.template[f].value},set(_){a.data.template[f].value=_}});const w=e.findIndex(_=>_.nodeId==a.id&&_.fieldName==f);if(w>=0){e.splice(w,1,d);const _=n.findIndex(j=>j.nodeId==a.id&&j.fieldName==f);n.splice(_,1)}else e.push(d)}})}}),n.filter(a=>!S.includes(a.field_type)).forEach(a=>{const f=e.findIndex(d=>d.nodeId==a.nodeId&&d.fieldName==a.fieldName);e.splice(f,1)}),r.filter(a=>!S.includes(a.field_type)).forEach(a=>{const f=i.findIndex(d=>d.id==a.id);i.splice(f,1)}),c.forEach(a=>{const f=l.findIndex(d=>d.id==a.id);l.splice(f,1)}),{inputFields:e,outputNodes:i,triggerNodes:l,workflowInvokeOutputNodes:m}};function Y(s){let e=!0;try{s.forEach(n=>{let i=!0;n.field_type!="checkbox"&&n.show&&n.required&&((n.field_type=="number"&&typeof n.value!="number"||n.field_type=="select"&&n.value.length===0||!n.value&&!n.value===0)&&(i=!1),i||(J.error(t("workspace.workflowSpace.field_is_empty",{field:n.display_name})),e=!1))})}catch{e=!1}return e}const ee={__name:"ListFieldUse",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(s){const e=F(s,"modelValue"),{t:n}=E(),i=()=>{e.value.push("")},r=(c,m)=>{e.value[m]=c},l=c=>{e.value.splice(c,1)};return(c,m)=>{const u=k("a-input"),p=k("a-button"),o=k("a-flex");return v(),b(o,{vertical:"",gap:"small"},{default:x(()=>[(v(!0),O(M,null,z(e.value,(y,g)=>(v(),b(o,{key:g,align:"center",gap:"small"},{default:x(()=>[h(u,{value:y,onInput:I=>r(I.target.value,g)},null,8,["value","onInput"]),h(p,{type:"text",onClick:I=>l(g)},{icon:x(()=>[h(N(G))]),_:2},1032,["onClick"])]),_:2},1024))),128)),h(p,{type:"dashed",style:{width:"100%"},onClick:i},{default:x(()=>[h(N($)),V(" "+W(N(n)("components.nodes.listField.add_item")),1)]),_:1})]),_:1})}}},te={__name:"TextOutput",props:{text:{type:String,default:""},renderMarkdown:{type:Boolean,default:!1}},setup(s){const e=s,n=A(()=>typeof e.text=="string"?e.text:JSON.stringify(e.text));return(i,r)=>{const l=k("a-typography-paragraph"),c=H("highlight");return s.renderMarkdown?(v(),O(M,{key:0},[P(h(N(U),{source:n.value,class:"markdown-body custom-hljs"},null,8,["source"]),[[c]]),h(l,{copyable:{text:n.value}},null,8,["copyable"])],64)):(v(),b(l,{key:1,copyable:{text:n.value}},{default:x(()=>[V(W(n.value),1)]),_:1},8,["copyable"]))}}};export{$ as A,D as L,G as R,K as _,ee as a,te as b,Q as c,Y as d,X as g,Z as h,S as n};
