import{u as O,r as v,d as q,e as G,b as H,z as Q,J as X,p as m,f as o,K as Y,o as l,g as y,c as a,i as _,h as t,k as r,t as n,j as u,l as f,m as N,F as P,D as V,E as Z,V as ee,n as te,x as ae}from"./index-73afec2c.js";import{_ as oe}from"./WorkflowEditor-19bd62d4.js";import{_ as se}from"./_plugin-vue_export-helper-c27b6911.js";import"./MarkdownEditor-c6969eb6.js";import"./userDatabase-8c79f4f4.js";import"./UploaderFieldUse-97f91b3d.js";const le={key:0,class:"space-container"},re={style:{"margin-bottom":"10px"}},ne={style:{"margin-bottom":"10px"}},ce=["src"],ue=["src"],ie={__name:"WorkflowTemplate",setup(_e){const{t:s}=O(),S=v(!0),R=v(!1),A=q(),D=G(),h=H(),M=A.params.workflowTemplateId,e=v({});Q(async()=>{const c=await X("get_template",{tid:M});if(c.status!=200){m.error(s("workspace.workflowSpace.get_workflow_failed")),D.push({name:"Workspace"});return}e.value=c.data,S.value=!1});const E=async()=>{const c=await te("create",e.value);if(c.status==200)m.success(s("workspace.workflowTemplate.add_success"));else{m.error(s("workspace.workflowTemplate.add_failed"));return}const p=e.value;h.addUserWorkflow(p),h.setUserWorkflowsTotal(h.userWorkflowsTotal+1),D.push({name:"WorkflowUse",params:{workflowId:c.data.wid}})},B=v(null),$=()=>{B.value.showModal()},F=async c=>{const{title:p,brief:w,images:k,tags:d,workflow:g}=c;(await ae("update",{tid:M,title:p,brief:w,images:k,tags:d,data:g})).status==200?(m.success(s("workspace.workflowTemplate.update_success")),e.value.title=p,e.value.brief=w,e.value.images=k,e.value.tags=d,e.value.data=g):m.error(s("workspace.workflowTemplate.update_failed"))};return(c,p)=>{const w=o("a-skeleton"),k=o("router-link"),d=o("a-breadcrumb-item"),g=o("a-breadcrumb"),C=o("a-typography-title"),b=o("a-typography-text"),T=o("a-divider"),L=o("a-tag"),x=o("a-space"),U=o("a-button"),W=o("a-col"),j=o("a-row"),z=o("a-carousel"),J=o("a-spin"),K=Y("highlight");return S.value?(l(),y("div",le,[a(w,{active:""})])):(l(),_(J,{key:1,spinning:R.value,class:"space-container"},{default:t(()=>[a(g,null,{default:t(()=>[a(d,null,{default:t(()=>[a(k,{to:"/workflow?tab=official-workflow-templates"},{default:t(()=>[r(n(u(s)("workspace.workflowSpaceMain.official_workflow_template")),1)]),_:1})]),_:1}),a(d,null,{default:t(()=>[r(n(e.value.title),1)]),_:1})]),_:1}),a(j,{justify:"space-around"},{default:t(()=>[a(W,{lg:12,md:12,sm:24,xs:24},{default:t(()=>[a(C,null,{default:t(()=>[r(n(`${u(s)("workspace.workflowTemplate.template")}: ${e.value.title}`),1)]),_:1}),f("div",re,[a(x,null,{default:t(()=>[a(b,{type:"secondary"},{default:t(()=>[r(n(u(s)("common.update_time_format",{time:new Date(e.value.update_time).toLocaleString()})),1)]),_:1}),a(T,{type:"vertical"}),(l(!0),y(P,null,N(e.value.tags,(i,I)=>(l(),_(L,{color:i.color,key:I},{default:t(()=>[r(n(i.title),1)]),_:2},1032,["color"]))),128))]),_:1})]),f("div",ne,[a(x,null,{default:t(()=>[a(b,{type:"secondary"},{default:t(()=>[r(n(u(s)("workspace.workflowTemplate.author",{author:"VectorVein"})),1)]),_:1}),a(T,{type:"vertical"}),e.value.used_count>10?(l(),_(b,{key:0,type:"secondary"},{default:t(()=>[r(n(u(s)("workspace.workflowTemplate.used_count",{count:e.value.used_count})),1)]),_:1})):V("",!0)]),_:1})]),a(x,null,{default:t(()=>[a(U,{type:"primary",onClick:E},{default:t(()=>[r(n(u(s)("workspace.workflowTemplate.add_to_my_workflows")),1)]),_:1}),e.value.is_owner?(l(),_(U,{key:0,type:"primary",onClick:$},{default:t(()=>[r(n(u(s)("workspace.workflowTemplate.edit_template")),1)]),_:1})):V("",!0),(l(),_(oe,{ref_key:"editorModalRef",ref:B,title:e.value.title,brief:e.value.brief,images:e.value.images,tags:e.value.tags,key:e.value.wid,nodes:e.value.data.nodes,edges:e.value.data.edges,onOk:F},null,8,["title","brief","images","tags","nodes","edges"]))]),_:1})]),_:1})]),_:1}),a(T),a(j,{justify:"space-around"},{default:t(()=>[e.value.images.length>0?(l(),_(W,{key:0,lg:12,md:12,sm:24,xs:24},{default:t(()=>[a(z,{autoplay:"",arrows:"","dots-class":"slick-dots slick-thumb"},{customPaging:t(i=>[f("a",null,[f("img",{src:e.value.images[i.i]},null,8,ce)])]),default:t(()=>[(l(!0),y(P,null,N(e.value.images,(i,I)=>(l(),y("div",{key:I},[f("img",{src:i},null,8,ue)]))),128))]),_:1})]),_:1})):V("",!0),a(W,{lg:12,md:12,sm:24,xs:24},{default:t(()=>[Z(a(u(ee),{source:e.value.brief,class:"custom-scrollbar markdown-body custom-hljs"},null,8,["source"]),[[K]])]),_:1})]),_:1})]),_:1},8,["spinning"]))}}},ge=se(ie,[["__scopeId","data-v-15201269"]]);export{ge as default};
