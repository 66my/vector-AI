import{v as Zo,_ as Qo,a as Ko,b as en,c as tn,d as on,e as nn,f as an,g as ln,h as rn,i as sn,j as un,k as cn,l as dn,m as pn,n as fn,o as mn,p as vn,q as hn,r as gn,s as _n,t as yn,u as bn,w as wn,x as kn,y as Sn,z as En,A as Dn,B as xn,C as Cn,D as Tn,E as On,F as In,G as Nn,H as An,I as Pn,J as Mn,K as Vn,L as Fn}from"./style-2c7dc3f5.js";import{c as u,A as Un,g as Qt,u as _,w as Rn,d as jn,a as $n,b as ro,t as Bn,r as ae,e as ze,h as Xn,o as Yn,f as Ln,i as xo,j as Kt,k as Hn,n as io,l as D,m as Wn,p as T,q as W,s as f,v as Z,x as Le,F as Te,y as F,z as P,B as Ue,C as zn,D as Xe,E as so,G as Ht,V as Gn,H as qn,I as Jn,J as Zn,K as uo,L as Qn,M as Kn,N as ea,O as co,P as Pt,Q as mt,R as ta,S as po,T as oa,U as na,W as aa}from"./index-895b878c.js";import{u as la}from"./userDatabase-48b37114.js";import{_ as ra}from"./MarkdownEditor-02943b38.js";import{_ as Co}from"./UploaderFieldUse-20a1e061.js";import{F as ia,T as sa,_ as ua,a as ca,b as da,c as pa,d as fa}from"./EchartsRenderer-ac86fba1.js";import{_ as ma}from"./TemperatureInput-67f3c547.js";import{_ as eo}from"./_plugin-vue_export-helper-c27b6911.js";import{d as va}from"./database-35d490c6.js";import"./QuestionPopover-72e437d0.js";import"./stringify-ec884b6d.js";import"./index-7f383368.js";var ha={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.3 506.3L781.7 405.6a7.23 7.23 0 00-11.7 5.7V476H548V254h64.8c6 0 9.4-7 5.7-11.7L517.7 114.7a7.14 7.14 0 00-11.3 0L405.6 242.3a7.23 7.23 0 005.7 11.7H476v222H254v-64.8c0-6-7-9.4-11.7-5.7L114.7 506.3a7.14 7.14 0 000 11.3l127.5 100.8c4.7 3.7 11.7.4 11.7-5.7V548h222v222h-64.8c-6 0-9.4 7-5.7 11.7l100.8 127.5c2.9 3.7 8.5 3.7 11.3 0l100.8-127.5c3.7-4.7.4-11.7-5.7-11.7H548V548h222v64.8c0 6 7 9.4 11.7 5.7l127.5-100.8a7.3 7.3 0 00.1-11.4z"}}]},name:"drag",theme:"outlined"};const ga=ha;function fo(e){for(var o=1;o<arguments.length;o++){var t=arguments[o]!=null?Object(arguments[o]):{},n=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(t).filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable}))),n.forEach(function(a){_a(e,a,t[a])})}return e}function _a(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}var to=function(o,t){var n=fo({},o,t.attrs);return u(Un,fo({},n,{icon:ga}),null)};to.displayName="DragOutlined";to.inheritAttrs=!1;const Mt=to;var ya=Object.defineProperty,Et=Object.getOwnPropertySymbols,To=Object.prototype.hasOwnProperty,Oo=Object.prototype.propertyIsEnumerable,mo=(e,o,t)=>o in e?ya(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t,He=(e,o)=>{for(var t in o||(o={}))To.call(o,t)&&mo(e,t,o[t]);if(Et)for(var t of Et(o))Oo.call(o,t)&&mo(e,t,o[t]);return e},Io=(e,o)=>{var t={};for(var n in e)To.call(e,n)&&o.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&Et)for(var n of Et(e))o.indexOf(n)<0&&Oo.call(e,n)&&(t[n]=e[n]);return t};const No="[vue-draggable-plus]: ";function ba(e){console.warn(No+e)}function wa(e){console.error(No+e)}function ka(e,o,t){Array.isArray(e)&&t>=0&&t<e.length&&e.splice(t,0,e.splice(o,1)[0])}function Sa(e){return e.replace(/-(\w)/g,(o,t)=>t?t.toUpperCase():"")}function Ea(e){return Object.keys(e).reduce((o,t)=>(typeof e[t]<"u"&&(o[Sa(t)]=e[t]),o),{})}function Da(e,o){if(Array.isArray(e))return e.splice(o,1)}function xa(e,o,t){if(Array.isArray(e))return e.splice(o,0,t)}function Ca(e){return typeof e>"u"}function Ta(e){return typeof e=="string"}function vo(e,o,t){const n=e.children[t];e.insertBefore(o,n)}function Vt(e){e.parentNode&&e.parentNode.removeChild(e)}function Oa(e,o=document){var t;let n=null;return typeof(o==null?void 0:o.querySelector)=="function"?n=(t=o==null?void 0:o.querySelector)==null?void 0:t.call(o,e):n=document.querySelector(e),n||ba(`Element not found: ${e}`),n}function Ia(e,o,t=null){return function(...n){return e.apply(t,n),o.apply(t,n)}}function Na(e,o){const t=He({},e);return Object.keys(o).forEach(n=>{t[n]?t[n]=Ia(e[n],o[n]):t[n]=o[n]}),t}function Aa(e){return e instanceof HTMLElement}function Pa(e,o){Object.keys(e).forEach(t=>{o(t,e[t])})}/**!
 * Sortable 1.15.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function ho(e,o){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);o&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function ke(e){for(var o=1;o<arguments.length;o++){var t=arguments[o]!=null?arguments[o]:{};o%2?ho(Object(t),!0).forEach(function(n){Ma(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ho(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function yt(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?yt=function(o){return typeof o}:yt=function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},yt(e)}function Ma(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}function Ee(){return Ee=Object.assign||function(e){for(var o=1;o<arguments.length;o++){var t=arguments[o];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Ee.apply(this,arguments)}function Va(e,o){if(e==null)return{};var t={},n=Object.keys(e),a,l;for(l=0;l<n.length;l++)a=n[l],!(o.indexOf(a)>=0)&&(t[a]=e[a]);return t}function Fa(e,o){if(e==null)return{};var t=Va(e,o),n,a;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],!(o.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(t[n]=e[n])}return t}var Ua="1.15.0";function Se(e){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(e)}var De=Se(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),it=Se(/Edge/i),go=Se(/firefox/i),ot=Se(/safari/i)&&!Se(/chrome/i)&&!Se(/android/i),Ao=Se(/iP(ad|od|hone)/i),Po=Se(/chrome/i)&&Se(/android/i),Mo={capture:!1,passive:!1};function N(e,o,t){e.addEventListener(o,t,!De&&Mo)}function I(e,o,t){e.removeEventListener(o,t,!De&&Mo)}function Dt(e,o){if(o){if(o[0]===">"&&(o=o.substring(1)),e)try{if(e.matches)return e.matches(o);if(e.msMatchesSelector)return e.msMatchesSelector(o);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(o)}catch{return!1}return!1}}function Ra(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function be(e,o,t,n){if(e){t=t||document;do{if(o!=null&&(o[0]===">"?e.parentNode===t&&Dt(e,o):Dt(e,o))||n&&e===t)return e;if(e===t)break}while(e=Ra(e))}return null}var _o=/\s+/g;function pe(e,o,t){if(e&&o)if(e.classList)e.classList[t?"add":"remove"](o);else{var n=(" "+e.className+" ").replace(_o," ").replace(" "+o+" "," ");e.className=(n+(t?" "+o:"")).replace(_o," ")}}function S(e,o,t){var n=e&&e.style;if(n){if(t===void 0)return document.defaultView&&document.defaultView.getComputedStyle?t=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(t=e.currentStyle),o===void 0?t:t[o];!(o in n)&&o.indexOf("webkit")===-1&&(o="-webkit-"+o),n[o]=t+(typeof t=="string"?"":"px")}}function Ge(e,o){var t="";if(typeof e=="string")t=e;else do{var n=S(e,"transform");n&&n!=="none"&&(t=n+" "+t)}while(!o&&(e=e.parentNode));var a=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return a&&new a(t)}function Vo(e,o,t){if(e){var n=e.getElementsByTagName(o),a=0,l=n.length;if(t)for(;a<l;a++)t(n[a],a);return n}return[]}function we(){var e=document.scrollingElement;return e||document.documentElement}function G(e,o,t,n,a){if(!(!e.getBoundingClientRect&&e!==window)){var l,r,s,i,d,m,v;if(e!==window&&e.parentNode&&e!==we()?(l=e.getBoundingClientRect(),r=l.top,s=l.left,i=l.bottom,d=l.right,m=l.height,v=l.width):(r=0,s=0,i=window.innerHeight,d=window.innerWidth,m=window.innerHeight,v=window.innerWidth),(o||t)&&e!==window&&(a=a||e.parentNode,!De))do if(a&&a.getBoundingClientRect&&(S(a,"transform")!=="none"||t&&S(a,"position")!=="static")){var x=a.getBoundingClientRect();r-=x.top+parseInt(S(a,"border-top-width")),s-=x.left+parseInt(S(a,"border-left-width")),i=r+l.height,d=s+l.width;break}while(a=a.parentNode);if(n&&e!==window){var y=Ge(a||e),g=y&&y.a,b=y&&y.d;y&&(r/=b,s/=g,v/=g,m/=b,i=r+m,d=s+v)}return{top:r,left:s,bottom:i,right:d,width:v,height:m}}}function yo(e,o,t){for(var n=Ie(e,!0),a=G(e)[o];n;){var l=G(n)[t],r=void 0;if(t==="top"||t==="left"?r=a>=l:r=a<=l,!r)return n;if(n===we())break;n=Ie(n,!1)}return!1}function qe(e,o,t,n){for(var a=0,l=0,r=e.children;l<r.length;){if(r[l].style.display!=="none"&&r[l]!==E.ghost&&(n||r[l]!==E.dragged)&&be(r[l],t.draggable,e,!1)){if(a===o)return r[l];a++}l++}return null}function oo(e,o){for(var t=e.lastElementChild;t&&(t===E.ghost||S(t,"display")==="none"||o&&!Dt(t,o));)t=t.previousElementSibling;return t||null}function ge(e,o){var t=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)e.nodeName.toUpperCase()!=="TEMPLATE"&&e!==E.clone&&(!o||Dt(e,o))&&t++;return t}function bo(e){var o=0,t=0,n=we();if(e)do{var a=Ge(e),l=a.a,r=a.d;o+=e.scrollLeft*l,t+=e.scrollTop*r}while(e!==n&&(e=e.parentNode));return[o,t]}function ja(e,o){for(var t in e)if(e.hasOwnProperty(t)){for(var n in o)if(o.hasOwnProperty(n)&&o[n]===e[t][n])return Number(t)}return-1}function Ie(e,o){if(!e||!e.getBoundingClientRect)return we();var t=e,n=!1;do if(t.clientWidth<t.scrollWidth||t.clientHeight<t.scrollHeight){var a=S(t);if(t.clientWidth<t.scrollWidth&&(a.overflowX=="auto"||a.overflowX=="scroll")||t.clientHeight<t.scrollHeight&&(a.overflowY=="auto"||a.overflowY=="scroll")){if(!t.getBoundingClientRect||t===document.body)return we();if(n||o)return t;n=!0}}while(t=t.parentNode);return we()}function $a(e,o){if(e&&o)for(var t in o)o.hasOwnProperty(t)&&(e[t]=o[t]);return e}function Ft(e,o){return Math.round(e.top)===Math.round(o.top)&&Math.round(e.left)===Math.round(o.left)&&Math.round(e.height)===Math.round(o.height)&&Math.round(e.width)===Math.round(o.width)}var nt;function Fo(e,o){return function(){if(!nt){var t=arguments,n=this;t.length===1?e.call(n,t[0]):e.apply(n,t),nt=setTimeout(function(){nt=void 0},o)}}}function Ba(){clearTimeout(nt),nt=void 0}function Uo(e,o,t){e.scrollLeft+=o,e.scrollTop+=t}function Ro(e){var o=window.Polymer,t=window.jQuery||window.Zepto;return o&&o.dom?o.dom(e).cloneNode(!0):t?t(e).clone(!0)[0]:e.cloneNode(!0)}var me="Sortable"+new Date().getTime();function Xa(){var e=[],o;return{captureAnimationState:function(){if(e=[],!!this.options.animation){var t=[].slice.call(this.el.children);t.forEach(function(n){if(!(S(n,"display")==="none"||n===E.ghost)){e.push({target:n,rect:G(n)});var a=ke({},e[e.length-1].rect);if(n.thisAnimationDuration){var l=Ge(n,!0);l&&(a.top-=l.f,a.left-=l.e)}n.fromRect=a}})}},addAnimationState:function(t){e.push(t)},removeAnimationState:function(t){e.splice(ja(e,{target:t}),1)},animateAll:function(t){var n=this;if(!this.options.animation){clearTimeout(o),typeof t=="function"&&t();return}var a=!1,l=0;e.forEach(function(r){var s=0,i=r.target,d=i.fromRect,m=G(i),v=i.prevFromRect,x=i.prevToRect,y=r.rect,g=Ge(i,!0);g&&(m.top-=g.f,m.left-=g.e),i.toRect=m,i.thisAnimationDuration&&Ft(v,m)&&!Ft(d,m)&&(y.top-m.top)/(y.left-m.left)===(d.top-m.top)/(d.left-m.left)&&(s=La(y,v,x,n.options)),Ft(m,d)||(i.prevFromRect=d,i.prevToRect=m,s||(s=n.options.animation),n.animate(i,y,m,s)),s&&(a=!0,l=Math.max(l,s),clearTimeout(i.animationResetTimer),i.animationResetTimer=setTimeout(function(){i.animationTime=0,i.prevFromRect=null,i.fromRect=null,i.prevToRect=null,i.thisAnimationDuration=null},s),i.thisAnimationDuration=s)}),clearTimeout(o),a?o=setTimeout(function(){typeof t=="function"&&t()},l):typeof t=="function"&&t(),e=[]},animate:function(t,n,a,l){if(l){S(t,"transition",""),S(t,"transform","");var r=Ge(this.el),s=r&&r.a,i=r&&r.d,d=(n.left-a.left)/(s||1),m=(n.top-a.top)/(i||1);t.animatingX=!!d,t.animatingY=!!m,S(t,"transform","translate3d("+d+"px,"+m+"px,0)"),this.forRepaintDummy=Ya(t),S(t,"transition","transform "+l+"ms"+(this.options.easing?" "+this.options.easing:"")),S(t,"transform","translate3d(0,0,0)"),typeof t.animated=="number"&&clearTimeout(t.animated),t.animated=setTimeout(function(){S(t,"transition",""),S(t,"transform",""),t.animated=!1,t.animatingX=!1,t.animatingY=!1},l)}}}}function Ya(e){return e.offsetWidth}function La(e,o,t,n){return Math.sqrt(Math.pow(o.top-e.top,2)+Math.pow(o.left-e.left,2))/Math.sqrt(Math.pow(o.top-t.top,2)+Math.pow(o.left-t.left,2))*n.animation}var $e=[],Ut={initializeByDefault:!0},st={mount:function(e){for(var o in Ut)Ut.hasOwnProperty(o)&&!(o in e)&&(e[o]=Ut[o]);$e.forEach(function(t){if(t.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),$e.push(e)},pluginEvent:function(e,o,t){var n=this;this.eventCanceled=!1,t.cancel=function(){n.eventCanceled=!0};var a=e+"Global";$e.forEach(function(l){o[l.pluginName]&&(o[l.pluginName][a]&&o[l.pluginName][a](ke({sortable:o},t)),o.options[l.pluginName]&&o[l.pluginName][e]&&o[l.pluginName][e](ke({sortable:o},t)))})},initializePlugins:function(e,o,t,n){$e.forEach(function(r){var s=r.pluginName;if(!(!e.options[s]&&!r.initializeByDefault)){var i=new r(e,o,e.options);i.sortable=e,i.options=e.options,e[s]=i,Ee(t,i.defaults)}});for(var a in e.options)if(e.options.hasOwnProperty(a)){var l=this.modifyOption(e,a,e.options[a]);typeof l<"u"&&(e.options[a]=l)}},getEventProperties:function(e,o){var t={};return $e.forEach(function(n){typeof n.eventProperties=="function"&&Ee(t,n.eventProperties.call(o[n.pluginName],e))}),t},modifyOption:function(e,o,t){var n;return $e.forEach(function(a){e[a.pluginName]&&a.optionListeners&&typeof a.optionListeners[o]=="function"&&(n=a.optionListeners[o].call(e[a.pluginName],t))}),n}};function Ha(e){var o=e.sortable,t=e.rootEl,n=e.name,a=e.targetEl,l=e.cloneEl,r=e.toEl,s=e.fromEl,i=e.oldIndex,d=e.newIndex,m=e.oldDraggableIndex,v=e.newDraggableIndex,x=e.originalEvent,y=e.putSortable,g=e.extraEventProperties;if(o=o||t&&t[me],!!o){var b,X=o.options,M="on"+n.charAt(0).toUpperCase()+n.substr(1);window.CustomEvent&&!De&&!it?b=new CustomEvent(n,{bubbles:!0,cancelable:!0}):(b=document.createEvent("Event"),b.initEvent(n,!0,!0)),b.to=r||t,b.from=s||t,b.item=a||t,b.clone=l,b.oldIndex=i,b.newIndex=d,b.oldDraggableIndex=m,b.newDraggableIndex=v,b.originalEvent=x,b.pullMode=y?y.lastPutMode:void 0;var R=ke(ke({},g),st.getEventProperties(n,o));for(var j in R)b[j]=R[j];t&&t.dispatchEvent(b),X[M]&&X[M].call(o,b)}}var Wa=["evt"],ce=function(e,o){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=t.evt,a=Fa(t,Wa);st.pluginEvent.bind(E)(e,o,ke({dragEl:c,parentEl:B,ghostEl:C,rootEl:U,nextEl:Fe,lastDownEl:bt,cloneEl:$,cloneHidden:Oe,dragStarted:Ke,putSortable:Q,activeSortable:E.active,originalEvent:n,oldIndex:We,oldDraggableIndex:at,newIndex:fe,newDraggableIndex:Ce,hideGhostForTarget:Xo,unhideGhostForTarget:Yo,cloneNowHidden:function(){Oe=!0},cloneNowShown:function(){Oe=!1},dispatchSortableEvent:function(l){ie({sortable:o,name:l,originalEvent:n})}},a))};function ie(e){Ha(ke({putSortable:Q,cloneEl:$,targetEl:c,rootEl:U,oldIndex:We,oldDraggableIndex:at,newIndex:fe,newDraggableIndex:Ce},e))}var c,B,C,U,Fe,bt,$,Oe,We,fe,at,Ce,vt,Q,Ye=!1,xt=!1,Ct=[],Me,ye,Rt,jt,wo,ko,Ke,Be,lt,rt=!1,ht=!1,wt,ne,$t=[],Wt=!1,Tt=[],It=typeof document<"u",gt=Ao,So=it||De?"cssFloat":"float",za=It&&!Po&&!Ao&&"draggable"in document.createElement("div"),jo=function(){if(It){if(De)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto",e.style.pointerEvents==="auto"}}(),$o=function(e,o){var t=S(e),n=parseInt(t.width)-parseInt(t.paddingLeft)-parseInt(t.paddingRight)-parseInt(t.borderLeftWidth)-parseInt(t.borderRightWidth),a=qe(e,0,o),l=qe(e,1,o),r=a&&S(a),s=l&&S(l),i=r&&parseInt(r.marginLeft)+parseInt(r.marginRight)+G(a).width,d=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+G(l).width;if(t.display==="flex")return t.flexDirection==="column"||t.flexDirection==="column-reverse"?"vertical":"horizontal";if(t.display==="grid")return t.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(a&&r.float&&r.float!=="none"){var m=r.float==="left"?"left":"right";return l&&(s.clear==="both"||s.clear===m)?"vertical":"horizontal"}return a&&(r.display==="block"||r.display==="flex"||r.display==="table"||r.display==="grid"||i>=n&&t[So]==="none"||l&&t[So]==="none"&&i+d>n)?"vertical":"horizontal"},Ga=function(e,o,t){var n=t?e.left:e.top,a=t?e.right:e.bottom,l=t?e.width:e.height,r=t?o.left:o.top,s=t?o.right:o.bottom,i=t?o.width:o.height;return n===r||a===s||n+l/2===r+i/2},qa=function(e,o){var t;return Ct.some(function(n){var a=n[me].options.emptyInsertThreshold;if(!(!a||oo(n))){var l=G(n),r=e>=l.left-a&&e<=l.right+a,s=o>=l.top-a&&o<=l.bottom+a;if(r&&s)return t=n}}),t},Bo=function(e){function o(a,l){return function(r,s,i,d){var m=r.options.group.name&&s.options.group.name&&r.options.group.name===s.options.group.name;if(a==null&&(l||m))return!0;if(a==null||a===!1)return!1;if(l&&a==="clone")return a;if(typeof a=="function")return o(a(r,s,i,d),l)(r,s,i,d);var v=(l?r:s).options.group.name;return a===!0||typeof a=="string"&&a===v||a.join&&a.indexOf(v)>-1}}var t={},n=e.group;(!n||yt(n)!="object")&&(n={name:n}),t.name=n.name,t.checkPull=o(n.pull,!0),t.checkPut=o(n.put),t.revertClone=n.revertClone,e.group=t},Xo=function(){!jo&&C&&S(C,"display","none")},Yo=function(){!jo&&C&&S(C,"display","")};It&&!Po&&document.addEventListener("click",function(e){if(xt)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),xt=!1,!1},!0);var Ve=function(e){if(c){e=e.touches?e.touches[0]:e;var o=qa(e.clientX,e.clientY);if(o){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.target=t.rootEl=o,t.preventDefault=void 0,t.stopPropagation=void 0,o[me]._onDragOver(t)}}},Ja=function(e){c&&c.parentNode[me]._isOutsideThisEl(e.target)};function E(e,o){if(!(e&&e.nodeType&&e.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=o=Ee({},o),e[me]=this;var t={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return $o(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(l,r){l.setData("Text",r.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:E.supportPointer!==!1&&"PointerEvent"in window&&!ot,emptyInsertThreshold:5};st.initializePlugins(this,e,t);for(var n in t)!(n in o)&&(o[n]=t[n]);Bo(o);for(var a in this)a.charAt(0)==="_"&&typeof this[a]=="function"&&(this[a]=this[a].bind(this));this.nativeDraggable=o.forceFallback?!1:za,this.nativeDraggable&&(this.options.touchStartThreshold=1),o.supportPointer?N(e,"pointerdown",this._onTapStart):(N(e,"mousedown",this._onTapStart),N(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(N(e,"dragover",this),N(e,"dragenter",this)),Ct.push(this.el),o.store&&o.store.get&&this.sort(o.store.get(this)||[]),Ee(this,Xa())}E.prototype={constructor:E,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(Be=null)},_getDirection:function(e,o){return typeof this.options.direction=="function"?this.options.direction.call(this,e,o,c):this.options.direction},_onTapStart:function(e){if(e.cancelable){var o=this,t=this.el,n=this.options,a=n.preventOnFilter,l=e.type,r=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,s=(r||e).target,i=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||s,d=n.filter;if(al(t),!c&&!(/mousedown|pointerdown/.test(l)&&e.button!==0||n.disabled)&&!i.isContentEditable&&!(!this.nativeDraggable&&ot&&s&&s.tagName.toUpperCase()==="SELECT")&&(s=be(s,n.draggable,t,!1),!(s&&s.animated)&&bt!==s)){if(We=ge(s),at=ge(s,n.draggable),typeof d=="function"){if(d.call(this,e,s,this)){ie({sortable:o,rootEl:i,name:"filter",targetEl:s,toEl:t,fromEl:t}),ce("filter",o,{evt:e}),a&&e.cancelable&&e.preventDefault();return}}else if(d&&(d=d.split(",").some(function(m){if(m=be(i,m.trim(),t,!1),m)return ie({sortable:o,rootEl:m,name:"filter",targetEl:s,fromEl:t,toEl:t}),ce("filter",o,{evt:e}),!0}),d)){a&&e.cancelable&&e.preventDefault();return}n.handle&&!be(i,n.handle,t,!1)||this._prepareDragStart(e,r,s)}}},_prepareDragStart:function(e,o,t){var n=this,a=n.el,l=n.options,r=a.ownerDocument,s;if(t&&!c&&t.parentNode===a){var i=G(t);if(U=a,c=t,B=c.parentNode,Fe=c.nextSibling,bt=t,vt=l.group,E.dragged=c,Me={target:c,clientX:(o||e).clientX,clientY:(o||e).clientY},wo=Me.clientX-i.left,ko=Me.clientY-i.top,this._lastX=(o||e).clientX,this._lastY=(o||e).clientY,c.style["will-change"]="all",s=function(){if(ce("delayEnded",n,{evt:e}),E.eventCanceled){n._onDrop();return}n._disableDelayedDragEvents(),!go&&n.nativeDraggable&&(c.draggable=!0),n._triggerDragStart(e,o),ie({sortable:n,name:"choose",originalEvent:e}),pe(c,l.chosenClass,!0)},l.ignore.split(",").forEach(function(d){Vo(c,d.trim(),Bt)}),N(r,"dragover",Ve),N(r,"mousemove",Ve),N(r,"touchmove",Ve),N(r,"mouseup",n._onDrop),N(r,"touchend",n._onDrop),N(r,"touchcancel",n._onDrop),go&&this.nativeDraggable&&(this.options.touchStartThreshold=4,c.draggable=!0),ce("delayStart",this,{evt:e}),l.delay&&(!l.delayOnTouchOnly||o)&&(!this.nativeDraggable||!(it||De))){if(E.eventCanceled){this._onDrop();return}N(r,"mouseup",n._disableDelayedDrag),N(r,"touchend",n._disableDelayedDrag),N(r,"touchcancel",n._disableDelayedDrag),N(r,"mousemove",n._delayedDragTouchMoveHandler),N(r,"touchmove",n._delayedDragTouchMoveHandler),l.supportPointer&&N(r,"pointermove",n._delayedDragTouchMoveHandler),n._dragStartTimer=setTimeout(s,l.delay)}else s()}},_delayedDragTouchMoveHandler:function(e){var o=e.touches?e.touches[0]:e;Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){c&&Bt(c),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;I(e,"mouseup",this._disableDelayedDrag),I(e,"touchend",this._disableDelayedDrag),I(e,"touchcancel",this._disableDelayedDrag),I(e,"mousemove",this._delayedDragTouchMoveHandler),I(e,"touchmove",this._delayedDragTouchMoveHandler),I(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,o){o=o||e.pointerType=="touch"&&e,!this.nativeDraggable||o?this.options.supportPointer?N(document,"pointermove",this._onTouchMove):o?N(document,"touchmove",this._onTouchMove):N(document,"mousemove",this._onTouchMove):(N(c,"dragend",this),N(U,"dragstart",this._onDragStart));try{document.selection?kt(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,o){if(Ye=!1,U&&c){ce("dragStarted",this,{evt:o}),this.nativeDraggable&&N(document,"dragover",Ja);var t=this.options;!e&&pe(c,t.dragClass,!1),pe(c,t.ghostClass,!0),E.active=this,e&&this._appendGhost(),ie({sortable:this,name:"start",originalEvent:o})}else this._nulling()},_emulateDragOver:function(){if(ye){this._lastX=ye.clientX,this._lastY=ye.clientY,Xo();for(var e=document.elementFromPoint(ye.clientX,ye.clientY),o=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(ye.clientX,ye.clientY),e!==o);)o=e;if(c.parentNode[me]._isOutsideThisEl(e),o)do{if(o[me]){var t=void 0;if(t=o[me]._onDragOver({clientX:ye.clientX,clientY:ye.clientY,target:e,rootEl:o}),t&&!this.options.dragoverBubble)break}e=o}while(o=o.parentNode);Yo()}},_onTouchMove:function(e){if(Me){var o=this.options,t=o.fallbackTolerance,n=o.fallbackOffset,a=e.touches?e.touches[0]:e,l=C&&Ge(C,!0),r=C&&l&&l.a,s=C&&l&&l.d,i=gt&&ne&&bo(ne),d=(a.clientX-Me.clientX+n.x)/(r||1)+(i?i[0]-$t[0]:0)/(r||1),m=(a.clientY-Me.clientY+n.y)/(s||1)+(i?i[1]-$t[1]:0)/(s||1);if(!E.active&&!Ye){if(t&&Math.max(Math.abs(a.clientX-this._lastX),Math.abs(a.clientY-this._lastY))<t)return;this._onDragStart(e,!0)}if(C){l?(l.e+=d-(Rt||0),l.f+=m-(jt||0)):l={a:1,b:0,c:0,d:1,e:d,f:m};var v="matrix(".concat(l.a,",").concat(l.b,",").concat(l.c,",").concat(l.d,",").concat(l.e,",").concat(l.f,")");S(C,"webkitTransform",v),S(C,"mozTransform",v),S(C,"msTransform",v),S(C,"transform",v),Rt=d,jt=m,ye=a}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!C){var e=this.options.fallbackOnBody?document.body:U,o=G(c,!0,gt,!0,e),t=this.options;if(gt){for(ne=e;S(ne,"position")==="static"&&S(ne,"transform")==="none"&&ne!==document;)ne=ne.parentNode;ne!==document.body&&ne!==document.documentElement?(ne===document&&(ne=we()),o.top+=ne.scrollTop,o.left+=ne.scrollLeft):ne=we(),$t=bo(ne)}C=c.cloneNode(!0),pe(C,t.ghostClass,!1),pe(C,t.fallbackClass,!0),pe(C,t.dragClass,!0),S(C,"transition",""),S(C,"transform",""),S(C,"box-sizing","border-box"),S(C,"margin",0),S(C,"top",o.top),S(C,"left",o.left),S(C,"width",o.width),S(C,"height",o.height),S(C,"opacity","0.8"),S(C,"position",gt?"absolute":"fixed"),S(C,"zIndex","100000"),S(C,"pointerEvents","none"),E.ghost=C,e.appendChild(C),S(C,"transform-origin",wo/parseInt(C.style.width)*100+"% "+ko/parseInt(C.style.height)*100+"%")}},_onDragStart:function(e,o){var t=this,n=e.dataTransfer,a=t.options;if(ce("dragStart",this,{evt:e}),E.eventCanceled){this._onDrop();return}ce("setupClone",this),E.eventCanceled||($=Ro(c),$.removeAttribute("id"),$.draggable=!1,$.style["will-change"]="",this._hideClone(),pe($,this.options.chosenClass,!1),E.clone=$),t.cloneId=kt(function(){ce("clone",t),!E.eventCanceled&&(t.options.removeCloneOnHide||U.insertBefore($,c),t._hideClone(),ie({sortable:t,name:"clone"}))}),!o&&pe(c,a.dragClass,!0),o?(xt=!0,t._loopId=setInterval(t._emulateDragOver,50)):(I(document,"mouseup",t._onDrop),I(document,"touchend",t._onDrop),I(document,"touchcancel",t._onDrop),n&&(n.effectAllowed="move",a.setData&&a.setData.call(t,n,c)),N(document,"drop",t),S(c,"transform","translateZ(0)")),Ye=!0,t._dragStartId=kt(t._dragStarted.bind(t,o,e)),N(document,"selectstart",t),Ke=!0,ot&&S(document.body,"user-select","none")},_onDragOver:function(e){var o=this.el,t=e.target,n,a,l,r=this.options,s=r.group,i=E.active,d=vt===s,m=r.sort,v=Q||i,x,y=this,g=!1;if(Wt)return;function b(de,Ne){ce(de,y,ke({evt:e,isOwner:d,axis:x?"vertical":"horizontal",revert:l,dragRect:n,targetRect:a,canSort:m,fromSortable:v,target:t,completed:M,onMove:function(Re,L){return _t(U,o,c,n,Re,G(Re),e,L)},changed:R},Ne))}function X(){b("dragOverAnimationCapture"),y.captureAnimationState(),y!==v&&v.captureAnimationState()}function M(de){return b("dragOverCompleted",{insertion:de}),de&&(d?i._hideClone():i._showClone(y),y!==v&&(pe(c,Q?Q.options.ghostClass:i.options.ghostClass,!1),pe(c,r.ghostClass,!0)),Q!==y&&y!==E.active?Q=y:y===E.active&&Q&&(Q=null),v===y&&(y._ignoreWhileAnimating=t),y.animateAll(function(){b("dragOverAnimationComplete"),y._ignoreWhileAnimating=null}),y!==v&&(v.animateAll(),v._ignoreWhileAnimating=null)),(t===c&&!c.animated||t===o&&!t.animated)&&(Be=null),!r.dragoverBubble&&!e.rootEl&&t!==document&&(c.parentNode[me]._isOutsideThisEl(e.target),!de&&Ve(e)),!r.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),g=!0}function R(){fe=ge(c),Ce=ge(c,r.draggable),ie({sortable:y,name:"change",toEl:o,newIndex:fe,newDraggableIndex:Ce,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),t=be(t,r.draggable,o,!0),b("dragOver"),E.eventCanceled)return g;if(c.contains(e.target)||t.animated&&t.animatingX&&t.animatingY||y._ignoreWhileAnimating===t)return M(!1);if(xt=!1,i&&!r.disabled&&(d?m||(l=B!==U):Q===this||(this.lastPutMode=vt.checkPull(this,i,c,e))&&s.checkPut(this,i,c,e))){if(x=this._getDirection(e,t)==="vertical",n=G(c),b("dragOverValid"),E.eventCanceled)return g;if(l)return B=U,X(),this._hideClone(),b("revert"),E.eventCanceled||(Fe?U.insertBefore(c,Fe):U.appendChild(c)),M(!0);var j=oo(o,r.draggable);if(!j||el(e,x,this)&&!j.animated){if(j===c)return M(!1);if(j&&o===e.target&&(t=j),t&&(a=G(t)),_t(U,o,c,n,t,a,e,!!t)!==!1)return X(),j&&j.nextSibling?o.insertBefore(c,j.nextSibling):o.appendChild(c),B=o,R(),M(!0)}else if(j&&Ka(e,x,this)){var le=qe(o,0,r,!0);if(le===c)return M(!1);if(t=le,a=G(t),_t(U,o,c,n,t,a,e,!1)!==!1)return X(),o.insertBefore(c,le),B=o,R(),M(!0)}else if(t.parentNode===o){a=G(t);var k=0,O,K=c.parentNode!==o,q=!Ga(c.animated&&c.toRect||n,t.animated&&t.toRect||a,x),Y=x?"top":"left",se=yo(t,"top","top")||yo(c,"top","top"),xe=se?se.scrollTop:void 0;Be!==t&&(O=a[Y],rt=!1,ht=!q&&r.invertSwap||K),k=tl(e,t,a,x,q?1:r.swapThreshold,r.invertedSwapThreshold==null?r.swapThreshold:r.invertedSwapThreshold,ht,Be===t);var ee;if(k!==0){var te=ge(c);do te-=k,ee=B.children[te];while(ee&&(S(ee,"display")==="none"||ee===C))}if(k===0||ee===t)return M(!1);Be=t,lt=k;var re=t.nextElementSibling,ve=!1;ve=k===1;var _e=_t(U,o,c,n,t,a,e,ve);if(_e!==!1)return(_e===1||_e===-1)&&(ve=_e===1),Wt=!0,setTimeout(Qa,30),X(),ve&&!re?o.appendChild(c):t.parentNode.insertBefore(c,ve?re:t),se&&Uo(se,0,xe-se.scrollTop),B=c.parentNode,O!==void 0&&!ht&&(wt=Math.abs(O-G(t)[Y])),R(),M(!0)}if(o.contains(c))return M(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){I(document,"mousemove",this._onTouchMove),I(document,"touchmove",this._onTouchMove),I(document,"pointermove",this._onTouchMove),I(document,"dragover",Ve),I(document,"mousemove",Ve),I(document,"touchmove",Ve)},_offUpEvents:function(){var e=this.el.ownerDocument;I(e,"mouseup",this._onDrop),I(e,"touchend",this._onDrop),I(e,"pointerup",this._onDrop),I(e,"touchcancel",this._onDrop),I(document,"selectstart",this)},_onDrop:function(e){var o=this.el,t=this.options;if(fe=ge(c),Ce=ge(c,t.draggable),ce("drop",this,{evt:e}),B=c&&c.parentNode,fe=ge(c),Ce=ge(c,t.draggable),E.eventCanceled){this._nulling();return}Ye=!1,ht=!1,rt=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),zt(this.cloneId),zt(this._dragStartId),this.nativeDraggable&&(I(document,"drop",this),I(o,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),ot&&S(document.body,"user-select",""),S(c,"transform",""),e&&(Ke&&(e.cancelable&&e.preventDefault(),!t.dropBubble&&e.stopPropagation()),C&&C.parentNode&&C.parentNode.removeChild(C),(U===B||Q&&Q.lastPutMode!=="clone")&&$&&$.parentNode&&$.parentNode.removeChild($),c&&(this.nativeDraggable&&I(c,"dragend",this),Bt(c),c.style["will-change"]="",Ke&&!Ye&&pe(c,Q?Q.options.ghostClass:this.options.ghostClass,!1),pe(c,this.options.chosenClass,!1),ie({sortable:this,name:"unchoose",toEl:B,newIndex:null,newDraggableIndex:null,originalEvent:e}),U!==B?(fe>=0&&(ie({rootEl:B,name:"add",toEl:B,fromEl:U,originalEvent:e}),ie({sortable:this,name:"remove",toEl:B,originalEvent:e}),ie({rootEl:B,name:"sort",toEl:B,fromEl:U,originalEvent:e}),ie({sortable:this,name:"sort",toEl:B,originalEvent:e})),Q&&Q.save()):fe!==We&&fe>=0&&(ie({sortable:this,name:"update",toEl:B,originalEvent:e}),ie({sortable:this,name:"sort",toEl:B,originalEvent:e})),E.active&&((fe==null||fe===-1)&&(fe=We,Ce=at),ie({sortable:this,name:"end",toEl:B,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){ce("nulling",this),U=c=B=C=Fe=$=bt=Oe=Me=ye=Ke=fe=Ce=We=at=Be=lt=Q=vt=E.dragged=E.ghost=E.clone=E.active=null,Tt.forEach(function(e){e.checked=!0}),Tt.length=Rt=jt=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":c&&(this._onDragOver(e),Za(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],o,t=this.el.children,n=0,a=t.length,l=this.options;n<a;n++)o=t[n],be(o,l.draggable,this.el,!1)&&e.push(o.getAttribute(l.dataIdAttr)||nl(o));return e},sort:function(e,o){var t={},n=this.el;this.toArray().forEach(function(a,l){var r=n.children[l];be(r,this.options.draggable,n,!1)&&(t[a]=r)},this),o&&this.captureAnimationState(),e.forEach(function(a){t[a]&&(n.removeChild(t[a]),n.appendChild(t[a]))}),o&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,o){return be(e,o||this.options.draggable,this.el,!1)},option:function(e,o){var t=this.options;if(o===void 0)return t[e];var n=st.modifyOption(this,e,o);typeof n<"u"?t[e]=n:t[e]=o,e==="group"&&Bo(t)},destroy:function(){ce("destroy",this);var e=this.el;e[me]=null,I(e,"mousedown",this._onTapStart),I(e,"touchstart",this._onTapStart),I(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(I(e,"dragover",this),I(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(o){o.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Ct.splice(Ct.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!Oe){if(ce("hideClone",this),E.eventCanceled)return;S($,"display","none"),this.options.removeCloneOnHide&&$.parentNode&&$.parentNode.removeChild($),Oe=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(Oe){if(ce("showClone",this),E.eventCanceled)return;c.parentNode==U&&!this.options.group.revertClone?U.insertBefore($,c):Fe?U.insertBefore($,Fe):U.appendChild($),this.options.group.revertClone&&this.animate(c,$),S($,"display",""),Oe=!1}}};function Za(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move"),e.cancelable&&e.preventDefault()}function _t(e,o,t,n,a,l,r,s){var i,d=e[me],m=d.options.onMove,v;return window.CustomEvent&&!De&&!it?i=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(i=document.createEvent("Event"),i.initEvent("move",!0,!0)),i.to=o,i.from=e,i.dragged=t,i.draggedRect=n,i.related=a||o,i.relatedRect=l||G(o),i.willInsertAfter=s,i.originalEvent=r,e.dispatchEvent(i),m&&(v=m.call(d,i,r)),v}function Bt(e){e.draggable=!1}function Qa(){Wt=!1}function Ka(e,o,t){var n=G(qe(t.el,0,t.options,!0)),a=10;return o?e.clientX<n.left-a||e.clientY<n.top&&e.clientX<n.right:e.clientY<n.top-a||e.clientY<n.bottom&&e.clientX<n.left}function el(e,o,t){var n=G(oo(t.el,t.options.draggable)),a=10;return o?e.clientX>n.right+a||e.clientX<=n.right&&e.clientY>n.bottom&&e.clientX>=n.left:e.clientX>n.right&&e.clientY>n.top||e.clientX<=n.right&&e.clientY>n.bottom+a}function tl(e,o,t,n,a,l,r,s){var i=n?e.clientY:e.clientX,d=n?t.height:t.width,m=n?t.top:t.left,v=n?t.bottom:t.right,x=!1;if(!r){if(s&&wt<d*a){if(!rt&&(lt===1?i>m+d*l/2:i<v-d*l/2)&&(rt=!0),rt)x=!0;else if(lt===1?i<m+wt:i>v-wt)return-lt}else if(i>m+d*(1-a)/2&&i<v-d*(1-a)/2)return ol(o)}return x=x||r,x&&(i<m+d*l/2||i>v-d*l/2)?i>m+d/2?1:-1:0}function ol(e){return ge(c)<ge(e)?1:-1}function nl(e){for(var o=e.tagName+e.className+e.src+e.href+e.textContent,t=o.length,n=0;t--;)n+=o.charCodeAt(t);return n.toString(36)}function al(e){Tt.length=0;for(var o=e.getElementsByTagName("input"),t=o.length;t--;){var n=o[t];n.checked&&Tt.push(n)}}function kt(e){return setTimeout(e,0)}function zt(e){return clearTimeout(e)}It&&N(document,"touchmove",function(e){(E.active||Ye)&&e.cancelable&&e.preventDefault()});E.utils={on:N,off:I,css:S,find:Vo,is:function(e,o){return!!be(e,o,e,!1)},extend:$a,throttle:Fo,closest:be,toggleClass:pe,clone:Ro,index:ge,nextTick:kt,cancelNextTick:zt,detectDirection:$o,getChild:qe};E.get=function(e){return e[me]};E.mount=function(){for(var e=arguments.length,o=new Array(e),t=0;t<e;t++)o[t]=arguments[t];o[0].constructor===Array&&(o=o[0]),o.forEach(function(n){if(!n.prototype||!n.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(n));n.utils&&(E.utils=ke(ke({},E.utils),n.utils)),st.mount(n)})};E.create=function(e,o){return new E(e,o)};E.version=Ua;var z=[],et,Gt,qt=!1,Xt,Yt,Ot,tt;function ll(){function e(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var o in this)o.charAt(0)==="_"&&typeof this[o]=="function"&&(this[o]=this[o].bind(this))}return e.prototype={dragStarted:function(o){var t=o.originalEvent;this.sortable.nativeDraggable?N(document,"dragover",this._handleAutoScroll):this.options.supportPointer?N(document,"pointermove",this._handleFallbackAutoScroll):t.touches?N(document,"touchmove",this._handleFallbackAutoScroll):N(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(o){var t=o.originalEvent;!this.options.dragOverBubble&&!t.rootEl&&this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?I(document,"dragover",this._handleAutoScroll):(I(document,"pointermove",this._handleFallbackAutoScroll),I(document,"touchmove",this._handleFallbackAutoScroll),I(document,"mousemove",this._handleFallbackAutoScroll)),Eo(),St(),Ba()},nulling:function(){Ot=Gt=et=qt=tt=Xt=Yt=null,z.length=0},_handleFallbackAutoScroll:function(o){this._handleAutoScroll(o,!0)},_handleAutoScroll:function(o,t){var n=this,a=(o.touches?o.touches[0]:o).clientX,l=(o.touches?o.touches[0]:o).clientY,r=document.elementFromPoint(a,l);if(Ot=o,t||this.options.forceAutoScrollFallback||it||De||ot){Lt(o,this.options,r,t);var s=Ie(r,!0);qt&&(!tt||a!==Xt||l!==Yt)&&(tt&&Eo(),tt=setInterval(function(){var i=Ie(document.elementFromPoint(a,l),!0);i!==s&&(s=i,St()),Lt(o,n.options,i,t)},10),Xt=a,Yt=l)}else{if(!this.options.bubbleScroll||Ie(r,!0)===we()){St();return}Lt(o,this.options,Ie(r,!1),!1)}}},Ee(e,{pluginName:"scroll",initializeByDefault:!0})}function St(){z.forEach(function(e){clearInterval(e.pid)}),z=[]}function Eo(){clearInterval(tt)}var Lt=Fo(function(e,o,t,n){if(o.scroll){var a=(e.touches?e.touches[0]:e).clientX,l=(e.touches?e.touches[0]:e).clientY,r=o.scrollSensitivity,s=o.scrollSpeed,i=we(),d=!1,m;Gt!==t&&(Gt=t,St(),et=o.scroll,m=o.scrollFn,et===!0&&(et=Ie(t,!0)));var v=0,x=et;do{var y=x,g=G(y),b=g.top,X=g.bottom,M=g.left,R=g.right,j=g.width,le=g.height,k=void 0,O=void 0,K=y.scrollWidth,q=y.scrollHeight,Y=S(y),se=y.scrollLeft,xe=y.scrollTop;y===i?(k=j<K&&(Y.overflowX==="auto"||Y.overflowX==="scroll"||Y.overflowX==="visible"),O=le<q&&(Y.overflowY==="auto"||Y.overflowY==="scroll"||Y.overflowY==="visible")):(k=j<K&&(Y.overflowX==="auto"||Y.overflowX==="scroll"),O=le<q&&(Y.overflowY==="auto"||Y.overflowY==="scroll"));var ee=k&&(Math.abs(R-a)<=r&&se+j<K)-(Math.abs(M-a)<=r&&!!se),te=O&&(Math.abs(X-l)<=r&&xe+le<q)-(Math.abs(b-l)<=r&&!!xe);if(!z[v])for(var re=0;re<=v;re++)z[re]||(z[re]={});(z[v].vx!=ee||z[v].vy!=te||z[v].el!==y)&&(z[v].el=y,z[v].vx=ee,z[v].vy=te,clearInterval(z[v].pid),(ee!=0||te!=0)&&(d=!0,z[v].pid=setInterval((function(){n&&this.layer===0&&E.active._onTouchMove(Ot);var ve=z[this.layer].vy?z[this.layer].vy*s:0,_e=z[this.layer].vx?z[this.layer].vx*s:0;typeof m=="function"&&m.call(E.dragged.parentNode[me],_e,ve,e,Ot,z[this.layer].el)!=="continue"||Uo(z[this.layer].el,_e,ve)}).bind({layer:v}),24))),v++}while(o.bubbleScroll&&x!==i&&(x=Ie(x,!1)));qt=d}},30),Lo=function(e){var o=e.originalEvent,t=e.putSortable,n=e.dragEl,a=e.activeSortable,l=e.dispatchSortableEvent,r=e.hideGhostForTarget,s=e.unhideGhostForTarget;if(o){var i=t||a;r();var d=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:o,m=document.elementFromPoint(d.clientX,d.clientY);s(),i&&!i.el.contains(m)&&(l("spill"),this.onSpill({dragEl:n,putSortable:t}))}};function no(){}no.prototype={startIndex:null,dragStart:function(e){var o=e.oldDraggableIndex;this.startIndex=o},onSpill:function(e){var o=e.dragEl,t=e.putSortable;this.sortable.captureAnimationState(),t&&t.captureAnimationState();var n=qe(this.sortable.el,this.startIndex,this.options);n?this.sortable.el.insertBefore(o,n):this.sortable.el.appendChild(o),this.sortable.animateAll(),t&&t.animateAll()},drop:Lo};Ee(no,{pluginName:"revertOnSpill"});function ao(){}ao.prototype={onSpill:function(e){var o=e.dragEl,t=e.putSortable,n=t||this.sortable;n.captureAnimationState(),o.parentNode&&o.parentNode.removeChild(o),n.animateAll()},drop:Lo};Ee(ao,{pluginName:"removeOnSpill"});E.mount(new ll);E.mount(ao,no);function rl(e){return e==null?e:JSON.parse(JSON.stringify(e))}function il(e){Qt()&&Yn(e)}function sl(e){Qt()?Ln(e):e()}const Do="__CLONE__DRAGGABLE__ELEMENT__NODE__";function Jt(...e){var o,t;const n=(o=Qt())==null?void 0:o.proxy,a=e[0];let[,l,r]=e;Array.isArray(_(l))||(r=l,l=null);let s=null;const{immediate:i=!0,clone:d=rl}=(t=_(r))!=null?t:{};function m(k){var O;k.item[Do]=d(_((O=_(l))==null?void 0:O[k.oldIndex]))}function v(k){const O=k.item[Do];Ca(O)||(Vt(k.item),xa(_(l),k.newIndex,O))}function x(k){const{from:O,item:K,oldIndex:q,pullMode:Y,clone:se}=k;if(Y==="clone"){vo(O,K,q),Vt(se);return}Da(_(l),q)}function y(k){const{from:O,item:K,oldIndex:q,newIndex:Y}=k;Vt(K),vo(O,K,q),ka(_(l),q,Y)}const g={onUpdate:y,onStart:m,onAdd:v,onRemove:x};function b(k){const O=_(a);return k||(k=Ta(O)?Oa(O,n==null?void 0:n.$el):O),k&&!Aa(k)&&(k=k.$el),k||wa("Root element not found"),k}function X(){var k;const O=(k=_(r))!=null?k:{},K=Io(O,["immediate","clone"]);return Na(l===null?{}:g,K)}const M=k=>{k=b(k),s&&R.destroy(),s=new E(k,X())};Rn(r,()=>{s&&Pa(X(),(k,O)=>{s==null||s.option(k,O)})},{deep:!0});const R={option:(k,O)=>s==null?void 0:s.option(k,O),destroy:()=>{s==null||s.destroy(),s=null},save:()=>s==null?void 0:s.save(),toArray:()=>s==null?void 0:s.toArray(),closest:(...k)=>s==null?void 0:s.closest(...k)},j=()=>R==null?void 0:R.option("disabled",!0),le=()=>R==null?void 0:R.option("disabled",!1);return sl(()=>{i&&M()}),il(R.destroy),He({start:M,pause:j,resume:le},R)}const Zt=["update","start","add","remove","choose","unchoose","end","sort","filter","clone","move","change"],ul=["onUpdate","onStart","onAdd","onRemove","animation","ghostClass","group","sort","disabled","store","handle","draggable","swapThreshold","invertSwap","invertedSwapThreshold","removeCloneOnHide","direction","chosenClass","dragClass","ignore","filter","preventOnFilter","easing","setData","dropBubble","dragoverBubble","dataIdAttr","delay","delayOnTouchOnly","touchStartThreshold","forceFallback","fallbackClass","fallbackOnBody","fallbackTolerance","fallbackOffset","supportPointer","emptyInsertThreshold","scroll","forceAutoScrollFallback","scrollSensitivity","scrollSpeed","bubbleScroll","modelValue","tag","target",...Zt.map(e=>`on${e.replace(/^\S/,o=>o.toUpperCase())}`)],cl=jn({name:"VueDraggable",model:{prop:"modelValue",event:"update:modelValue"},props:ul,emits:["update:modelValue",...Zt],setup(e,{slots:o,emit:t,expose:n}){const a=$n(),l=Zt.reduce((m,v)=>{const x=`on${v.replace(/^\S/,y=>y.toUpperCase())}`;return m[x]=y=>t(v,y),m},{}),r=ro(()=>{const m=Bn(e),v=Io(m,["modelValue"]),x=Object.entries(v).reduce((y,[g,b])=>{const X=_(b);return X!==void 0&&(y[g]=X),y},{});return He(He({},l),Ea(He(He({},a),x)))}),s=ro({get:()=>e.modelValue,set:m=>t("update:modelValue",m)}),i=ae(),d=ze(Jt(e.target||i,s,r));return n(d),()=>{if(o.default)return Xn(e.tag||"div",{ref:i},o.default(d))}}});const dl={class:"draggable-item-content"},pl={key:0},fl={key:1},ml={key:2},vl={key:3},hl={key:4},gl={key:5},_l={key:0,class:"ui-special-item-container"},yl={__name:"UIDesign",props:{modelValue:{}},emits:["update:modelValue"],setup(e){const o=xo(e,"modelValue"),{t}=Kt(),n=Hn(o.value),a=ze(n),l=ae(a.inputFields),r=ae(a.outputNodes),s=ae(a.triggerNodes),i=ae([{id:"typography-paragraph",required:!0,placeholder:t("components.workspace.uiDesign.typography-paragraph.placeholder"),show:!1,multiline:!0,value:"",password:!1,name:"typography-paragraph",display_name:"typography-paragraph",type:"str",clear_after_run:!0,list:!1,field_type:"typography-paragraph"}]),d=()=>{o.value.data.ui={inputFields:l.value,outputNodes:r.value}},m=ae(!1),v=ae(),x=ze({animation:150,ghostClass:"ghost",handle:".handle",group:{name:"fields",pull:!1},onStart:()=>{m.value=!0},onAdd:()=>{d()},onEnd:()=>{d(),io(()=>{m.value=!1})}});Jt(v,l,x);const y=ae(),g=ze({animation:150,ghostClass:"ghost",handle:".handle",group:{name:"fields",pull:!1},onStart:()=>{m.value=!0},onAdd:()=>{d()},onEnd:()=>{d(),io(()=>{m.value=!1})}});Jt(y,r,g);const b=(X,M)=>{X.splice(M,1),d()};return(X,M)=>{const R=D("a-menu-item"),j=D("a-tooltip"),le=D("a-menu"),k=D("a-layout-sider"),O=D("a-typography-title"),K=D("a-select"),q=D("a-textarea"),Y=D("a-input"),se=D("a-input-number"),xe=D("a-checkbox"),ee=D("a-form-item"),te=D("a-col"),re=D("a-row"),ve=D("a-form"),_e=D("a-divider"),de=D("a-button"),Ne=D("a-popconfirm"),Re=D("a-space"),L=D("cron-ant"),Nt=D("a-card"),ut=D("a-typography-paragraph"),ct=D("a-layout-content"),dt=D("a-layout"),Je=Wn("highlight");return T(),W(dt,{class:"ui-design-layout","has-sider":"",style:{height:"100%","min-height":"calc(100vh - 40px - 40px)"}},{default:f(()=>[u(k,{style:{overflow:"auto",backgroundColor:"#fff"},class:"custom-scrollbar"},{default:f(()=>[u(le,{theme:"light",mode:"inline",ref:"siderMenu"},{default:f(()=>[u(_(cl),{modelValue:i.value,"onUpdate:modelValue":M[0]||(M[0]=p=>i.value=p),animation:"150",group:{name:"fields",pull:"clone",put:!1},sort:!1},{default:f(()=>[(T(!0),Z(Te,null,Le(i.value,(p,he)=>(T(),W(j,{key:`node-${he}`,title:_(t)(`components.workspace.uiDesign.${p.name}.tip`),placement:"right"},{default:f(()=>[u(R,{class:"draggable-menu-item",id:p.id},{default:f(()=>[u(_(Mt)),Ue("span",null,P(_(t)(`components.workspace.uiDesign.${p.name}.title`)),1)]),_:2},1032,["id"])]),_:2},1032,["title"]))),128))]),_:1},8,["modelValue"])]),_:1},512)]),_:1}),u(dt,{style:{"background-color":"#fff"}},{default:f(()=>[u(ct,{style:{margin:"24px 16px 0",overflow:"initial"}},{default:f(()=>[u(re,{gutter:[16,16]},{default:f(()=>[u(te,{xxl:6,xl:8,lg:10,md:24},{default:f(()=>[u(re,{gutter:[16,16]},{default:f(()=>[u(O,{level:3},{default:f(()=>[u(_(ia),{class:"text-primary"}),F(" "+P(_(t)("workspace.workflowSpace.inputs")),1)]),_:1}),u(te,{span:24},{default:f(()=>[u(ve,{layout:"vertical",ref_key:"inputFieldsEl",ref:v},{default:f(()=>[(T(!0),Z(Te,null,Le(l.value,(p,he)=>(T(),Z("div",{class:"draggable-item",key:`field-${p}-${he}`},[u(_(Mt),{class:"handle"}),_(zn).includes(p.field_type)?Xe("",!0):(T(),W(ee,{key:0,class:"draggable-item-content"},{label:f(()=>[F(P(p.display_name),1)]),default:f(()=>[p.category=="llms"&&p=="temperature"?(T(),W(ma,{key:0,modelValue:p.value,"onUpdate:modelValue":A=>p.value=A},null,8,["modelValue","onUpdate:modelValue"])):p.field_type=="select"?(T(),W(K,{key:1,value:p.value,"onUpdate:value":A=>p.value=A,options:p.options},null,8,["value","onUpdate:value","options"])):p.field_type=="textarea"?(T(),W(q,{key:2,value:p.value,"onUpdate:value":A=>p.value=A,autoSize:!0,showCount:!0,placeholder:p.placeholder},null,8,["value","onUpdate:value","placeholder"])):p.field_type=="input"?(T(),W(Y,{key:3,value:p.value,"onUpdate:value":A=>p.value=A,placeholder:p.placeholder},null,8,["value","onUpdate:value","placeholder"])):p.field_type=="number"?(T(),W(se,{key:4,value:p.value,"onUpdate:value":A=>p.value=A,placeholder:p.placeholder},null,8,["value","onUpdate:value","placeholder"])):p.field_type=="checkbox"?(T(),W(xe,{key:5,checked:p.value,"onUpdate:checked":A=>p.value=A},null,8,["checked","onUpdate:checked"])):p.field_type=="file"?(T(),W(Co,{key:6,modelValue:p.value,"onUpdate:modelValue":A=>p.value=A},null,8,["modelValue","onUpdate:modelValue"])):p.field_type=="list"?(T(),W(ua,{key:7,modelValue:p.value,"onUpdate:modelValue":A=>p.value=A},null,8,["modelValue","onUpdate:modelValue"])):Xe("",!0)]),_:2},1024)),p.field_type=="typography-paragraph"?(T(),W(re,{key:1,class:"draggable-item-content"},{default:f(()=>[u(te,{span:24,class:"ui-special-item-container"},{default:f(()=>[u(q,{class:"ui-special-item",value:p.value,"onUpdate:value":A=>p.value=A,placeholder:p.placeholder,"auto-size":"",onChange:d},null,8,["value","onUpdate:value","placeholder"]),u(_(so),{class:"ui-special-item-delete",onClick:A=>b(l.value,he)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)):Xe("",!0)]))),128))]),_:1},512)]),_:1}),u(_e),u(te,{span:24},{default:f(()=>[u(re,{gutter:[16,16]},{default:f(()=>[(T(!0),Z(Te,null,Le(s.value,p=>(T(),W(te,{key:`node-${p.id}`,span:24},{default:f(()=>[p.type=="ButtonTrigger"?(T(),W(de,{key:0,type:"primary",block:""},{default:f(()=>[F(P(p.data.template.button_text.value),1)]),_:2},1024)):p.type=="ScheduleTrigger"?(T(),W(Nt,{key:1,title:_(t)("components.nodes.triggers.ScheduleTrigger.schedule_settings")},{extra:f(()=>[u(Re,null,{default:f(()=>[u(de,{type:"primary"},{default:f(()=>[F(P(_(t)("components.nodes.triggers.ScheduleTrigger.save_schedule_settings")),1)]),_:1}),u(Ne,{title:_(t)("workspace.workflowSpace.delete_schedule_trigger_confirm")},{default:f(()=>[u(de,{type:"primary",danger:""},{default:f(()=>[F(P(_(t)("workspace.workflowSpace.delete")),1)]),_:1})]),_:1},8,["title"])]),_:1})]),default:f(()=>[u(L,{modelValue:p.data.template.schedule.value,"onUpdate:modelValue":he=>p.data.template.schedule.value=he,"button-props":{type:"primary",shape:"round"},locale:X.language},null,8,["modelValue","onUpdate:modelValue","locale"])]),_:2},1032,["title"])):Xe("",!0)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1}),u(te,{xxl:18,xl:16,lg:14,md:24},{default:f(()=>[u(O,{level:3,style:{display:"flex","justify-content":"space-between"}},{default:f(()=>[Ue("span",null,[u(_(sa),{class:"text-primary"}),F(" "+P(_(t)("workspace.workflowSpace.outputs")),1)])]),_:1}),u(re,{gutter:[16,16],ref_key:"outputNodesEl",ref:y},{default:f(()=>[(T(!0),Z(Te,null,Le(r.value,(p,he)=>(T(),W(te,{span:24,class:"draggable-item",key:`node-${p.id}-${he}`},{default:f(()=>{var A;return[u(_(Mt),{class:"handle"}),Ue("div",dl,[p.type=="Text"?(T(),Z("div",pl,[u(O,{level:5},{default:f(()=>[F(P(p.data.template.output_title.value),1)]),_:2},1024),p.data.template.render_markdown.value?(T(),Z(Te,{key:0},[Ht(u(_(Gn),{source:p.data.template.text.value,class:"markdown-body custom-hljs"},null,8,["source"]),[[Je]]),u(ut,{copyable:{text:p.data.template.text.value}},null,8,["copyable"])],64)):(T(),W(ut,{key:1,copyable:{text:p.data.template.text.value}},{default:f(()=>[F(P(p.data.template.text.value),1)]),_:2},1032,["copyable"]))])):p.type=="Audio"?(T(),Z("div",fl,[u(ca,{audios:[(A=p.data.template.audio_url)==null?void 0:A.value]},null,8,["audios"])])):p.type=="Mindmap"?(T(),Z("div",ml,[u(da,{content:p.data.template.content.value,style:{width:"100%","min-height":"50vh"}},null,8,["content"])])):p.type=="Mermaid"?(T(),Z("div",vl,[u(pa,{content:p.data.template.content.value,style:{width:"100%","min-height":"50vh"}},null,8,["content"])])):p.type=="Echarts"?(T(),Z("div",hl,[u(fa,{option:p.data.template.option.value,style:{width:"100%","min-height":"50vh"}},null,8,["option"])])):(T(),Z("div",gl,[p.field_type=="typography-paragraph"?(T(),Z("div",_l,[u(q,{class:"ui-special-item",value:p.value,"onUpdate:value":w=>p.value=w,placeholder:p.placeholder,"auto-size":"",onChange:d},null,8,["value","onUpdate:value","placeholder"]),u(_(so),{class:"ui-special-item-delete",onClick:w=>b(r.value,he)},null,8,["onClick"])])):Xe("",!0)]))])]}),_:2},1024))),128))]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}},bl=eo(yl,[["__scopeId","data-v-01ce6c33"]]);const wl={__name:"VueFlowStyleSettings",props:{modelValue:{}},emits:qn(["save"],["update:modelValue"]),setup(e,{emit:o}){const t=xo(e,"modelValue"),{t:n}=Kt(),a=ae(!1),l=()=>{o("save",t),a.value=!1};return(r,s)=>{const i=D("a-button"),d=D("a-select-option"),m=D("a-select"),v=D("a-form-item"),x=D("a-switch"),y=D("a-form"),g=D("a-drawer");return T(),Z(Te,null,[u(i,{onClick:s[0]||(s[0]=b=>a.value=!0),class:"settings-button"},{default:f(()=>[F(P(_(n)("components.workspace.vueFlowStyleSettings.title")),1)]),_:1}),u(g,{open:a.value,"onUpdate:open":s[3]||(s[3]=b=>a.value=b),class:"custom-class",title:_(n)("components.workspace.vueFlowStyleSettings.title"),placement:"right"},{extra:f(()=>[u(i,{type:"primary",onClick:l},{default:f(()=>[F(P(_(n)("common.save")),1)]),_:1})]),default:f(()=>[u(y,{model:t.value,"label-col":{span:8},"wrapper-col":{span:16},autocomplete:"off"},{default:f(()=>[u(v,{label:_(n)("components.workspace.vueFlowStyleSettings.edge_type"),name:"edge_type"},{default:f(()=>[u(m,{value:t.value.edge.type,"onUpdate:value":s[1]||(s[1]=b=>t.value.edge.type=b)},{default:f(()=>[u(d,{value:"bezier"},{default:f(()=>[F(P(_(n)("components.workspace.vueFlowStyleSettings.edge_type_bezier")),1)]),_:1}),u(d,{value:"step"},{default:f(()=>[F(P(_(n)("components.workspace.vueFlowStyleSettings.edge_type_step")),1)]),_:1}),u(d,{value:"smoothstep"},{default:f(()=>[F(P(_(n)("components.workspace.vueFlowStyleSettings.edge_type_smoothstep")),1)]),_:1}),u(d,{value:"straight"},{default:f(()=>[F(P(_(n)("components.workspace.vueFlowStyleSettings.edge_type_straight")),1)]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),u(v,{label:_(n)("components.workspace.vueFlowStyleSettings.edge_animated"),name:"edge_animated"},{default:f(()=>[u(x,{checked:t.value.edge.animated,"onUpdate:checked":s[2]||(s[2]=b=>t.value.edge.animated=b)},null,8,["checked"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["open","title"])],64)}}},kl=eo(wl,[["__scopeId","data-v-33ef65ae"]]);const Sl={key:0,class:"loading-container"},El={key:1,class:"editor-container"},Dl={class:"title-container"},xl=["data-node-type"],Cl={__name:"WorkflowEditor",setup(e){const{t:o}=Kt(),t=ae(!0),n=Jn(),a=Zn(),l=n.params.workflowId,r=ae(o("workspace.workflowEditor.workflow_canvas")),s=ze([o("workspace.workflowEditor.workflow_info"),o("workspace.workflowEditor.workflow_canvas"),o("workspace.workflowEditor.workflow_ui_design")]),i=la(),{userDatabases:d}=uo(i),m=Qn(),v=Kn(),{vueFlowStyleSettings:x}=uo(v),y=ae(""),g=ae({}),b=ae([]),X=()=>{ve.value.forEach(w=>{w.type=x.value.edge.type,w.animated=x.value.edge.animated,w.style=x.value.edge.style}),v.setVueFlowStyleSettings(x.value)};ea(async()=>{const w=co("get",{wid:l}),h=va("list",{}),J=await w,H=await h;if(H.status==200&&i.setUserDatabases(H.data),J.status!=200){Pt.error(o("workspace.workflowSpace.get_workflow_failed")),a.push({name:"WorkflowSpaceMain"});return}g.value=J.data,g.value.data.nodes.forEach(oe=>{oe.category=="vectorDb"&&(oe.data.template.database.options=d.value.filter(ue=>ue.status=="VALID").map(ue=>({value:ue.vid,label:ue.name})))}),g.value.tags=g.value.tags.map(oe=>oe.tid),b.value=[...g.value.data.nodes,...g.value.data.edges],b.value.forEach(oe=>{oe.events={change:ue=>de(),delete:ue=>Ne(ue)}}),y.value=mt(g.value),t.value=!1});const M=()=>{const w=ee();g.value.data={...w,ui:g.value.data.ui||{}}},R=ae(!1),j=async()=>{R.value=!0;const w=g.value.data.ui||{},h=ee();g.value.data={...h,ui:w},(await co("update",{wid:l,...g.value})).status==200?(Pt.success(o("workspace.workflowSpace.save_success")),y.value=mt(g.value)):Pt.error(o("workspace.workflowSpace.save_failed")),m.updateUserWorkflow(g.value),R.value=!1},le=async()=>{await a.push({name:"WorkflowUse",params:{workflowId:l}})},k=ae(!1),O=async()=>{await j(),await le()},K=async()=>{await le()},q=()=>{const w=g.value.data.ui||{},h=ee();g.value.data={...h,ui:w},y.value!=mt(g.value)?k.value=!0:le()},{addEdges:Y,updateEdge:se,onConnect:xe,toObject:ee,viewport:te,vueFlowRef:re,edges:ve}=Zo();xe(w=>{w.type=x.value.edge.type,w.animated=x.value.edge.animated,w.style=x.value.edge.style,Y([w])});const _e=({edge:w,connection:h})=>{se(w,h)},de=w=>{},Ne=w=>{b.value=b.value.filter(h=>h.id!==w.id),b.value=b.value.filter(h=>!(h.source&&h.source===w.id||h.target&&h.target===w.id))},Re=w=>{b.value=b.value.filter(h=>!(h.source===w.edge.source&&h.target===w.edge.target&&h.sourceHandle===w.edge.sourceHandle&&h.targetHandle===w.edge.targetHandle))};let L;const Nt=w=>{L&&document.body.removeChild(L);let h=w.target.getBoundingClientRect();L=w.target.cloneNode(!0),L.style.position="absolute",L.style.top=h.top+"px",L.style.left=h.left+"px",L.style.width=h.width+"px",L.style.height=h.height+"px",L.style.opacity="0.5",L.style.zIndex="1000",document.body.appendChild(L)},ut=w=>{L&&(L.style.left=w.touches[0].clientX+"px",L.style.top=w.touches[0].clientY+"px")},ct=w=>{L&&(document.body.removeChild(L),L=null);let h=w.srcElement.dataset.nodeType;h||(h=w.srcElement.children[0].dataset.nodeType);const J=he[h],H=Fn(),oe=JSON.parse(JSON.stringify(Je[h].props.templateData));oe.description=o(`components.nodes.${J}.${h}.description`),Object.keys(oe.template).forEach(Pe=>{oe.template[Pe].display_name=o(`components.nodes.${J}.${h}.${Pe}`)});const ue=re.value.getBoundingClientRect(),{x:At,y:Ae,zoom:pt}=te.value;let Ze=0,je=0;w.type=="touchend"?(Ze=w.changedTouches[0].clientX-ue.left,je=w.changedTouches[0].clientY-ue.top):(Ze=w.clientX-ue.left,je=w.clientY-ue.top);const Qe={id:H,type:h,category:J,position:{x:(Ze-At)/pt,y:(je-Ae)/pt},data:oe,events:{change:Pe=>de(),delete:Pe=>Ne(Pe)}};b.value.push(Qe)},dt=Object.assign({"/src/components/nodes/assistedNodes/CommentNode.vue":Qo,"/src/components/nodes/controlFlows/Conditional.vue":Ko,"/src/components/nodes/controlFlows/Empty.vue":en,"/src/components/nodes/controlFlows/JsonProcess.vue":tn,"/src/components/nodes/controlFlows/RandomChoice.vue":on,"/src/components/nodes/fileProcessing/FileLoader.vue":nn,"/src/components/nodes/imageGeneration/StableDiffusion.vue":an,"/src/components/nodes/llms/ChatGLM.vue":ln,"/src/components/nodes/llms/OpenAI.vue":rn,"/src/components/nodes/outputs/Document.vue":sn,"/src/components/nodes/outputs/Echarts.vue":un,"/src/components/nodes/outputs/Email.vue":cn,"/src/components/nodes/outputs/Mermaid.vue":dn,"/src/components/nodes/outputs/Mindmap.vue":pn,"/src/components/nodes/outputs/Text.vue":fn,"/src/components/nodes/textProcessing/ListRender.vue":mn,"/src/components/nodes/textProcessing/MarkdownToHtml.vue":vn,"/src/components/nodes/textProcessing/TemplateCompose.vue":hn,"/src/components/nodes/textProcessing/TextInOut.vue":gn,"/src/components/nodes/textProcessing/TextSplitters.vue":_n,"/src/components/nodes/textProcessing/TextTruncation.vue":yn,"/src/components/nodes/tools/ImageSearch.vue":bn,"/src/components/nodes/tools/ProgrammingFunction.vue":wn,"/src/components/nodes/triggers/ButtonTrigger.vue":kn,"/src/components/nodes/vectorDb/AddData.vue":Sn,"/src/components/nodes/vectorDb/DeleteData.vue":En,"/src/components/nodes/vectorDb/Search.vue":Dn,"/src/components/nodes/webCrawlers/BilibiliCrawler.vue":xn,"/src/components/nodes/webCrawlers/TextCrawler.vue":Cn,"/src/components/nodes/webCrawlers/YoutubeCrawler.vue":Tn}),Je={},p={},he={};Object.entries(dt).forEach(([w,h])=>{const J=w.match(/\/([^/]+)\.vue$/)[1];Je[J]=ta(h.default);const H=w.match(/\/([^/]+)\/[^/]+\.vue$/)[1];p[H]||(p[H]=[]),p[H].push(J),he[J]=H});const A=ze({open:!1,code:"",openEditor:async()=>{let w=ee();w.ui=g.value.data.ui||{},A.code=JSON.stringify(w,null,2),A.open=!0},updateCode:w=>{const h=JSON.parse(w);g.value.data.ui=h.ui||{},b.value=[...h.nodes,...h.edges],b.value.forEach(J=>{J.events={change:H=>de(),delete:H=>Ne(H)}}),g.value.data.nodes=h.nodes,g.value.data.edges=h.edges,g.value.data.nodes.forEach(J=>{J.category=="vectorDb"&&(J.data.template.database.options=d.value.filter(H=>H.status=="VALID").map(H=>({value:H.vid,label:H.name})))}),y.value=mt(g.value)}});return(w,h)=>{const J=D("a-spin"),H=D("a-typography-text"),oe=D("a-button"),ue=D("a-modal"),At=D("a-typography-link"),Ae=D("a-col"),pt=D("a-segmented"),Ze=D("a-space"),je=D("a-row"),Qe=D("a-divider"),Pe=D("a-menu-item"),Ho=D("a-sub-menu"),Wo=D("a-menu"),zo=D("a-layout-sider"),Go=D("a-layout-content"),lo=D("a-layout");return t.value?(T(),Z("div",Sl,[u(J,{size:"large"})])):(T(),Z("div",El,[Ue("div",Dl,[u(je,{type:"flex",align:"middle",justify:"space-between",gutter:[16,16],style:{width:"100%"}},{default:f(()=>[u(Ae,{flex:"0 0"},{default:f(()=>[u(At,{onClick:q,style:{"text-wrap":"nowrap"}},{default:f(()=>[u(_(oa)),F(" "+P(_(o)("common.back"))+" ",1),u(ue,{open:k.value,"onUpdate:open":h[0]||(h[0]=V=>k.value=V)},{title:f(()=>[u(H,{type:"warning"},{default:f(()=>[u(_(na)),F(" "+P(_(o)("common.back")),1)]),_:1})]),footer:f(()=>[u(oe,{onClick:K},{default:f(()=>[F(P(_(o)("workspace.workflowEditor.exit_without_save")),1)]),_:1}),u(oe,{type:"primary",onClick:O},{default:f(()=>[F(P(_(o)("workspace.workflowEditor.save_and_exit")),1)]),_:1})]),default:f(()=>[F(" "+P(_(o)("workspace.workflowEditor.exit_not_saved_confirm"))+" ",1)]),_:1},8,["open"])]),_:1})]),_:1}),u(Ae,{flex:"0 0"},{default:f(()=>[u(H,{class:"title",editable:{triggerType:["text","icon"]},content:g.value.title,"onUpdate:content":h[1]||(h[1]=V=>g.value.title=V)},null,8,["content"])]),_:1}),u(Ae,{flex:"1 0",style:{display:"flex","justify-content":"center"}},{default:f(()=>[u(pt,{value:r.value,"onUpdate:value":h[2]||(h[2]=V=>r.value=V),options:s,onChange:M},null,8,["value","options"])]),_:1}),u(Ae,{flex:"0 0",style:{display:"flex","justify-content":"end"}},{default:f(()=>[u(Ze,null,{default:f(()=>[u(oe,{onClick:A.openEditor},{default:f(()=>[F(P(_(o)("workspace.workflowEditor.edit_code"))+" ",1),u(On,{language:"json",open:A.open,"onUpdate:open":h[3]||(h[3]=V=>A.open=V),code:A.code,"onUpdate:code":h[4]||(h[4]=V=>A.code=V),onSave:A.updateCode},null,8,["open","code","onSave"])]),_:1},8,["onClick"]),u(oe,{type:"primary",onClick:j,loading:R.value},{default:f(()=>[F(P(_(o)("common.save")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),Ht(Ue("div",null,[u(je,{justify:"center"},{default:f(()=>[u(Ae,{lg:10,md:12,sm:18,xs:24},{default:f(()=>[u(Qe,null,{default:f(()=>[F(P(_(o)("workspace.workflowEditor.tags")),1)]),_:1}),u(In,{modelValue:g.value.tags,"onUpdate:modelValue":h[5]||(h[5]=V=>g.value.tags=V)},null,8,["modelValue"]),u(Qe,null,{default:f(()=>[F(P(_(o)("workspace.workflowEditor.brief_info")),1)]),_:1}),u(ra,{markdown:g.value.brief,"onUpdate:markdown":h[6]||(h[6]=V=>g.value.brief=V)},null,8,["markdown"]),u(Qe,null,{default:f(()=>[F(P(_(o)("workspace.workflowEditor.brief_images")),1)]),_:1}),Ue("div",null,[u(Co,{modelValue:g.value.images,"onUpdate:modelValue":h[7]||(h[7]=V=>g.value.images=V),multiple:!0},null,8,["modelValue"])])]),_:1})]),_:1})],512),[[po,r.value==_(o)("workspace.workflowEditor.workflow_info")]]),Ht(u(lo,{"has-sider":"",style:{height:"100%"}},{default:f(()=>[u(zo,{style:{overflow:"auto",backgroundColor:"#fff"},class:"custom-scrollbar"},{default:f(()=>[u(Wo,{theme:"light",mode:"inline"},{default:f(()=>[(T(!0),Z(Te,null,Le(Object.keys(p),(V,qo)=>(T(),W(Ho,{key:`category-${qo}`},{title:f(()=>[F(P(_(o)(`components.nodes.${V}.title`)),1)]),default:f(()=>[(T(!0),Z(Te,null,Le(p[V],(ft,Jo)=>(T(),W(Pe,{"data-node-type":ft,id:ft,draggable:"true",onTouchstart:Nt,onTouchmove:ut,onDragend:ct,onTouchend:ct,key:`node-${Jo}`},{default:f(()=>[Ue("span",{"data-node-type":ft},P(_(o)(`components.nodes.${V}.${ft}.title`)),9,xl)]),_:2},1032,["data-node-type","id"]))),128))]),_:2},1024))),128))]),_:1})]),_:1}),u(lo,null,{default:f(()=>[u(Go,{style:{margin:"24px 16px 0",overflow:"initial"}},{default:f(()=>[u(_(Nn),{modelValue:b.value,"onUpdate:modelValue":h[9]||(h[9]=V=>b.value=V),"node-types":Je,edgesUpdatable:!0,onEdgeUpdate:_e,onEdgeDoubleClick:Re,"snap-to-grid":!0,"snap-grid":[20,20]},{default:f(()=>[u(_(An)),u(_(Pn)),u(_(Mn),{variant:_(Vn).Dots},null,8,["variant"]),u(kl,{modelValue:_(x),"onUpdate:modelValue":h[8]||(h[8]=V=>aa(x)?x.value=V:null),onSave:X},null,8,["modelValue"])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},512),[[po,r.value==_(o)("workspace.workflowEditor.workflow_canvas")]]),r.value==_(o)("workspace.workflowEditor.workflow_ui_design")?(T(),W(bl,{key:0,modelValue:g.value,"onUpdate:modelValue":h[10]||(h[10]=V=>g.value=V)},null,8,["modelValue"])):Xe("",!0)]))}}},$l=eo(Cl,[["__scopeId","data-v-2146d023"]]);export{$l as default};
