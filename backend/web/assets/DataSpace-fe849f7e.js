import{u as G,r as y,x as N,B as M,p as m,f as t,o as r,g as _,c as n,h as e,k as i,t as u,j as l,F as C,v as w,i as b,ap as F,m as P}from"./index-f4042210.js";import{u as j}from"./userDatabase-94f9340a.js";import{d as v}from"./database-07243708.js";const X={INVALID:"red",EXPIRED:"orange",DELETED:"orange",VALID:"green",ERROR:"red",CREATING:"blue",DELETEING:"red"};const q={class:"dataspace-container"},z={key:1},H={key:2},J={key:3},Z={__name:"DataSpace",setup(K){const{t:a}=G(),D=y(!0),E=j(),f=N({columns:[{name:a("workspace.dataSpace.databaseName"),dataIndex:"name",key:"name"},{title:a("common.status"),dataIndex:"status",key:"status"},{title:a("common.tags"),key:"tags",dataIndex:"tags"},{title:a("common.action"),key:"action"}],data:[]}),k=async()=>{const p=await v("list",{});p.status==200?(E.setUserDatabases(p.data),f.data=p.data.map(c=>({...c,color:X[c.status],tags:[]})),D.value=!1):m.error(p.msg)};M(async()=>{await k()});const s=N({open:y(!1),creating:y(!1),create:async()=>{s.creating=!0,(await v("create",{name:s.databaseName})).status===200?m.success(a("workspace.dataSpace.create_success")):m.error(a("workspace.dataSpace.create_failed")),await k(),s.creating=!1,s.open=!1}}),I=async p=>{(await v("delete",{vid:p})).status===200?m.success(a("workspace.dataSpace.delete_success")):m.error(a("workspace.dataSpace.delete_failed")),await k()};return(p,c)=>{const L=t("a-button"),x=t("a-input"),R=t("a-form-item"),A=t("a-modal"),B=t("RouterLink"),S=t("a-tag"),T=t("a-typography-link"),U=t("a-popconfirm"),V=t("a-table"),h=t("a-card"),O=t("a-col"),$=t("a-row");return r(),_("div",q,[n($,{gutter:[16,16]},{default:e(()=>[n(O,{span:24},{default:e(()=>[n(h,{loading:D.value},{extra:e(()=>[n(L,{type:"primary",onClick:c[0]||(c[0]=o=>s.open=!0)},{default:e(()=>[i(u(l(a)("workspace.dataSpace.create")),1)]),_:1}),n(A,{open:s.open,"onUpdate:open":c[2]||(c[2]=o=>s.open=o),title:l(a)("workspace.dataSpace.create"),onOk:s.create,confirmLoading:s.creating},{default:e(()=>[n(R,{label:l(a)("workspace.dataSpace.databaseName")},{default:e(()=>[n(x,{value:s.databaseName,"onUpdate:value":c[1]||(c[1]=o=>s.databaseName=o)},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["open","title","onOk","confirmLoading"])]),default:e(()=>[n(V,{columns:f.columns,"data-source":f.data},{headerCell:e(({column:o})=>[o.key==="name"?(r(),_(C,{key:0},[i(u(l(a)("workspace.dataSpace.databaseName")),1)],64)):w("",!0)]),bodyCell:e(({column:o,record:d})=>[o.key==="name"?(r(),b(B,{key:0,to:`/data/${d.vid}`},{default:e(()=>[i(u(d.name),1)]),_:2},1032,["to"])):o.key==="status"?(r(),_("span",z,[n(S,{color:d.color},{default:e(()=>[d.status==="CREATING"?(r(),b(l(F),{key:0})):w("",!0),i(" "+u(l(a)(`workspace.dataSpace.status_${d.status.toLowerCase()}`)),1)]),_:2},1032,["color"])])):o.key==="tags"?(r(),_("span",H,[(r(!0),_(C,null,P(d.tags,g=>(r(),b(S,{key:g},{default:e(()=>[i(u(g.toUpperCase()),1)]),_:2},1024))),128))])):o.key==="action"?(r(),_("span",J,[n(U,{title:l(a)("workspace.dataSpace.delete_confirm"),onConfirm:g=>I(d.vid)},{default:e(()=>[n(T,{type:"danger"},{default:e(()=>[i(u(l(a)("workspace.databaseDetail.delete")),1)]),_:1})]),_:2},1032,["title","onConfirm"])])):w("",!0)]),_:1},8,["columns","data-source"])]),_:1},8,["loading"])]),_:1})]),_:1})])}}};export{Z as default};
