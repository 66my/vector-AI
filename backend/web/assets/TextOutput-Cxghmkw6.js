import{I as C,c as h,W as E,a4 as F,r as L,s as B,x as J,M as k,f as v,h as O,$ as T,K as b,j as x,F as M,G as z,B as N,T as V,D as W,a as A,a8 as H,Y as P,a9 as U}from"./index-DwTab_5X.js";const $=C("add-one",!1,function(s){return h("svg",{width:s.size,height:s.size,viewBox:"0 0 48 48",fill:"none"},[h("path",{d:"M24 44C35.0457 44 44 35.0457 44 24C44 12.9543 35.0457 4 24 4C12.9543 4 4 12.9543 4 24C4 35.0457 12.9543 44 24 44Z",fill:s.colors[1],stroke:s.colors[0],"stroke-width":s.strokeWidth,"stroke-linejoin":s.strokeLinejoin},null),h("path",{d:"M24 16V32",stroke:s.colors[2],"stroke-width":s.strokeWidth,"stroke-linecap":s.strokeLinecap,"stroke-linejoin":s.strokeLinejoin},null),h("path",{d:"M16 24L32 24",stroke:s.colors[2],"stroke-width":s.strokeWidth,"stroke-linecap":s.strokeLinecap,"stroke-linejoin":s.strokeLinejoin},null)])}),D=C("lightning",!0,function(s){return h("svg",{width:s.size,height:s.size,viewBox:"0 0 48 48",fill:"none"},[h("path",{d:"M19 4H37L26 18H41L17 44L22 25H8L19 4Z",fill:s.colors[1],stroke:s.colors[0],"stroke-width":s.strokeWidth,"stroke-linejoin":s.strokeLinejoin},null)])}),G=C("reduce-one",!1,function(s){return h("svg",{width:s.size,height:s.size,viewBox:"0 0 48 48",fill:"none"},[h("path",{d:"M24 44C35.0457 44 44 35.0457 44 24C44 12.9543 35.0457 4 24 4C12.9543 4 4 12.9543 4 24C4 35.0457 12.9543 44 24 44Z",fill:s.colors[1],stroke:s.colors[0],"stroke-width":s.strokeWidth,"stroke-linejoin":s.strokeLinejoin},null),h("path",{d:"M16 24L32 24",stroke:s.colors[2],"stroke-width":s.strokeWidth,"stroke-linecap":s.strokeLinecap,"stroke-linejoin":s.strokeLinejoin},null)])}),K={__name:"TemperatureInput",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(s){const{t:e}=E(),a=F(s,"modelValue"),i=L([e("components.nodes.llms.common.creative"),e("components.nodes.llms.common.balanced"),e("components.nodes.llms.common.precise")]),r=B(e("components.nodes.llms.common.balanced")),l=L([.8,.5,.2]),c=u=>{r.value=u,i.forEach((o,p)=>{o===u&&(a.value=l[p])})},m=u=>{u>=0&&u<=.3?r.value=e("components.nodes.llms.common.precise"):u>.3&&u<=.7?r.value=e("components.nodes.llms.common.balanced"):u>.7&&u<=1&&(r.value=e("components.nodes.llms.common.creative"))};return J(()=>{m(a.value)}),(u,o)=>{const p=k("a-segmented"),y=k("a-input-number");return v(),O("div",null,[h(p,{value:r.value,"onUpdate:value":o[0]||(o[0]=g=>r.value=g),options:i,block:"",onChange:c},null,8,["value","options"]),h(y,{style:{width:"100%"},value:a.value,"onUpdate:value":o[1]||(o[1]=g=>a.value=g),step:.1,max:1,min:0,controls:!1,keyboard:!1,onChange:m},null,8,["value"])])}}};function Z(s){let e=!1;return Object.keys(s.data.template).forEach(a=>{s.data.template[a].show&&(e=!0)}),e}class q{constructor(){this.nodes=new Set,this.edges={}}add_node(e){this.nodes.add(e),e in this.edges||(this.edges[e]=new Set)}add_edge(e,a){this.nodes.has(e)||this.add_node(e),this.nodes.has(a)||this.add_node(a),this.edges[e].add(a)}get_parents(e){let a=[];for(const[i,r]of Object.entries(this.edges))r.has(e)&&a.push(i);return a}get_children(e){return Array.from(this.edges[e])}get_all_nodes(){return Array.from(this.nodes)}topological_sort(){let e={};for(const r of this.nodes)e[r]=0;for(const[r,l]of Object.entries(this.edges))for(const c of l)e[c]+=1;let a=Object.keys(e).filter(r=>e[r]==0),i=[];for(;a.length>0;){let r=a.shift();i.push(r);for(const l of this.edges[r])e[l]-=1,e[l]==0&&a.push(l)}if(i.length!=this.nodes.size)throw new Error("The graph contains cycles");return i}}const Y=s=>{const e={noCycle:!0,noIsolatedNodes:!0};let a=new q;s.data.nodes.forEach(o=>{o.category!="triggers"&&o.category!="assistedNodes"&&a.add_node(o.id)}),s.data.edges.forEach(o=>{a.add_edge(o.source,o.target)});try{a.topological_sort(),e.noCycle=!0}catch{e.noCycle=!1}const i=s.data.nodes.filter(o=>o.category!="triggers"&&o.category!="assistedNodes").map(o=>o.id),r=s.data.edges,l={};i.forEach(o=>l[o]=[]),r.forEach(o=>{l[o.source].push(o.target),l[o.target].push(o.source)});const c=new Set,m=o=>{c.add(o),l[o].forEach(p=>{c.has(p)||m(p)})};let u=0;return i.forEach(o=>{c.has(o)||(u+=1,m(o))}),u>1?e.noIsolatedNodes=!1:e.noIsolatedNodes=!0,e},S=["typography-paragraph"],Q=s=>{var u,o,p,y,g,I;let e=((o=(u=s.data)==null?void 0:u.ui)==null?void 0:o.inputFields)||[],a=JSON.parse(JSON.stringify(e)),i=((y=(p=s.data)==null?void 0:p.ui)==null?void 0:y.outputNodes)||[],r=JSON.parse(JSON.stringify(i)),l=((I=(g=s.data)==null?void 0:g.ui)==null?void 0:I.triggerNodes)||[],c=JSON.parse(JSON.stringify(l)),m=[];return s.data.nodes.forEach(n=>{if(n.category=="triggers"){l.push(n);const f=c.findIndex(d=>d.id==n.id);c.splice(f,1)}else if(n.category=="outputs"){if(n.type=="Text"){if(!n.data.template.text.show)return}else if(n.type=="Audio"){if(!n.data.template.show_player.value)return}else if(n.type=="Mindmap"){if(!n.data.template.show_mind_map.value)return}else if(n.type=="Mermaid"){if(!n.data.template.show_mermaid.value)return}else if(n.type=="Echarts"){if(!n.data.template.show_echarts.value)return}else if(n.field_type!="typography-paragraph"){if(n.type=="WorkflowInvokeOutput"){m.push(n);return}else if(n.type!="Html")return}const f=i.findIndex(d=>d.id==n.id);if(f>=0){i.splice(f,1,n);const d=r.findIndex(w=>w.id==n.id);r.splice(d,1)}else i.push(n)}else{if(!n.data.has_inputs&&Z(n))return;Object.keys(n.data.template).forEach(f=>{if(n.data.template[f].show){const d=JSON.parse(JSON.stringify(n.data.template[f]));d.category=n.category,d.nodeId=n.id,d.fieldName=f,Object.defineProperty(d,"value",{get(){return n.data.template[f].value},set(_){n.data.template[f].value=_}});const w=e.findIndex(_=>_.nodeId==n.id&&_.fieldName==f);if(w>=0){e.splice(w,1,d);const _=a.findIndex(j=>j.nodeId==n.id&&j.fieldName==f);a.splice(_,1)}else e.push(d)}})}}),a.filter(n=>!S.includes(n.field_type)).forEach(n=>{const f=e.findIndex(d=>d.nodeId==n.nodeId&&d.fieldName==n.fieldName);e.splice(f,1)}),r.filter(n=>!S.includes(n.field_type)).forEach(n=>{const f=i.findIndex(d=>d.id==n.id);i.splice(f,1)}),c.forEach(n=>{const f=l.findIndex(d=>d.id==n.id);l.splice(f,1)}),{inputFields:e,outputNodes:i,triggerNodes:l,workflowInvokeOutputNodes:m}};function X(s){let e=!0;try{s.forEach(a=>{let i=!0;a.field_type!="checkbox"&&a.show&&a.required&&((a.field_type=="number"&&typeof a.value!="number"||a.field_type=="select"&&a.value.length===0||!a.value&&!a.value===0)&&(i=!1),i||(T.error(t("workspace.workflowSpace.field_is_empty",{field:a.display_name})),e=!1))})}catch{e=!1}return e}const ee={__name:"ListFieldUse",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(s){const e=F(s,"modelValue"),{t:a}=E(),i=()=>{e.value.push("")},r=(c,m)=>{e.value[m]=c},l=c=>{e.value.splice(c,1)};return(c,m)=>{const u=k("a-input"),o=k("a-button"),p=k("a-flex");return v(),b(p,{vertical:"",gap:"small"},{default:x(()=>[(v(!0),O(M,null,z(e.value,(y,g)=>(v(),b(p,{key:g,align:"center",gap:"small"},{default:x(()=>[h(u,{value:y,onInput:I=>r(I.target.value,g)},null,8,["value","onInput"]),h(o,{type:"text",onClick:I=>l(g)},{icon:x(()=>[h(N(G))]),_:2},1032,["onClick"])]),_:2},1024))),128)),h(o,{type:"dashed",style:{width:"100%"},onClick:i},{default:x(()=>[h(N($)),V(" "+W(N(a)("components.nodes.listField.add_item")),1)]),_:1})]),_:1})}}},te={__name:"TextOutput",props:{text:{type:String,default:""},renderMarkdown:{type:Boolean,default:!1}},setup(s){const e=s,a=A(()=>typeof e.text=="string"?e.text:JSON.stringify(e.text));return(i,r)=>{const l=k("a-typography-paragraph"),c=H("highlight");return s.renderMarkdown?(v(),O(M,{key:0},[P(h(N(U),{source:a.value,class:"markdown-body custom-hljs"},null,8,["source"]),[[c]]),h(l,{copyable:{text:a.value}},null,8,["copyable"])],64)):(v(),b(l,{key:1,copyable:{text:a.value}},{default:x(()=>[V(W(a.value),1)]),_:1},8,["copyable"]))}}};export{$ as A,D as L,G as R,K as _,ee as a,te as b,Y as c,X as d,Q as g,Z as h,S as n};
